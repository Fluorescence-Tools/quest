<!DOCTYPE html>
<!-- Generated by Cython 0.20.2 on Thu Jun 26 11:44:01 2014 -->
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">

body { font-family: courier; font-size: 12; }

.code  { font-size: 9; color: #444444; display: none; margin-left: 20px; }
.py_c_api  { color: red; }
.py_macro_api  { color: #FF7000; }
.pyx_c_api  { color: #FF3000; }
.pyx_macro_api  { color: #FF7000; }
.refnanny  { color: #FFA000; }

.error_goto  { color: #FFA000; }

.tag  {  }

.coerce  { color: #008000; border: 1px dotted #008000 }

.py_attr { color: #FF0000; font-weight: bold; }
.c_attr  { color: #0000FF; }

.py_call { color: #FF0000; font-weight: bold; }
.c_call  { color: #0000FF; }

.line { margin: 0em }

</style>
<script>
function toggleDiv(id) {
    theDiv = document.getElementById(id);
    if (theDiv.style.display != 'block') theDiv.style.display = 'block';
    else theDiv.style.display = 'none';
}
</script>
</head>
        <body>
<p>Generated by Cython 0.20.2 on Thu Jun 26 11:44:01 2014
<p>Raw output: <a href="cPotentials.c">cPotentials.c</a>
<pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1")'> 1: import numpy as np</pre>
<pre id='line1' class='code' style='background-color: #FFFF57'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2")'> 2: cimport numpy as np</pre>
<pre id='line2' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line3")'> 3: from libc.math cimport sqrt, exp, cos, sin</pre>
<pre id='line3' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line4")'> 4: from libc.stdint cimport uint32_t, int32_t, uint8_t</pre>
<pre id='line4' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line5")'> 5: cimport cython</pre>
<pre id='line5' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line6")'> 6: from libc.stdlib cimport abort, malloc, free</pre>
<pre id='line6' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line7")'> 7: from cython.parallel import prange</pre>
<pre id='line7' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line8")'> 8: </pre>
<pre id='line8' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line9")'> 9: </pre>
<pre id='line9' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line10")'> 10: cdef inline int int_max(int a, int b) nogil: return a if a &gt;= b else b</pre>
<pre id='line10' class='code' style='background-color: #FFFFff'>static CYTHON_INLINE int __pyx_f_3lib_9structure_9potential_11cPotentials_int_max(int __pyx_v_a, int __pyx_v_b) {
  int __pyx_r;
  if (((__pyx_v_a &gt;= __pyx_v_b) != 0)) {
    __pyx_t_1 = __pyx_v_a;
  } else {
    __pyx_t_1 = __pyx_v_b;
  }
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line11")'> 11: cdef inline int int_min(int a, int b) nogil: return a if a &lt;= b else b</pre>
<pre id='line11' class='code' style='background-color: #FFFFff'>static CYTHON_INLINE int __pyx_f_3lib_9structure_9potential_11cPotentials_int_min(int __pyx_v_a, int __pyx_v_b) {
  int __pyx_r;
  if (((__pyx_v_a &lt;= __pyx_v_b) != 0)) {
    __pyx_t_1 = __pyx_v_a;
  } else {
    __pyx_t_1 = __pyx_v_b;
  }
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line12")'> 12: </pre>
<pre id='line12' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line13")'> 13: cdef inline double double_max(double a, double b) nogil: return a if a &gt;= b else b</pre>
<pre id='line13' class='code' style='background-color: #FFFFff'>static CYTHON_INLINE double __pyx_f_3lib_9structure_9potential_11cPotentials_double_max(double __pyx_v_a, double __pyx_v_b) {
  double __pyx_r;
  if (((__pyx_v_a &gt;= __pyx_v_b) != 0)) {
    __pyx_t_1 = __pyx_v_a;
  } else {
    __pyx_t_1 = __pyx_v_b;
  }
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line14")'> 14: cdef inline double double_min(double a, double b) nogil: return a if a &lt;= b else b</pre>
<pre id='line14' class='code' style='background-color: #FFFFff'>static CYTHON_INLINE double __pyx_f_3lib_9structure_9potential_11cPotentials_double_min(double __pyx_v_a, double __pyx_v_b) {
  double __pyx_r;
  if (((__pyx_v_a &lt;= __pyx_v_b) != 0)) {
    __pyx_t_1 = __pyx_v_a;
  } else {
    __pyx_t_1 = __pyx_v_b;
  }
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line15")'> 15: </pre>
<pre id='line15' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line16")'> 16: cdef inline double dist3c(double r1x, double r1y, double r1z, double r2x, double r2y, double r2z) nogil:</pre>
<pre id='line16' class='code' style='background-color: #FFFFff'>static CYTHON_INLINE double __pyx_f_3lib_9structure_9potential_11cPotentials_dist3c(double __pyx_v_r1x, double __pyx_v_r1y, double __pyx_v_r1z, double __pyx_v_r2x, double __pyx_v_r2y, double __pyx_v_r2z) {
  double __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line17")'> 17:     return sqrt((r1x - r2x)*(r1x - r2x) + (r1y - r2y)*(r1y - r2y) + (r1z - r2z)*(r1z - r2z))</pre>
<pre id='line17' class='code' style='background-color: #FFFFff'>  __pyx_r = sqrt(((((__pyx_v_r1x - __pyx_v_r2x) * (__pyx_v_r1x - __pyx_v_r2x)) + ((__pyx_v_r1y - __pyx_v_r2y) * (__pyx_v_r1y - __pyx_v_r2y))) + ((__pyx_v_r1z - __pyx_v_r2z) * (__pyx_v_r1z - __pyx_v_r2z))));
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line18")'> 18: cdef inline double dist3c2(double r1x, double r1y, double r1z, double r2x, double r2y, double r2z) nogil:</pre>
<pre id='line18' class='code' style='background-color: #FFFFff'>static CYTHON_INLINE double __pyx_f_3lib_9structure_9potential_11cPotentials_dist3c2(double __pyx_v_r1x, double __pyx_v_r1y, double __pyx_v_r1z, double __pyx_v_r2x, double __pyx_v_r2y, double __pyx_v_r2z) {
  double __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line19")'> 19:     return (r1x - r2x)*(r1x - r2x) + (r1y - r2y)*(r1y - r2y) + (r1z - r2z)*(r1z - r2z)</pre>
<pre id='line19' class='code' style='background-color: #FFFFff'>  __pyx_r = ((((__pyx_v_r1x - __pyx_v_r2x) * (__pyx_v_r1x - __pyx_v_r2x)) + ((__pyx_v_r1y - __pyx_v_r2y) * (__pyx_v_r1y - __pyx_v_r2y))) + ((__pyx_v_r1z - __pyx_v_r2z) * (__pyx_v_r1z - __pyx_v_r2z)));
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line20")'> 20: </pre>
<pre id='line20' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line21")'> 21: </pre>
<pre id='line21' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line22")'> 22: @cython.boundscheck(False)</pre>
<pre id='line22' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF15' onclick='toggleDiv("line23")'> 23: def mj(int[:, :] resLookUp, int[:] res_types, double[:, :] ca_dist, double[:, :] xyz, double[:, :] mjPot,</pre>
<pre id='line23' class='code' style='background-color: #FFFF15'>/* Python wrapper */
static PyObject *__pyx_pw_3lib_9structure_9potential_11cPotentials_1mj(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_3lib_9structure_9potential_11cPotentials_1mj = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("mj"), (PyCFunction)__pyx_pw_3lib_9structure_9potential_11cPotentials_1mj, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_3lib_9structure_9potential_11cPotentials_1mj(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_resLookUp = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_res_types = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_ca_dist = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_xyz = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_mjPot = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_cutoff;
  int __pyx_v_c_beta_pos;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("mj (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_resLookUp,&amp;__pyx_n_s_res_types,&amp;__pyx_n_s_ca_dist,&amp;__pyx_n_s_xyz,&amp;__pyx_n_s_mjPot,&amp;__pyx_n_s_cutoff,&amp;__pyx_n_s_c_beta_pos,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_resLookUp)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_res_types)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("mj", 0, 5, 7, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_ca_dist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("mj", 0, 5, 7, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_xyz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("mj", 0, 5, 7, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_mjPot)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("mj", 0, 5, 7, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_cutoff);
          if (value) { values[5] = value; kw_args--; }
        }
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_c_beta_pos);
          if (value) { values[6] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "mj") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_resLookUp = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[0]);<span class='error_goto'> if (unlikely(!__pyx_v_resLookUp.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_res_types = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1]);<span class='error_goto'> if (unlikely(!__pyx_v_res_types.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_ca_dist = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[2]);<span class='error_goto'> if (unlikely(!__pyx_v_ca_dist.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_xyz = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[3]);<span class='error_goto'> if (unlikely(!__pyx_v_xyz.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_mjPot = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[4]);<span class='error_goto'> if (unlikely(!__pyx_v_mjPot.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    if (values[5]) {
      __pyx_v_cutoff = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]);<span class='error_goto'> if (unlikely((__pyx_v_cutoff == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_cutoff = ((double)6.5);
    }
    if (values[6]) {
      __pyx_v_c_beta_pos = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[6]);<span class='error_goto'> if (unlikely((__pyx_v_c_beta_pos == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_c_beta_pos = ((int)4);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("mj", 0, 5, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.potential.cPotentials.mj", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3lib_9structure_9potential_11cPotentials_mj(__pyx_self, __pyx_v_resLookUp, __pyx_v_res_types, __pyx_v_ca_dist, __pyx_v_xyz, __pyx_v_mjPot, __pyx_v_cutoff, __pyx_v_c_beta_pos);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3lib_9structure_9potential_11cPotentials_mj(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_resLookUp, __Pyx_memviewslice __pyx_v_res_types, __Pyx_memviewslice __pyx_v_ca_dist, __Pyx_memviewslice __pyx_v_xyz, __Pyx_memviewslice __pyx_v_mjPot, double __pyx_v_cutoff, int __pyx_v_c_beta_pos) {
  int __pyx_v_nRes;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_res_i;
  int __pyx_v_res_j;
  int __pyx_v_nCbi;
  int __pyx_v_nCbj;
  double __pyx_v_r1x;
  double __pyx_v_r1y;
  double __pyx_v_r1z;
  double __pyx_v_r2x;
  double __pyx_v_r2y;
  double __pyx_v_r2z;
  double __pyx_v_dij;
  double __pyx_v_cut2;
  CYTHON_UNUSED double __pyx_v_cut_ca2;
  double __pyx_v_E;
  int __pyx_v_nCont;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("mj", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_29);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_30);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_31);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.potential.cPotentials.mj", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_resLookUp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_res_types, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ca_dist, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xyz, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_mjPot, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__18 = <span class='py_c_api'>PyTuple_Pack</span>(25, __pyx_n_s_resLookUp, __pyx_n_s_res_types, __pyx_n_s_ca_dist, __pyx_n_s_xyz, __pyx_n_s_mjPot, __pyx_n_s_cutoff, __pyx_n_s_c_beta_pos, __pyx_n_s_nRes, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_res_i, __pyx_n_s_res_j, __pyx_n_s_nCbi, __pyx_n_s_nCbj, __pyx_n_s_r1x, __pyx_n_s_r1y, __pyx_n_s_r1z, __pyx_n_s_r2x, __pyx_n_s_r2y, __pyx_n_s_r2z, __pyx_n_s_dij, __pyx_n_s_cut2, __pyx_n_s_cut_ca2, __pyx_n_s_E, __pyx_n_s_nCont);<span class='error_goto'> if (unlikely(!__pyx_tuple__18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__18);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__18);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3lib_9structure_9potential_11cPotentials_1mj, NULL, __pyx_n_s_lib_structure_potential_cPotenti);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_mj, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__19 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 25, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__18, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_thomas_devel_lib_structure, __pyx_n_s_mj, 23, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line24")'> 24:        double cutoff=6.5, int c_beta_pos=4):</pre>
<pre id='line24' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line25")'> 25:     cdef int nRes = resLookUp.shape[0]</pre>
<pre id='line25' class='code' style='background-color: #FFFFff'>  __pyx_v_nRes = (__pyx_v_resLookUp.shape[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line26")'> 26:     cdef int i, j, res_i, res_j, nCbi, nCbj</pre>
<pre id='line26' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line27")'> 27:     cdef double r1x, r1y, r1z, r2x, r2y, r2z, dij</pre>
<pre id='line27' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line28")'> 28:     cdef double cut2 = cutoff * cutoff</pre>
<pre id='line28' class='code' style='background-color: #FFFFff'>  __pyx_v_cut2 = (__pyx_v_cutoff * __pyx_v_cutoff);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line29")'> 29:     cdef double cut_ca2 = cutoff * cutoff</pre>
<pre id='line29' class='code' style='background-color: #FFFFff'>  __pyx_v_cut_ca2 = (__pyx_v_cutoff * __pyx_v_cutoff);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line30")'> 30:     cdef double E = 0.0</pre>
<pre id='line30' class='code' style='background-color: #FFFFff'>  __pyx_v_E = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line31")'> 31:     cdef int nCont = 0</pre>
<pre id='line31' class='code' style='background-color: #FFFFff'>  __pyx_v_nCont = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line32")'> 32:     for i in prange(nRes, nogil=True):</pre>
<pre id='line32' class='code' style='background-color: #FFFFff'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nRes;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_dij) lastprivate(__pyx_v_r2z) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_r1y) lastprivate(__pyx_v_res_i) lastprivate(__pyx_v_r2x) reduction(+:__pyx_v_E) lastprivate(__pyx_v_nCbj) lastprivate(__pyx_v_r1z) lastprivate(__pyx_v_j) lastprivate(__pyx_v_nCbi) reduction(+:__pyx_v_nCont) lastprivate(__pyx_v_r1x) lastprivate(__pyx_v_r2y) lastprivate(__pyx_v_res_j)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_i = 0 + 1 * __pyx_t_2;
                            /* Initialize private variables to invalid values */
                            __pyx_v_dij = ((double)__PYX_NAN());
                            __pyx_v_r2z = ((double)__PYX_NAN());
                            __pyx_v_r1y = ((double)__PYX_NAN());
                            __pyx_v_res_i = ((int)0xbad0bad0);
                            __pyx_v_r2x = ((double)__PYX_NAN());
                            __pyx_v_nCbj = ((int)0xbad0bad0);
                            __pyx_v_r1z = ((double)__PYX_NAN());
                            __pyx_v_j = ((int)0xbad0bad0);
                            __pyx_v_nCbi = ((int)0xbad0bad0);
                            __pyx_v_r1x = ((double)__PYX_NAN());
                            __pyx_v_r2y = ((double)__PYX_NAN());
                            __pyx_v_res_j = ((int)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line33")'> 33:         res_i = res_types[i]</pre>
<pre id='line33' class='code' style='background-color: #FFFFff'>                            __pyx_t_4 = __pyx_v_i;
                            if (__pyx_t_4 &lt; 0) __pyx_t_4 += __pyx_v_res_types.shape[0];
                            __pyx_v_res_i = (*((int *) ( /* dim=0 */ (__pyx_v_res_types.data + __pyx_t_4 * __pyx_v_res_types.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line34")'> 34:         nCbi = resLookUp[i, c_beta_pos]</pre>
<pre id='line34' class='code' style='background-color: #FFFFff'>                            __pyx_t_5 = __pyx_v_i;
                            __pyx_t_6 = __pyx_v_c_beta_pos;
                            if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_v_resLookUp.shape[0];
                            if (__pyx_t_6 &lt; 0) __pyx_t_6 += __pyx_v_resLookUp.shape[1];
                            __pyx_v_nCbi = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_5 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_6 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line35")'> 35:         r1x = xyz[nCbi, 0]</pre>
<pre id='line35' class='code' style='background-color: #FFFFff'>                            __pyx_t_7 = __pyx_v_nCbi;
                            __pyx_t_8 = 0;
                            if (__pyx_t_7 &lt; 0) __pyx_t_7 += __pyx_v_xyz.shape[0];
                            if (__pyx_t_8 &lt; 0) __pyx_t_8 += __pyx_v_xyz.shape[1];
                            __pyx_v_r1x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_7 * __pyx_v_xyz.strides[0]) ) + __pyx_t_8 * __pyx_v_xyz.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line36")'> 36:         r1y = xyz[nCbi, 1]</pre>
<pre id='line36' class='code' style='background-color: #FFFFff'>                            __pyx_t_9 = __pyx_v_nCbi;
                            __pyx_t_10 = 1;
                            if (__pyx_t_9 &lt; 0) __pyx_t_9 += __pyx_v_xyz.shape[0];
                            if (__pyx_t_10 &lt; 0) __pyx_t_10 += __pyx_v_xyz.shape[1];
                            __pyx_v_r1y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_9 * __pyx_v_xyz.strides[0]) ) + __pyx_t_10 * __pyx_v_xyz.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line37")'> 37:         r1z = xyz[nCbi, 2]</pre>
<pre id='line37' class='code' style='background-color: #FFFFff'>                            __pyx_t_11 = __pyx_v_nCbi;
                            __pyx_t_12 = 2;
                            if (__pyx_t_11 &lt; 0) __pyx_t_11 += __pyx_v_xyz.shape[0];
                            if (__pyx_t_12 &lt; 0) __pyx_t_12 += __pyx_v_xyz.shape[1];
                            __pyx_v_r1z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_11 * __pyx_v_xyz.strides[0]) ) + __pyx_t_12 * __pyx_v_xyz.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line38")'> 38:         for j in range(i + 1, nRes):</pre>
<pre id='line38' class='code' style='background-color: #FFFFff'>                            __pyx_t_13 = __pyx_v_nRes;
                            for (__pyx_t_14 = (__pyx_v_i + 1); __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
                              __pyx_v_j = __pyx_t_14;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line39")'> 39:             res_j = res_types[j]</pre>
<pre id='line39' class='code' style='background-color: #FFFFff'>                              __pyx_t_15 = __pyx_v_j;
                              if (__pyx_t_15 &lt; 0) __pyx_t_15 += __pyx_v_res_types.shape[0];
                              __pyx_v_res_j = (*((int *) ( /* dim=0 */ (__pyx_v_res_types.data + __pyx_t_15 * __pyx_v_res_types.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line40")'> 40:             nCbj = resLookUp[j, c_beta_pos]</pre>
<pre id='line40' class='code' style='background-color: #FFFFff'>                              __pyx_t_16 = __pyx_v_j;
                              __pyx_t_17 = __pyx_v_c_beta_pos;
                              if (__pyx_t_16 &lt; 0) __pyx_t_16 += __pyx_v_resLookUp.shape[0];
                              if (__pyx_t_17 &lt; 0) __pyx_t_17 += __pyx_v_resLookUp.shape[1];
                              __pyx_v_nCbj = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_16 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_17 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line41")'> 41:             if ca_dist[i, j] &lt; (cutoff + 2.0 * 1.6) ** 2:</pre>
<pre id='line41' class='code' style='background-color: #FFFFff'>                              __pyx_t_18 = __pyx_v_i;
                              __pyx_t_19 = __pyx_v_j;
                              if (__pyx_t_18 &lt; 0) __pyx_t_18 += __pyx_v_ca_dist.shape[0];
                              if (__pyx_t_19 &lt; 0) __pyx_t_19 += __pyx_v_ca_dist.shape[1];
                              __pyx_t_20 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ca_dist.data + __pyx_t_18 * __pyx_v_ca_dist.strides[0]) ) + __pyx_t_19 * __pyx_v_ca_dist.strides[1]) ))) &lt; pow((__pyx_v_cutoff + (2.0 * 1.6)), 2.0)) != 0);
                              if (__pyx_t_20) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line42")'> 42:                 r2x = xyz[nCbj, 0]</pre>
<pre id='line42' class='code' style='background-color: #FFFFff'>                                __pyx_t_21 = __pyx_v_nCbj;
                                __pyx_t_22 = 0;
                                if (__pyx_t_21 &lt; 0) __pyx_t_21 += __pyx_v_xyz.shape[0];
                                if (__pyx_t_22 &lt; 0) __pyx_t_22 += __pyx_v_xyz.shape[1];
                                __pyx_v_r2x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_21 * __pyx_v_xyz.strides[0]) ) + __pyx_t_22 * __pyx_v_xyz.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line43")'> 43:                 r2y = xyz[nCbj, 1]</pre>
<pre id='line43' class='code' style='background-color: #FFFFff'>                                __pyx_t_23 = __pyx_v_nCbj;
                                __pyx_t_24 = 1;
                                if (__pyx_t_23 &lt; 0) __pyx_t_23 += __pyx_v_xyz.shape[0];
                                if (__pyx_t_24 &lt; 0) __pyx_t_24 += __pyx_v_xyz.shape[1];
                                __pyx_v_r2y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_23 * __pyx_v_xyz.strides[0]) ) + __pyx_t_24 * __pyx_v_xyz.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line44")'> 44:                 r2z = xyz[nCbj, 2]</pre>
<pre id='line44' class='code' style='background-color: #FFFFff'>                                __pyx_t_25 = __pyx_v_nCbj;
                                __pyx_t_26 = 2;
                                if (__pyx_t_25 &lt; 0) __pyx_t_25 += __pyx_v_xyz.shape[0];
                                if (__pyx_t_26 &lt; 0) __pyx_t_26 += __pyx_v_xyz.shape[1];
                                __pyx_v_r2z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_25 * __pyx_v_xyz.strides[0]) ) + __pyx_t_26 * __pyx_v_xyz.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line45")'> 45:                 dij = dist3c2(r1x, r1y, r1z, r2x, r2y, r2z)</pre>
<pre id='line45' class='code' style='background-color: #FFFFff'>                                __pyx_v_dij = __pyx_f_3lib_9structure_9potential_11cPotentials_dist3c2(__pyx_v_r1x, __pyx_v_r1y, __pyx_v_r1z, __pyx_v_r2x, __pyx_v_r2y, __pyx_v_r2z);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line46")'> 46:                 if dij &lt; cut2:</pre>
<pre id='line46' class='code' style='background-color: #FFFFff'>                                __pyx_t_20 = ((__pyx_v_dij &lt; __pyx_v_cut2) != 0);
                                if (__pyx_t_20) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line47")'> 47:                     E += mjPot[res_i, res_j]</pre>
<pre id='line47' class='code' style='background-color: #FFFFff'>                                  __pyx_t_27 = __pyx_v_res_i;
                                  __pyx_t_28 = __pyx_v_res_j;
                                  if (__pyx_t_27 &lt; 0) __pyx_t_27 += __pyx_v_mjPot.shape[0];
                                  if (__pyx_t_28 &lt; 0) __pyx_t_28 += __pyx_v_mjPot.shape[1];
                                  __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_mjPot.data + __pyx_t_27 * __pyx_v_mjPot.strides[0]) ) + __pyx_t_28 * __pyx_v_mjPot.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line48")'> 48:                     nCont += 1</pre>
<pre id='line48' class='code' style='background-color: #FFFFff'>                                  __pyx_v_nCont = (__pyx_v_nCont + 1);
                                  goto __pyx_L13;
                                }
                                __pyx_L13:;
                                goto __pyx_L12;
                              }
                              __pyx_L12:;
                            }
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line49")'> 49:     return nCont, E</pre>
<pre id='line49' class='code' style='background-color: #FFFF66'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_29 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nCont);<span class='error_goto'> if (unlikely(!__pyx_t_29)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_29);
  __pyx_t_30 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E);<span class='error_goto'> if (unlikely(!__pyx_t_30)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_30);
  __pyx_t_31 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_31)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_31);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_31, 0, __pyx_t_29);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_29);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_31, 1, __pyx_t_30);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_30);
  __pyx_t_29 = 0;
  __pyx_t_30 = 0;
  __pyx_r = __pyx_t_31;
  __pyx_t_31 = 0;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line50")'> 50: </pre>
<pre id='line50' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line51")'> 51: @cython.boundscheck(False)</pre>
<pre id='line51' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line52")'> 52: @cython.cdivision(True)</pre>
<pre id='line52' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF0f' onclick='toggleDiv("line53")'> 53: def centroid2(int[:,:] atom_lookup, int[:] res_types, double[:, :] ca_dist, double[:, :] r, float[:, :, :] potential,</pre>
<pre id='line53' class='code' style='background-color: #FFFF0f'>/* Python wrapper */
static PyObject *__pyx_pw_3lib_9structure_9potential_11cPotentials_3centroid2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3lib_9structure_9potential_11cPotentials_2centroid2[] = "\n    Calculate the potential energy given the UNRES GBV-Sidechain potential and isotropic conditions.\n\n    Parameters\n    ----------\n    atom_lookup : integer array\n            A two dimensional lookup array to find for each residue and atom-type the corresponding\n            position within the coordinate array `r`.\n    c_beta_pos : integer\n            This variable specifies which position in the atom_lookup contains the number of the C-beta\n            atom.\n    res_types : integer array\n            An array containing the residue types of the residues as a one dimensional array. The residue types\n            are in the order as in :py:const:lib.structure.residue_atoms_internal:\n    ca_dist : double array\n            The array `ca_dist` should contain the pair-wise distances of all C-alpha atoms of the protein\n    r : double array\n            The two-dimensional array `r` contains all Cartesian coordinates of all atoms.\n    potential : double array\n            This 3-dimensional array contains pre-calculated potentials of all possible combinations of amino-\n            acids. potential[1,2,10] has to contain the potential of the amino-acid (1) and (2) at a distance\n            of 10 whereas the actual distance is dependent on the range in which the potential was actually\n            calculated. The potential can be calculated with the small program located in:\n            lib.structure.potential.database.make_unres_lookup.py\n    min_dist : double\n            The minimum distance for which the parameter `potential` was calculated. This parameter has to be\n            supplied and depends on the provided pre-calculated potential file.\n    max_dist :double\n            The minimum distance for which the parameter `potential` was calculated (see min_dist)\n    bin_width : double\n            The spacing between the bin of the distance points in the pre-calculated potential\n    cutoff : double\n            Distances between the centroids bi""gger than the cut-off distance will be neglected\n\n    Citation\n    --------\n\n    Citation\n    --------\n    J. Comp. Chem. Vol. 18, 7, 849-873, 1997\n    ";
static PyMethodDef __pyx_mdef_3lib_9structure_9potential_11cPotentials_3centroid2 = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("centroid2"), (PyCFunction)__pyx_pw_3lib_9structure_9potential_11cPotentials_3centroid2, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(__pyx_doc_3lib_9structure_9potential_11cPotentials_2centroid2)};
static PyObject *__pyx_pw_3lib_9structure_9potential_11cPotentials_3centroid2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_atom_lookup = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_res_types = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_ca_dist = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_potential = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_cutoff;
  int __pyx_v_c_beta_pos;
  double __pyx_v_min_dist;
  double __pyx_v_max_dist;
  double __pyx_v_bin_width;
  double __pyx_v_repulsion;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("centroid2 (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_atom_lookup,&amp;__pyx_n_s_res_types,&amp;__pyx_n_s_ca_dist,&amp;__pyx_n_s_r,&amp;__pyx_n_s_potential,&amp;__pyx_n_s_cutoff,&amp;__pyx_n_s_c_beta_pos,&amp;__pyx_n_s_min_dist,&amp;__pyx_n_s_max_dist,&amp;__pyx_n_s_bin_width,&amp;__pyx_n_s_repulsion,0};
    PyObject* values[11] = {0,0,0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_atom_lookup)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_res_types)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("centroid2", 0, 5, 11, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_ca_dist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("centroid2", 0, 5, 11, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("centroid2", 0, 5, 11, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_potential)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("centroid2", 0, 5, 11, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_cutoff);
          if (value) { values[5] = value; kw_args--; }
        }
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_c_beta_pos);
          if (value) { values[6] = value; kw_args--; }
        }
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_min_dist);
          if (value) { values[7] = value; kw_args--; }
        }
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_max_dist);
          if (value) { values[8] = value; kw_args--; }
        }
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_bin_width);
          if (value) { values[9] = value; kw_args--; }
        }
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_repulsion);
          if (value) { values[10] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "centroid2") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_atom_lookup = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[0]);<span class='error_goto'> if (unlikely(!__pyx_v_atom_lookup.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_res_types = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1]);<span class='error_goto'> if (unlikely(!__pyx_v_res_types.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_ca_dist = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[2]);<span class='error_goto'> if (unlikely(!__pyx_v_ca_dist.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_r = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[3]);<span class='error_goto'> if (unlikely(!__pyx_v_r.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_potential = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(values[4]);<span class='error_goto'> if (unlikely(!__pyx_v_potential.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    if (values[5]) {
      __pyx_v_cutoff = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]);<span class='error_goto'> if (unlikely((__pyx_v_cutoff == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_cutoff = ((double)6.5);
    }
    if (values[6]) {
      __pyx_v_c_beta_pos = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[6]);<span class='error_goto'> if (unlikely((__pyx_v_c_beta_pos == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_c_beta_pos = ((int)4);
    }
    if (values[7]) {
      __pyx_v_min_dist = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[7]);<span class='error_goto'> if (unlikely((__pyx_v_min_dist == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_min_dist = ((double)3.5);
    }
    if (values[8]) {
      __pyx_v_max_dist = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[8]);<span class='error_goto'> if (unlikely((__pyx_v_max_dist == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_max_dist = ((double)19.0);
    }
    if (values[9]) {
      __pyx_v_bin_width = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[9]);<span class='error_goto'> if (unlikely((__pyx_v_bin_width == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_bin_width = ((double)0.05);
    }
    if (values[10]) {
      __pyx_v_repulsion = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[10]);<span class='error_goto'> if (unlikely((__pyx_v_repulsion == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_repulsion = ((double)100.0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("centroid2", 0, 5, 11, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.potential.cPotentials.centroid2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3lib_9structure_9potential_11cPotentials_2centroid2(__pyx_self, __pyx_v_atom_lookup, __pyx_v_res_types, __pyx_v_ca_dist, __pyx_v_r, __pyx_v_potential, __pyx_v_cutoff, __pyx_v_c_beta_pos, __pyx_v_min_dist, __pyx_v_max_dist, __pyx_v_bin_width, __pyx_v_repulsion);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3lib_9structure_9potential_11cPotentials_2centroid2(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_atom_lookup, __Pyx_memviewslice __pyx_v_res_types, __Pyx_memviewslice __pyx_v_ca_dist, __Pyx_memviewslice __pyx_v_r, __Pyx_memviewslice __pyx_v_potential, double __pyx_v_cutoff, int __pyx_v_c_beta_pos, double __pyx_v_min_dist, double __pyx_v_max_dist, double __pyx_v_bin_width, double __pyx_v_repulsion) {
  int __pyx_v_nRes;
  int __pyx_v_bin_nbr;
  double __pyx_v_E;
  double __pyx_v_xi;
  double __pyx_v_yi;
  double __pyx_v_zi;
  double __pyx_v_xj;
  double __pyx_v_yj;
  double __pyx_v_zj;
  double __pyx_v_dij;
  int __pyx_v_nCont;
  int __pyx_v_c_beta_atom_nbr_i;
  int __pyx_v_c_beta_atom_nbr_j;
  int __pyx_v_residue_j;
  int __pyx_v_residue_i;
  int __pyx_v_residue_type_i;
  int __pyx_v_residue_type_j;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("centroid2", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_33);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_34);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_35);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.potential.cPotentials.centroid2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_atom_lookup, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_res_types, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ca_dist, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_r, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_potential, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__20 = <span class='py_c_api'>PyTuple_Pack</span>(29, __pyx_n_s_atom_lookup, __pyx_n_s_res_types, __pyx_n_s_ca_dist, __pyx_n_s_r, __pyx_n_s_potential, __pyx_n_s_cutoff, __pyx_n_s_c_beta_pos, __pyx_n_s_min_dist, __pyx_n_s_max_dist, __pyx_n_s_bin_width, __pyx_n_s_repulsion, __pyx_n_s_nRes, __pyx_n_s_bin_nbr, __pyx_n_s_E, __pyx_n_s_dE, __pyx_n_s_xi, __pyx_n_s_yi, __pyx_n_s_zi, __pyx_n_s_xj, __pyx_n_s_yj, __pyx_n_s_zj, __pyx_n_s_dij, __pyx_n_s_nCont, __pyx_n_s_c_beta_atom_nbr_i, __pyx_n_s_c_beta_atom_nbr_j, __pyx_n_s_residue_j, __pyx_n_s_residue_i, __pyx_n_s_residue_type_i, __pyx_n_s_residue_type_j);<span class='error_goto'> if (unlikely(!__pyx_tuple__20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__20);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__20);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3lib_9structure_9potential_11cPotentials_3centroid2, NULL, __pyx_n_s_lib_structure_potential_cPotenti);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_centroid2, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__21 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(11, 0, 29, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__20, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_thomas_devel_lib_structure, __pyx_n_s_centroid2, 53, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line54")'> 54:        double cutoff=6.5, int c_beta_pos=4, double min_dist=3.5, double max_dist=19.0, double bin_width=0.05,</pre>
<pre id='line54' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line55")'> 55:        double repulsion=100):</pre>
<pre id='line55' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line56")'> 56:     """</pre>
<pre id='line56' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line57")'> 57:     Calculate the potential energy given the UNRES GBV-Sidechain potential and isotropic conditions.</pre>
<pre id='line57' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line58")'> 58: </pre>
<pre id='line58' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line59")'> 59:     Parameters</pre>
<pre id='line59' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line60")'> 60:     ----------</pre>
<pre id='line60' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line61")'> 61:     atom_lookup : integer array</pre>
<pre id='line61' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line62")'> 62:             A two dimensional lookup array to find for each residue and atom-type the corresponding</pre>
<pre id='line62' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line63")'> 63:             position within the coordinate array `r`.</pre>
<pre id='line63' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line64")'> 64:     c_beta_pos : integer</pre>
<pre id='line64' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line65")'> 65:             This variable specifies which position in the atom_lookup contains the number of the C-beta</pre>
<pre id='line65' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line66")'> 66:             atom.</pre>
<pre id='line66' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line67")'> 67:     res_types : integer array</pre>
<pre id='line67' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line68")'> 68:             An array containing the residue types of the residues as a one dimensional array. The residue types</pre>
<pre id='line68' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line69")'> 69:             are in the order as in :py:const:lib.structure.residue_atoms_internal:</pre>
<pre id='line69' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line70")'> 70:     ca_dist : double array</pre>
<pre id='line70' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line71")'> 71:             The array `ca_dist` should contain the pair-wise distances of all C-alpha atoms of the protein</pre>
<pre id='line71' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line72")'> 72:     r : double array</pre>
<pre id='line72' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line73")'> 73:             The two-dimensional array `r` contains all Cartesian coordinates of all atoms.</pre>
<pre id='line73' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line74")'> 74:     potential : double array</pre>
<pre id='line74' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line75")'> 75:             This 3-dimensional array contains pre-calculated potentials of all possible combinations of amino-</pre>
<pre id='line75' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line76")'> 76:             acids. potential[1,2,10] has to contain the potential of the amino-acid (1) and (2) at a distance</pre>
<pre id='line76' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line77")'> 77:             of 10 whereas the actual distance is dependent on the range in which the potential was actually</pre>
<pre id='line77' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line78")'> 78:             calculated. The potential can be calculated with the small program located in:</pre>
<pre id='line78' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line79")'> 79:             lib.structure.potential.database.make_unres_lookup.py</pre>
<pre id='line79' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line80")'> 80:     min_dist : double</pre>
<pre id='line80' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line81")'> 81:             The minimum distance for which the parameter `potential` was calculated. This parameter has to be</pre>
<pre id='line81' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line82")'> 82:             supplied and depends on the provided pre-calculated potential file.</pre>
<pre id='line82' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line83")'> 83:     max_dist :double</pre>
<pre id='line83' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line84")'> 84:             The minimum distance for which the parameter `potential` was calculated (see min_dist)</pre>
<pre id='line84' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line85")'> 85:     bin_width : double</pre>
<pre id='line85' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line86")'> 86:             The spacing between the bin of the distance points in the pre-calculated potential</pre>
<pre id='line86' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line87")'> 87:     cutoff : double</pre>
<pre id='line87' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line88")'> 88:             Distances between the centroids bigger than the cut-off distance will be neglected</pre>
<pre id='line88' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line89")'> 89: </pre>
<pre id='line89' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line90")'> 90:     Citation</pre>
<pre id='line90' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line91")'> 91:     --------</pre>
<pre id='line91' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line92")'> 92: </pre>
<pre id='line92' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line93")'> 93:     Citation</pre>
<pre id='line93' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line94")'> 94:     --------</pre>
<pre id='line94' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line95")'> 95:     J. Comp. Chem. Vol. 18, 7, 849-873, 1997</pre>
<pre id='line95' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line96")'> 96:     """</pre>
<pre id='line96' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line97")'> 97: </pre>
<pre id='line97' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line98")'> 98:     cdef int nRes = atom_lookup.shape[0]</pre>
<pre id='line98' class='code' style='background-color: #FFFFff'>  __pyx_v_nRes = (__pyx_v_atom_lookup.shape[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line99")'> 99:     cdef int bin_nbr</pre>
<pre id='line99' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line100")'> 100:     cdef double E, dE</pre>
<pre id='line100' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line101")'> 101:     cdef double xi, yi, zi, xj, yj, zj, dij</pre>
<pre id='line101' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line102")'> 102:     cdef int nCont</pre>
<pre id='line102' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line103")'> 103:     cdef int c_beta_atom_nbr_i, c_beta_atom_nbr_j</pre>
<pre id='line103' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line104")'> 104:     cdef int residue_j, residue_i</pre>
<pre id='line104' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line105")'> 105:     cdef int residue_type_i, residue_type_j</pre>
<pre id='line105' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line106")'> 106: </pre>
<pre id='line106' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line107")'> 107:     E, nCont = 0.0, 0</pre>
<pre id='line107' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = 0.0;
  __pyx_t_2 = 0;
  __pyx_v_E = __pyx_t_1;
  __pyx_v_nCont = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line108")'> 108:     for residue_i in prange(nRes, nogil=True):</pre>
<pre id='line108' class='code' style='background-color: #FFFFff'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
        __pyx_t_2 = __pyx_v_nRes;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_4 = (__pyx_t_2 - 0) / 1;
            if (__pyx_t_4 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_residue_j) lastprivate(__pyx_v_zi) lastprivate(__pyx_v_yj) reduction(+:__pyx_v_nCont) lastprivate(__pyx_v_residue_type_i) lastprivate(__pyx_v_dij) lastprivate(__pyx_v_residue_type_j) lastprivate(__pyx_v_xi) reduction(+:__pyx_v_E) lastprivate(__pyx_v_c_beta_atom_nbr_i) lastprivate(__pyx_v_zj) lastprivate(__pyx_v_c_beta_atom_nbr_j) lastprivate(__pyx_v_yi) lastprivate(__pyx_v_xj) lastprivate(__pyx_v_bin_nbr) firstprivate(__pyx_v_residue_i) lastprivate(__pyx_v_residue_i)
                    #endif /* _OPENMP */
                    for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_4; __pyx_t_3++){
                        {
                            __pyx_v_residue_i = 0 + 1 * __pyx_t_3;
                            /* Initialize private variables to invalid values */
                            __pyx_v_residue_j = ((int)0xbad0bad0);
                            __pyx_v_zi = ((double)__PYX_NAN());
                            __pyx_v_yj = ((double)__PYX_NAN());
                            __pyx_v_residue_type_i = ((int)0xbad0bad0);
                            __pyx_v_dij = ((double)__PYX_NAN());
                            __pyx_v_residue_type_j = ((int)0xbad0bad0);
                            __pyx_v_xi = ((double)__PYX_NAN());
                            __pyx_v_c_beta_atom_nbr_i = ((int)0xbad0bad0);
                            __pyx_v_zj = ((double)__PYX_NAN());
                            __pyx_v_c_beta_atom_nbr_j = ((int)0xbad0bad0);
                            __pyx_v_yi = ((double)__PYX_NAN());
                            __pyx_v_xj = ((double)__PYX_NAN());
                            __pyx_v_bin_nbr = ((int)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line109")'> 109:         c_beta_atom_nbr_i = atom_lookup[residue_i, c_beta_pos]</pre>
<pre id='line109' class='code' style='background-color: #FFFFff'>                            __pyx_t_5 = __pyx_v_residue_i;
                            __pyx_t_6 = __pyx_v_c_beta_pos;
                            if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_v_atom_lookup.shape[0];
                            if (__pyx_t_6 &lt; 0) __pyx_t_6 += __pyx_v_atom_lookup.shape[1];
                            __pyx_v_c_beta_atom_nbr_i = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_atom_lookup.data + __pyx_t_5 * __pyx_v_atom_lookup.strides[0]) ) + __pyx_t_6 * __pyx_v_atom_lookup.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line110")'> 110:         if c_beta_atom_nbr_i &lt; 0: # no side-chain -&gt; next</pre>
<pre id='line110' class='code' style='background-color: #FFFFff'>                            __pyx_t_7 = ((__pyx_v_c_beta_atom_nbr_i &lt; 0) != 0);
                            if (__pyx_t_7) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line111")'> 111:             continue</pre>
<pre id='line111' class='code' style='background-color: #FFFFff'>                              goto __pyx_L6_continue;
                            }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line112")'> 112: </pre>
<pre id='line112' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line113")'> 113:         residue_type_i = res_types[residue_i]</pre>
<pre id='line113' class='code' style='background-color: #FFFFff'>                            __pyx_t_8 = __pyx_v_residue_i;
                            if (__pyx_t_8 &lt; 0) __pyx_t_8 += __pyx_v_res_types.shape[0];
                            __pyx_v_residue_type_i = (*((int *) ( /* dim=0 */ (__pyx_v_res_types.data + __pyx_t_8 * __pyx_v_res_types.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line114")'> 114: </pre>
<pre id='line114' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line115")'> 115:         xi = r[c_beta_atom_nbr_i, 0]</pre>
<pre id='line115' class='code' style='background-color: #FFFFff'>                            __pyx_t_9 = __pyx_v_c_beta_atom_nbr_i;
                            __pyx_t_10 = 0;
                            if (__pyx_t_9 &lt; 0) __pyx_t_9 += __pyx_v_r.shape[0];
                            if (__pyx_t_10 &lt; 0) __pyx_t_10 += __pyx_v_r.shape[1];
                            __pyx_v_xi = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_9 * __pyx_v_r.strides[0]) ) + __pyx_t_10 * __pyx_v_r.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line116")'> 116:         yi = r[c_beta_atom_nbr_i, 1]</pre>
<pre id='line116' class='code' style='background-color: #FFFFff'>                            __pyx_t_11 = __pyx_v_c_beta_atom_nbr_i;
                            __pyx_t_12 = 1;
                            if (__pyx_t_11 &lt; 0) __pyx_t_11 += __pyx_v_r.shape[0];
                            if (__pyx_t_12 &lt; 0) __pyx_t_12 += __pyx_v_r.shape[1];
                            __pyx_v_yi = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_11 * __pyx_v_r.strides[0]) ) + __pyx_t_12 * __pyx_v_r.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line117")'> 117:         zi = r[c_beta_atom_nbr_i, 2]</pre>
<pre id='line117' class='code' style='background-color: #FFFFff'>                            __pyx_t_13 = __pyx_v_c_beta_atom_nbr_i;
                            __pyx_t_14 = 2;
                            if (__pyx_t_13 &lt; 0) __pyx_t_13 += __pyx_v_r.shape[0];
                            if (__pyx_t_14 &lt; 0) __pyx_t_14 += __pyx_v_r.shape[1];
                            __pyx_v_zi = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_13 * __pyx_v_r.strides[0]) ) + __pyx_t_14 * __pyx_v_r.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line118")'> 118: </pre>
<pre id='line118' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line119")'> 119:         for residue_j in range(residue_i + 1, nRes - 1):</pre>
<pre id='line119' class='code' style='background-color: #FFFFff'>                            __pyx_t_15 = (__pyx_v_nRes - 1);
                            for (__pyx_t_16 = (__pyx_v_residue_i + 1); __pyx_t_16 &lt; __pyx_t_15; __pyx_t_16+=1) {
                              __pyx_v_residue_j = __pyx_t_16;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line120")'> 120:             c_beta_atom_nbr_j = atom_lookup[residue_j, c_beta_pos]</pre>
<pre id='line120' class='code' style='background-color: #FFFFff'>                              __pyx_t_17 = __pyx_v_residue_j;
                              __pyx_t_18 = __pyx_v_c_beta_pos;
                              if (__pyx_t_17 &lt; 0) __pyx_t_17 += __pyx_v_atom_lookup.shape[0];
                              if (__pyx_t_18 &lt; 0) __pyx_t_18 += __pyx_v_atom_lookup.shape[1];
                              __pyx_v_c_beta_atom_nbr_j = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_atom_lookup.data + __pyx_t_17 * __pyx_v_atom_lookup.strides[0]) ) + __pyx_t_18 * __pyx_v_atom_lookup.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line121")'> 121:             if c_beta_atom_nbr_j &lt; 0 or ca_dist[residue_i, residue_j] &gt; cutoff:</pre>
<pre id='line121' class='code' style='background-color: #FFFFff'>                              __pyx_t_7 = ((__pyx_v_c_beta_atom_nbr_j &lt; 0) != 0);
                              if (!__pyx_t_7) {
                                __pyx_t_19 = __pyx_v_residue_i;
                                __pyx_t_20 = __pyx_v_residue_j;
                                if (__pyx_t_19 &lt; 0) __pyx_t_19 += __pyx_v_ca_dist.shape[0];
                                if (__pyx_t_20 &lt; 0) __pyx_t_20 += __pyx_v_ca_dist.shape[1];
                                __pyx_t_21 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ca_dist.data + __pyx_t_19 * __pyx_v_ca_dist.strides[0]) ) + __pyx_t_20 * __pyx_v_ca_dist.strides[1]) ))) &gt; __pyx_v_cutoff) != 0);
                                __pyx_t_22 = __pyx_t_21;
                              } else {
                                __pyx_t_22 = __pyx_t_7;
                              }
                              if (__pyx_t_22) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line122")'> 122:                 continue</pre>
<pre id='line122' class='code' style='background-color: #FFFFff'>                                goto __pyx_L11_continue;
                              }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line123")'> 123:             nCont += 1</pre>
<pre id='line123' class='code' style='background-color: #FFFFff'>                              __pyx_v_nCont = (__pyx_v_nCont + 1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line124")'> 124: </pre>
<pre id='line124' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line125")'> 125:             residue_type_j = res_types[residue_j]</pre>
<pre id='line125' class='code' style='background-color: #FFFFff'>                              __pyx_t_23 = __pyx_v_residue_j;
                              if (__pyx_t_23 &lt; 0) __pyx_t_23 += __pyx_v_res_types.shape[0];
                              __pyx_v_residue_type_j = (*((int *) ( /* dim=0 */ (__pyx_v_res_types.data + __pyx_t_23 * __pyx_v_res_types.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line126")'> 126: </pre>
<pre id='line126' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line127")'> 127:             xj = r[c_beta_atom_nbr_j, 0]</pre>
<pre id='line127' class='code' style='background-color: #FFFFff'>                              __pyx_t_24 = __pyx_v_c_beta_atom_nbr_j;
                              __pyx_t_25 = 0;
                              if (__pyx_t_24 &lt; 0) __pyx_t_24 += __pyx_v_r.shape[0];
                              if (__pyx_t_25 &lt; 0) __pyx_t_25 += __pyx_v_r.shape[1];
                              __pyx_v_xj = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_24 * __pyx_v_r.strides[0]) ) + __pyx_t_25 * __pyx_v_r.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line128")'> 128:             yj = r[c_beta_atom_nbr_j, 1]</pre>
<pre id='line128' class='code' style='background-color: #FFFFff'>                              __pyx_t_26 = __pyx_v_c_beta_atom_nbr_j;
                              __pyx_t_27 = 1;
                              if (__pyx_t_26 &lt; 0) __pyx_t_26 += __pyx_v_r.shape[0];
                              if (__pyx_t_27 &lt; 0) __pyx_t_27 += __pyx_v_r.shape[1];
                              __pyx_v_yj = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_26 * __pyx_v_r.strides[0]) ) + __pyx_t_27 * __pyx_v_r.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line129")'> 129:             zj = r[c_beta_atom_nbr_j, 2]</pre>
<pre id='line129' class='code' style='background-color: #FFFFff'>                              __pyx_t_28 = __pyx_v_c_beta_atom_nbr_j;
                              __pyx_t_29 = 2;
                              if (__pyx_t_28 &lt; 0) __pyx_t_28 += __pyx_v_r.shape[0];
                              if (__pyx_t_29 &lt; 0) __pyx_t_29 += __pyx_v_r.shape[1];
                              __pyx_v_zj = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_28 * __pyx_v_r.strides[0]) ) + __pyx_t_29 * __pyx_v_r.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line130")'> 130: </pre>
<pre id='line130' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line131")'> 131:             dij = sqrt((xi-xj)**2 + (yi-yj)**2 + (zi-zj)**2)</pre>
<pre id='line131' class='code' style='background-color: #FFFFff'>                              __pyx_v_dij = sqrt(((pow((__pyx_v_xi - __pyx_v_xj), 2.0) + pow((__pyx_v_yi - __pyx_v_yj), 2.0)) + pow((__pyx_v_zi - __pyx_v_zj), 2.0)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line132")'> 132: </pre>
<pre id='line132' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line133")'> 133:             if dij &lt; min_dist:</pre>
<pre id='line133' class='code' style='background-color: #FFFFff'>                              __pyx_t_22 = ((__pyx_v_dij &lt; __pyx_v_min_dist) != 0);
                              if (__pyx_t_22) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line134")'> 134:                 E += repulsion</pre>
<pre id='line134' class='code' style='background-color: #FFFFff'>                                __pyx_v_E = (__pyx_v_E + __pyx_v_repulsion);
                                goto __pyx_L14;
                              }
                              /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line135")'> 135:             else:</pre>
<pre id='line135' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line136")'> 136:                 dij = double_min(dij, max_dist)</pre>
<pre id='line136' class='code' style='background-color: #FFFFff'>                                __pyx_v_dij = __pyx_f_3lib_9structure_9potential_11cPotentials_double_min(__pyx_v_dij, __pyx_v_max_dist);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line137")'> 137:                 bin_nbr = &lt;int&gt;(dij / bin_width)</pre>
<pre id='line137' class='code' style='background-color: #FFFFff'>                                __pyx_v_bin_nbr = ((int)(__pyx_v_dij / __pyx_v_bin_width));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line138")'> 138:                 E += potential[residue_type_i, residue_type_j, bin_nbr]</pre>
<pre id='line138' class='code' style='background-color: #FFFFff'>                                __pyx_t_30 = __pyx_v_residue_type_i;
                                __pyx_t_31 = __pyx_v_residue_type_j;
                                __pyx_t_32 = __pyx_v_bin_nbr;
                                if (__pyx_t_30 &lt; 0) __pyx_t_30 += __pyx_v_potential.shape[0];
                                if (__pyx_t_31 &lt; 0) __pyx_t_31 += __pyx_v_potential.shape[1];
                                if (__pyx_t_32 &lt; 0) __pyx_t_32 += __pyx_v_potential.shape[2];
                                __pyx_v_E = (__pyx_v_E + (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_potential.data + __pyx_t_30 * __pyx_v_potential.strides[0]) ) + __pyx_t_31 * __pyx_v_potential.strides[1]) ) + __pyx_t_32 * __pyx_v_potential.strides[2]) ))));
                              }
                              __pyx_L14:;
                              __pyx_L11_continue:;
                            }
                            goto __pyx_L16;
                            __pyx_L6_continue:;
                            goto __pyx_L16;
                            __pyx_L16:;
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line139")'> 139: </pre>
<pre id='line139' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line140")'> 140:     return nCont, E</pre>
<pre id='line140' class='code' style='background-color: #FFFF66'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_33 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nCont);<span class='error_goto'> if (unlikely(!__pyx_t_33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_33);
  __pyx_t_34 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E);<span class='error_goto'> if (unlikely(!__pyx_t_34)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_34);
  __pyx_t_35 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_35)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_35);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_35, 0, __pyx_t_33);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_33);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_35, 1, __pyx_t_34);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_34);
  __pyx_t_33 = 0;
  __pyx_t_34 = 0;
  __pyx_r = __pyx_t_35;
  __pyx_t_35 = 0;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line141")'> 141: </pre>
<pre id='line141' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line142")'> 142: </pre>
<pre id='line142' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line143")'> 143: @cython.boundscheck(False)</pre>
<pre id='line143' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line144")'> 144: @cython.cdivision(True)</pre>
<pre id='line144' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF14' onclick='toggleDiv("line145")'> 145: def hBondLookUpAll(int[:, :] resLookUp, double[:, :] caDist, double[:, :] xyz, double[:, :] hPot, double cutoffCA2,</pre>
<pre id='line145' class='code' style='background-color: #FFFF14'>/* Python wrapper */
static PyObject *__pyx_pw_3lib_9structure_9potential_11cPotentials_5hBondLookUpAll(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_3lib_9structure_9potential_11cPotentials_5hBondLookUpAll = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("hBondLookUpAll"), (PyCFunction)__pyx_pw_3lib_9structure_9potential_11cPotentials_5hBondLookUpAll, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_3lib_9structure_9potential_11cPotentials_5hBondLookUpAll(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_resLookUp = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_caDist = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_xyz = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_hPot = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_cutoffCA2;
  double __pyx_v_cutoffH2;
  double __pyx_v_binWidth;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("hBondLookUpAll (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_resLookUp,&amp;__pyx_n_s_caDist,&amp;__pyx_n_s_xyz,&amp;__pyx_n_s_hPot,&amp;__pyx_n_s_cutoffCA2,&amp;__pyx_n_s_cutoffH2,&amp;__pyx_n_s_binWidth,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_resLookUp)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_caDist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("hBondLookUpAll", 0, 6, 7, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_xyz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("hBondLookUpAll", 0, 6, 7, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_hPot)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("hBondLookUpAll", 0, 6, 7, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_cutoffCA2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("hBondLookUpAll", 0, 6, 7, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_cutoffH2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("hBondLookUpAll", 0, 6, 7, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_binWidth);
          if (value) { values[6] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "hBondLookUpAll") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_resLookUp = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[0]);<span class='error_goto'> if (unlikely(!__pyx_v_resLookUp.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_caDist = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[1]);<span class='error_goto'> if (unlikely(!__pyx_v_caDist.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_xyz = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[2]);<span class='error_goto'> if (unlikely(!__pyx_v_xyz.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_hPot = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[3]);<span class='error_goto'> if (unlikely(!__pyx_v_hPot.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_cutoffCA2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_cutoffCA2 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_cutoffH2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]);<span class='error_goto'> if (unlikely((__pyx_v_cutoffH2 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    if (values[6]) {
      __pyx_v_binWidth = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[6]);<span class='error_goto'> if (unlikely((__pyx_v_binWidth == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_binWidth = ((double)0.01);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("hBondLookUpAll", 0, 6, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.potential.cPotentials.hBondLookUpAll", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3lib_9structure_9potential_11cPotentials_4hBondLookUpAll(__pyx_self, __pyx_v_resLookUp, __pyx_v_caDist, __pyx_v_xyz, __pyx_v_hPot, __pyx_v_cutoffCA2, __pyx_v_cutoffH2, __pyx_v_binWidth);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3lib_9structure_9potential_11cPotentials_4hBondLookUpAll(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_resLookUp, __Pyx_memviewslice __pyx_v_caDist, __Pyx_memviewslice __pyx_v_xyz, __Pyx_memviewslice __pyx_v_hPot, double __pyx_v_cutoffCA2, double __pyx_v_cutoffH2, double __pyx_v_binWidth) {
  int __pyx_v_binNbr;
  int __pyx_v_nCi;
  int __pyx_v_nCj;
  int __pyx_v_nNi;
  int __pyx_v_nNj;
  int __pyx_v_nOi;
  int __pyx_v_nOj;
  int __pyx_v_nHi;
  int __pyx_v_nHj;
  double __pyx_v_dONij;
  double __pyx_v_dONji;
  double __pyx_v_dCNij;
  double __pyx_v_dCNji;
  double __pyx_v_dOHij;
  double __pyx_v_dOHji;
  double __pyx_v_dCHij;
  double __pyx_v_dCHji;
  int __pyx_v_nRes;
  int __pyx_v_ri;
  int __pyx_v_rj;
  CYTHON_UNUSED int __pyx_v_maxBin;
  int __pyx_v_nHBond;
  double __pyx_v_E;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("hBondLookUpAll", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_251);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_252);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_253);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.potential.cPotentials.hBondLookUpAll", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_resLookUp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_caDist, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xyz, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_hPot, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__22 = <span class='py_c_api'>PyTuple_Pack</span>(30, __pyx_n_s_resLookUp, __pyx_n_s_caDist, __pyx_n_s_xyz, __pyx_n_s_hPot, __pyx_n_s_cutoffCA2, __pyx_n_s_cutoffH2, __pyx_n_s_binWidth, __pyx_n_s_binNbr, __pyx_n_s_nCi, __pyx_n_s_nCj, __pyx_n_s_nNi, __pyx_n_s_nNj, __pyx_n_s_nOi, __pyx_n_s_nOj, __pyx_n_s_nHi, __pyx_n_s_nHj, __pyx_n_s_dONij, __pyx_n_s_dONji, __pyx_n_s_dCNij, __pyx_n_s_dCNji, __pyx_n_s_dOHij, __pyx_n_s_dOHji, __pyx_n_s_dCHij, __pyx_n_s_dCHji, __pyx_n_s_nRes, __pyx_n_s_ri, __pyx_n_s_rj, __pyx_n_s_maxBin, __pyx_n_s_nHBond, __pyx_n_s_E);<span class='error_goto'> if (unlikely(!__pyx_tuple__22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__22);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__22);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3lib_9structure_9potential_11cPotentials_5hBondLookUpAll, NULL, __pyx_n_s_lib_structure_potential_cPotenti);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_hBondLookUpAll, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__23 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 30, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__22, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_thomas_devel_lib_structure, __pyx_n_s_hBondLookUpAll, 145, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line146")'> 146:                 double cutoffH2, double binWidth=0.01):</pre>
<pre id='line146' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line147")'> 147:     cdef int binNbr, nCi, nCj, nNi, nNj, nOi, nOj, nHi, nHj</pre>
<pre id='line147' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line148")'> 148:     cdef double dONij, dONji, dCNij, dCNji, dOHij, dOHji, dCHij, dCHji</pre>
<pre id='line148' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line149")'> 149:     cdef int nRes = resLookUp.shape[0]</pre>
<pre id='line149' class='code' style='background-color: #FFFFff'>  __pyx_v_nRes = (__pyx_v_resLookUp.shape[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line150")'> 150:     cdef int ri, rj</pre>
<pre id='line150' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line151")'> 151:     cdef int maxBin = hPot.shape[1]</pre>
<pre id='line151' class='code' style='background-color: #FFFFff'>  __pyx_v_maxBin = (__pyx_v_hPot.shape[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line152")'> 152:     cdef int nHBond = 0</pre>
<pre id='line152' class='code' style='background-color: #FFFFff'>  __pyx_v_nHBond = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line153")'> 153: </pre>
<pre id='line153' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line154")'> 154:     cdef double E = 0.0</pre>
<pre id='line154' class='code' style='background-color: #FFFFff'>  __pyx_v_E = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line155")'> 155:     for ri in prange(nRes, nogil=True):</pre>
<pre id='line155' class='code' style='background-color: #FFFFff'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nRes;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_dOHij) lastprivate(__pyx_v_dCNij) lastprivate(__pyx_v_dCNji) reduction(+:__pyx_v_nHBond) lastprivate(__pyx_v_nHj) lastprivate(__pyx_v_nOi) lastprivate(__pyx_v_binNbr) firstprivate(__pyx_v_ri) lastprivate(__pyx_v_ri) lastprivate(__pyx_v_nOj) lastprivate(__pyx_v_dCHji) lastprivate(__pyx_v_nNj) lastprivate(__pyx_v_dOHji) lastprivate(__pyx_v_nCj) lastprivate(__pyx_v_nNi) lastprivate(__pyx_v_dCHij) lastprivate(__pyx_v_rj) lastprivate(__pyx_v_nCi) lastprivate(__pyx_v_dONij) reduction(+:__pyx_v_E) lastprivate(__pyx_v_dONji) lastprivate(__pyx_v_nHi)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_ri = 0 + 1 * __pyx_t_2;
                            /* Initialize private variables to invalid values */
                            __pyx_v_dOHij = ((double)__PYX_NAN());
                            __pyx_v_dCNij = ((double)__PYX_NAN());
                            __pyx_v_dCNji = ((double)__PYX_NAN());
                            __pyx_v_nHj = ((int)0xbad0bad0);
                            __pyx_v_nOi = ((int)0xbad0bad0);
                            __pyx_v_binNbr = ((int)0xbad0bad0);
                            __pyx_v_nOj = ((int)0xbad0bad0);
                            __pyx_v_dCHji = ((double)__PYX_NAN());
                            __pyx_v_nNj = ((int)0xbad0bad0);
                            __pyx_v_dOHji = ((double)__PYX_NAN());
                            __pyx_v_nCj = ((int)0xbad0bad0);
                            __pyx_v_nNi = ((int)0xbad0bad0);
                            __pyx_v_dCHij = ((double)__PYX_NAN());
                            __pyx_v_rj = ((int)0xbad0bad0);
                            __pyx_v_nCi = ((int)0xbad0bad0);
                            __pyx_v_dONij = ((double)__PYX_NAN());
                            __pyx_v_dONji = ((double)__PYX_NAN());
                            __pyx_v_nHi = ((int)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line156")'> 156:         nNi = resLookUp[ri, 0]</pre>
<pre id='line156' class='code' style='background-color: #FFFFff'>                            __pyx_t_4 = __pyx_v_ri;
                            __pyx_t_5 = 0;
                            if (__pyx_t_4 &lt; 0) __pyx_t_4 += __pyx_v_resLookUp.shape[0];
                            if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_v_resLookUp.shape[1];
                            __pyx_v_nNi = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_4 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_5 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line157")'> 157:         nCi = resLookUp[ri, 2]</pre>
<pre id='line157' class='code' style='background-color: #FFFFff'>                            __pyx_t_6 = __pyx_v_ri;
                            __pyx_t_7 = 2;
                            if (__pyx_t_6 &lt; 0) __pyx_t_6 += __pyx_v_resLookUp.shape[0];
                            if (__pyx_t_7 &lt; 0) __pyx_t_7 += __pyx_v_resLookUp.shape[1];
                            __pyx_v_nCi = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_6 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_7 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line158")'> 158:         nOi = resLookUp[ri, 3]</pre>
<pre id='line158' class='code' style='background-color: #FFFFff'>                            __pyx_t_8 = __pyx_v_ri;
                            __pyx_t_9 = 3;
                            if (__pyx_t_8 &lt; 0) __pyx_t_8 += __pyx_v_resLookUp.shape[0];
                            if (__pyx_t_9 &lt; 0) __pyx_t_9 += __pyx_v_resLookUp.shape[1];
                            __pyx_v_nOi = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_8 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_9 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line159")'> 159:         nHi = resLookUp[ri, 5]</pre>
<pre id='line159' class='code' style='background-color: #FFFFff'>                            __pyx_t_10 = __pyx_v_ri;
                            __pyx_t_11 = 5;
                            if (__pyx_t_10 &lt; 0) __pyx_t_10 += __pyx_v_resLookUp.shape[0];
                            if (__pyx_t_11 &lt; 0) __pyx_t_11 += __pyx_v_resLookUp.shape[1];
                            __pyx_v_nHi = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_10 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_11 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line160")'> 160:         for rj in range(ri + 1, nRes):</pre>
<pre id='line160' class='code' style='background-color: #FFFFff'>                            __pyx_t_12 = __pyx_v_nRes;
                            for (__pyx_t_13 = (__pyx_v_ri + 1); __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
                              __pyx_v_rj = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line161")'> 161:             if caDist[ri, rj] &lt; cutoffCA2:</pre>
<pre id='line161' class='code' style='background-color: #FFFFff'>                              __pyx_t_14 = __pyx_v_ri;
                              __pyx_t_15 = __pyx_v_rj;
                              if (__pyx_t_14 &lt; 0) __pyx_t_14 += __pyx_v_caDist.shape[0];
                              if (__pyx_t_15 &lt; 0) __pyx_t_15 += __pyx_v_caDist.shape[1];
                              __pyx_t_16 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_caDist.data + __pyx_t_14 * __pyx_v_caDist.strides[0]) ) + __pyx_t_15 * __pyx_v_caDist.strides[1]) ))) &lt; __pyx_v_cutoffCA2) != 0);
                              if (__pyx_t_16) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line162")'> 162:                 nNj = resLookUp[rj, 0]</pre>
<pre id='line162' class='code' style='background-color: #FFFFff'>                                __pyx_t_17 = __pyx_v_rj;
                                __pyx_t_18 = 0;
                                if (__pyx_t_17 &lt; 0) __pyx_t_17 += __pyx_v_resLookUp.shape[0];
                                if (__pyx_t_18 &lt; 0) __pyx_t_18 += __pyx_v_resLookUp.shape[1];
                                __pyx_v_nNj = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_17 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_18 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line163")'> 163:                 nCj = resLookUp[rj, 2]</pre>
<pre id='line163' class='code' style='background-color: #FFFFff'>                                __pyx_t_19 = __pyx_v_rj;
                                __pyx_t_20 = 2;
                                if (__pyx_t_19 &lt; 0) __pyx_t_19 += __pyx_v_resLookUp.shape[0];
                                if (__pyx_t_20 &lt; 0) __pyx_t_20 += __pyx_v_resLookUp.shape[1];
                                __pyx_v_nCj = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_19 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_20 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line164")'> 164:                 nOj = resLookUp[rj, 3]</pre>
<pre id='line164' class='code' style='background-color: #FFFFff'>                                __pyx_t_21 = __pyx_v_rj;
                                __pyx_t_22 = 3;
                                if (__pyx_t_21 &lt; 0) __pyx_t_21 += __pyx_v_resLookUp.shape[0];
                                if (__pyx_t_22 &lt; 0) __pyx_t_22 += __pyx_v_resLookUp.shape[1];
                                __pyx_v_nOj = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_21 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_22 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line165")'> 165:                 nHj = resLookUp[rj, 5]</pre>
<pre id='line165' class='code' style='background-color: #FFFFff'>                                __pyx_t_23 = __pyx_v_rj;
                                __pyx_t_24 = 5;
                                if (__pyx_t_23 &lt; 0) __pyx_t_23 += __pyx_v_resLookUp.shape[0];
                                if (__pyx_t_24 &lt; 0) __pyx_t_24 += __pyx_v_resLookUp.shape[1];
                                __pyx_v_nHj = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_23 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_24 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line166")'> 166: </pre>
<pre id='line166' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line167")'> 167:                 if nHi &gt; 0 and nHj &gt; 0: # Both aa no Pro</pre>
<pre id='line167' class='code' style='background-color: #FFFFff'>                                __pyx_t_16 = ((__pyx_v_nHi &gt; 0) != 0);
                                if (__pyx_t_16) {
                                  __pyx_t_25 = ((__pyx_v_nHj &gt; 0) != 0);
                                  __pyx_t_26 = __pyx_t_25;
                                } else {
                                  __pyx_t_26 = __pyx_t_16;
                                }
                                if (__pyx_t_26) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line168")'> 168:                     # i -&gt; j</pre>
<pre id='line168' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line169")'> 169:                     dOHij = dist3c2(xyz[nHj, 0], xyz[nHj, 1], xyz[nHj, 2], xyz[nOi, 0], xyz[nOi, 1], xyz[nOi, 2])</pre>
<pre id='line169' class='code' style='background-color: #FFFFff'>                                  __pyx_t_27 = __pyx_v_nHj;
                                  __pyx_t_28 = 0;
                                  if (__pyx_t_27 &lt; 0) __pyx_t_27 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_28 &lt; 0) __pyx_t_28 += __pyx_v_xyz.shape[1];
                                  __pyx_t_29 = __pyx_v_nHj;
                                  __pyx_t_30 = 1;
                                  if (__pyx_t_29 &lt; 0) __pyx_t_29 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_30 &lt; 0) __pyx_t_30 += __pyx_v_xyz.shape[1];
                                  __pyx_t_31 = __pyx_v_nHj;
                                  __pyx_t_32 = 2;
                                  if (__pyx_t_31 &lt; 0) __pyx_t_31 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_32 &lt; 0) __pyx_t_32 += __pyx_v_xyz.shape[1];
                                  __pyx_t_33 = __pyx_v_nOi;
                                  __pyx_t_34 = 0;
                                  if (__pyx_t_33 &lt; 0) __pyx_t_33 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_34 &lt; 0) __pyx_t_34 += __pyx_v_xyz.shape[1];
                                  __pyx_t_35 = __pyx_v_nOi;
                                  __pyx_t_36 = 1;
                                  if (__pyx_t_35 &lt; 0) __pyx_t_35 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_36 &lt; 0) __pyx_t_36 += __pyx_v_xyz.shape[1];
                                  __pyx_t_37 = __pyx_v_nOi;
                                  __pyx_t_38 = 2;
                                  if (__pyx_t_37 &lt; 0) __pyx_t_37 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_38 &lt; 0) __pyx_t_38 += __pyx_v_xyz.shape[1];
                                  __pyx_v_dOHij = __pyx_f_3lib_9structure_9potential_11cPotentials_dist3c2((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_27 * __pyx_v_xyz.strides[0]) ) + __pyx_t_28 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_29 * __pyx_v_xyz.strides[0]) ) + __pyx_t_30 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_31 * __pyx_v_xyz.strides[0]) ) + __pyx_t_32 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_33 * __pyx_v_xyz.strides[0]) ) + __pyx_t_34 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_35 * __pyx_v_xyz.strides[0]) ) + __pyx_t_36 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_37 * __pyx_v_xyz.strides[0]) ) + __pyx_t_38 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line170")'> 170:                     if dOHij &lt; cutoffH2:</pre>
<pre id='line170' class='code' style='background-color: #FFFFff'>                                  __pyx_t_26 = ((__pyx_v_dOHij &lt; __pyx_v_cutoffH2) != 0);
                                  if (__pyx_t_26) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line171")'> 171:                         nHBond += 1</pre>
<pre id='line171' class='code' style='background-color: #FFFFff'>                                    __pyx_v_nHBond = (__pyx_v_nHBond + 1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line172")'> 172:                         binNbr = &lt;int&gt;(sqrt(dOHij) / binWidth)</pre>
<pre id='line172' class='code' style='background-color: #FFFFff'>                                    __pyx_v_binNbr = ((int)(sqrt(__pyx_v_dOHij) / __pyx_v_binWidth));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line173")'> 173:                         E += hPot[2, binNbr]</pre>
<pre id='line173' class='code' style='background-color: #FFFFff'>                                    __pyx_t_39 = 2;
                                    __pyx_t_40 = __pyx_v_binNbr;
                                    if (__pyx_t_39 &lt; 0) __pyx_t_39 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_40 &lt; 0) __pyx_t_40 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_39 * __pyx_v_hPot.strides[0]) ) + __pyx_t_40 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line174")'> 174:                         dONij = dist3c(xyz[nNj, 0], xyz[nNj, 1], xyz[nNj, 2], xyz[nOi, 0], xyz[nOi, 1], xyz[nOi, 2])</pre>
<pre id='line174' class='code' style='background-color: #FFFFff'>                                    __pyx_t_41 = __pyx_v_nNj;
                                    __pyx_t_42 = 0;
                                    if (__pyx_t_41 &lt; 0) __pyx_t_41 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_42 &lt; 0) __pyx_t_42 += __pyx_v_xyz.shape[1];
                                    __pyx_t_43 = __pyx_v_nNj;
                                    __pyx_t_44 = 1;
                                    if (__pyx_t_43 &lt; 0) __pyx_t_43 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_44 &lt; 0) __pyx_t_44 += __pyx_v_xyz.shape[1];
                                    __pyx_t_45 = __pyx_v_nNj;
                                    __pyx_t_46 = 2;
                                    if (__pyx_t_45 &lt; 0) __pyx_t_45 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_46 &lt; 0) __pyx_t_46 += __pyx_v_xyz.shape[1];
                                    __pyx_t_47 = __pyx_v_nOi;
                                    __pyx_t_48 = 0;
                                    if (__pyx_t_47 &lt; 0) __pyx_t_47 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_48 &lt; 0) __pyx_t_48 += __pyx_v_xyz.shape[1];
                                    __pyx_t_49 = __pyx_v_nOi;
                                    __pyx_t_50 = 1;
                                    if (__pyx_t_49 &lt; 0) __pyx_t_49 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_50 &lt; 0) __pyx_t_50 += __pyx_v_xyz.shape[1];
                                    __pyx_t_51 = __pyx_v_nOi;
                                    __pyx_t_52 = 2;
                                    if (__pyx_t_51 &lt; 0) __pyx_t_51 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_52 &lt; 0) __pyx_t_52 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dONij = __pyx_f_3lib_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_41 * __pyx_v_xyz.strides[0]) ) + __pyx_t_42 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_43 * __pyx_v_xyz.strides[0]) ) + __pyx_t_44 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_45 * __pyx_v_xyz.strides[0]) ) + __pyx_t_46 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_47 * __pyx_v_xyz.strides[0]) ) + __pyx_t_48 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_49 * __pyx_v_xyz.strides[0]) ) + __pyx_t_50 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_51 * __pyx_v_xyz.strides[0]) ) + __pyx_t_52 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line175")'> 175:                         binNbr = &lt;int&gt;(dONij / binWidth)</pre>
<pre id='line175' class='code' style='background-color: #FFFFff'>                                    __pyx_v_binNbr = ((int)(__pyx_v_dONij / __pyx_v_binWidth));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line176")'> 176:                         E += hPot[1, binNbr]</pre>
<pre id='line176' class='code' style='background-color: #FFFFff'>                                    __pyx_t_53 = 1;
                                    __pyx_t_54 = __pyx_v_binNbr;
                                    if (__pyx_t_53 &lt; 0) __pyx_t_53 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_54 &lt; 0) __pyx_t_54 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_53 * __pyx_v_hPot.strides[0]) ) + __pyx_t_54 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line177")'> 177:                         dCHij = dist3c(xyz[nCi, 0], xyz[nCi, 1], xyz[nCi, 2], xyz[nHj, 0], xyz[nHj, 1], xyz[nHj, 2])</pre>
<pre id='line177' class='code' style='background-color: #FFFFff'>                                    __pyx_t_55 = __pyx_v_nCi;
                                    __pyx_t_56 = 0;
                                    if (__pyx_t_55 &lt; 0) __pyx_t_55 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_56 &lt; 0) __pyx_t_56 += __pyx_v_xyz.shape[1];
                                    __pyx_t_57 = __pyx_v_nCi;
                                    __pyx_t_58 = 1;
                                    if (__pyx_t_57 &lt; 0) __pyx_t_57 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_58 &lt; 0) __pyx_t_58 += __pyx_v_xyz.shape[1];
                                    __pyx_t_59 = __pyx_v_nCi;
                                    __pyx_t_60 = 2;
                                    if (__pyx_t_59 &lt; 0) __pyx_t_59 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_60 &lt; 0) __pyx_t_60 += __pyx_v_xyz.shape[1];
                                    __pyx_t_61 = __pyx_v_nHj;
                                    __pyx_t_62 = 0;
                                    if (__pyx_t_61 &lt; 0) __pyx_t_61 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_62 &lt; 0) __pyx_t_62 += __pyx_v_xyz.shape[1];
                                    __pyx_t_63 = __pyx_v_nHj;
                                    __pyx_t_64 = 1;
                                    if (__pyx_t_63 &lt; 0) __pyx_t_63 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_64 &lt; 0) __pyx_t_64 += __pyx_v_xyz.shape[1];
                                    __pyx_t_65 = __pyx_v_nHj;
                                    __pyx_t_66 = 2;
                                    if (__pyx_t_65 &lt; 0) __pyx_t_65 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_66 &lt; 0) __pyx_t_66 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dCHij = __pyx_f_3lib_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_55 * __pyx_v_xyz.strides[0]) ) + __pyx_t_56 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_57 * __pyx_v_xyz.strides[0]) ) + __pyx_t_58 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_59 * __pyx_v_xyz.strides[0]) ) + __pyx_t_60 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_61 * __pyx_v_xyz.strides[0]) ) + __pyx_t_62 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_63 * __pyx_v_xyz.strides[0]) ) + __pyx_t_64 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_65 * __pyx_v_xyz.strides[0]) ) + __pyx_t_66 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line178")'> 178:                         binNbr = &lt;int&gt;(dCHij / binWidth)</pre>
<pre id='line178' class='code' style='background-color: #FFFFff'>                                    __pyx_v_binNbr = ((int)(__pyx_v_dCHij / __pyx_v_binWidth));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line179")'> 179:                         E += hPot[0, binNbr]</pre>
<pre id='line179' class='code' style='background-color: #FFFFff'>                                    __pyx_t_67 = 0;
                                    __pyx_t_68 = __pyx_v_binNbr;
                                    if (__pyx_t_67 &lt; 0) __pyx_t_67 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_68 &lt; 0) __pyx_t_68 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_67 * __pyx_v_hPot.strides[0]) ) + __pyx_t_68 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line180")'> 180:                         dCNij = dist3c(xyz[nNj, 0], xyz[nNj, 1], xyz[nNj, 2], xyz[nCi, 0], xyz[nCi, 1], xyz[nCi, 2])</pre>
<pre id='line180' class='code' style='background-color: #FFFFff'>                                    __pyx_t_69 = __pyx_v_nNj;
                                    __pyx_t_70 = 0;
                                    if (__pyx_t_69 &lt; 0) __pyx_t_69 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_70 &lt; 0) __pyx_t_70 += __pyx_v_xyz.shape[1];
                                    __pyx_t_71 = __pyx_v_nNj;
                                    __pyx_t_72 = 1;
                                    if (__pyx_t_71 &lt; 0) __pyx_t_71 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_72 &lt; 0) __pyx_t_72 += __pyx_v_xyz.shape[1];
                                    __pyx_t_73 = __pyx_v_nNj;
                                    __pyx_t_74 = 2;
                                    if (__pyx_t_73 &lt; 0) __pyx_t_73 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_74 &lt; 0) __pyx_t_74 += __pyx_v_xyz.shape[1];
                                    __pyx_t_75 = __pyx_v_nCi;
                                    __pyx_t_76 = 0;
                                    if (__pyx_t_75 &lt; 0) __pyx_t_75 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_76 &lt; 0) __pyx_t_76 += __pyx_v_xyz.shape[1];
                                    __pyx_t_77 = __pyx_v_nCi;
                                    __pyx_t_78 = 1;
                                    if (__pyx_t_77 &lt; 0) __pyx_t_77 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_78 &lt; 0) __pyx_t_78 += __pyx_v_xyz.shape[1];
                                    __pyx_t_79 = __pyx_v_nCi;
                                    __pyx_t_80 = 2;
                                    if (__pyx_t_79 &lt; 0) __pyx_t_79 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_80 &lt; 0) __pyx_t_80 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dCNij = __pyx_f_3lib_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_69 * __pyx_v_xyz.strides[0]) ) + __pyx_t_70 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_71 * __pyx_v_xyz.strides[0]) ) + __pyx_t_72 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_73 * __pyx_v_xyz.strides[0]) ) + __pyx_t_74 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_75 * __pyx_v_xyz.strides[0]) ) + __pyx_t_76 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_77 * __pyx_v_xyz.strides[0]) ) + __pyx_t_78 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_79 * __pyx_v_xyz.strides[0]) ) + __pyx_t_80 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line181")'> 181:                         binNbr = &lt;int&gt;(dCNij / binWidth)</pre>
<pre id='line181' class='code' style='background-color: #FFFFff'>                                    __pyx_v_binNbr = ((int)(__pyx_v_dCNij / __pyx_v_binWidth));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line182")'> 182:                         E += hPot[3, binNbr]</pre>
<pre id='line182' class='code' style='background-color: #FFFFff'>                                    __pyx_t_81 = 3;
                                    __pyx_t_82 = __pyx_v_binNbr;
                                    if (__pyx_t_81 &lt; 0) __pyx_t_81 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_82 &lt; 0) __pyx_t_82 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_81 * __pyx_v_hPot.strides[0]) ) + __pyx_t_82 * __pyx_v_hPot.strides[1]) ))));
                                    goto __pyx_L14;
                                  }
                                  __pyx_L14:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line183")'> 183:                     # j -&gt; i</pre>
<pre id='line183' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line184")'> 184:                     dOHji = dist3c2(xyz[nHi, 0], xyz[nHi, 1], xyz[nHi, 2],</pre>
<pre id='line184' class='code' style='background-color: #FFFFff'>                                  __pyx_t_83 = __pyx_v_nHi;
                                  __pyx_t_84 = 0;
                                  if (__pyx_t_83 &lt; 0) __pyx_t_83 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_84 &lt; 0) __pyx_t_84 += __pyx_v_xyz.shape[1];
                                  __pyx_t_85 = __pyx_v_nHi;
                                  __pyx_t_86 = 1;
                                  if (__pyx_t_85 &lt; 0) __pyx_t_85 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_86 &lt; 0) __pyx_t_86 += __pyx_v_xyz.shape[1];
                                  __pyx_t_87 = __pyx_v_nHi;
                                  __pyx_t_88 = 2;
                                  if (__pyx_t_87 &lt; 0) __pyx_t_87 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_88 &lt; 0) __pyx_t_88 += __pyx_v_xyz.shape[1];
/* … */
                                  __pyx_v_dOHji = __pyx_f_3lib_9structure_9potential_11cPotentials_dist3c2((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_83 * __pyx_v_xyz.strides[0]) ) + __pyx_t_84 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_85 * __pyx_v_xyz.strides[0]) ) + __pyx_t_86 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_87 * __pyx_v_xyz.strides[0]) ) + __pyx_t_88 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_89 * __pyx_v_xyz.strides[0]) ) + __pyx_t_90 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_91 * __pyx_v_xyz.strides[0]) ) + __pyx_t_92 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_93 * __pyx_v_xyz.strides[0]) ) + __pyx_t_94 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line185")'> 185:                                    xyz[nOj, 0], xyz[nOj, 1], xyz[nOj, 2])</pre>
<pre id='line185' class='code' style='background-color: #FFFFff'>                                  __pyx_t_89 = __pyx_v_nOj;
                                  __pyx_t_90 = 0;
                                  if (__pyx_t_89 &lt; 0) __pyx_t_89 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_90 &lt; 0) __pyx_t_90 += __pyx_v_xyz.shape[1];
                                  __pyx_t_91 = __pyx_v_nOj;
                                  __pyx_t_92 = 1;
                                  if (__pyx_t_91 &lt; 0) __pyx_t_91 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_92 &lt; 0) __pyx_t_92 += __pyx_v_xyz.shape[1];
                                  __pyx_t_93 = __pyx_v_nOj;
                                  __pyx_t_94 = 2;
                                  if (__pyx_t_93 &lt; 0) __pyx_t_93 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_94 &lt; 0) __pyx_t_94 += __pyx_v_xyz.shape[1];
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line186")'> 186:                     if dOHji &lt; cutoffH2:</pre>
<pre id='line186' class='code' style='background-color: #FFFFff'>                                  __pyx_t_26 = ((__pyx_v_dOHji &lt; __pyx_v_cutoffH2) != 0);
                                  if (__pyx_t_26) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line187")'> 187:                         nHBond += 1</pre>
<pre id='line187' class='code' style='background-color: #FFFFff'>                                    __pyx_v_nHBond = (__pyx_v_nHBond + 1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line188")'> 188:                         binNbr = &lt;int&gt;(sqrt(dOHji) / binWidth)</pre>
<pre id='line188' class='code' style='background-color: #FFFFff'>                                    __pyx_v_binNbr = ((int)(sqrt(__pyx_v_dOHji) / __pyx_v_binWidth));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line189")'> 189:                         E += hPot[2, binNbr]</pre>
<pre id='line189' class='code' style='background-color: #FFFFff'>                                    __pyx_t_95 = 2;
                                    __pyx_t_96 = __pyx_v_binNbr;
                                    if (__pyx_t_95 &lt; 0) __pyx_t_95 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_96 &lt; 0) __pyx_t_96 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_95 * __pyx_v_hPot.strides[0]) ) + __pyx_t_96 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line190")'> 190:                         dONji = dist3c(xyz[nNi, 0], xyz[nNi, 1], xyz[nNi, 2], xyz[nOj, 0], xyz[nOj, 1], xyz[nOj, 2])</pre>
<pre id='line190' class='code' style='background-color: #FFFFff'>                                    __pyx_t_97 = __pyx_v_nNi;
                                    __pyx_t_98 = 0;
                                    if (__pyx_t_97 &lt; 0) __pyx_t_97 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_98 &lt; 0) __pyx_t_98 += __pyx_v_xyz.shape[1];
                                    __pyx_t_99 = __pyx_v_nNi;
                                    __pyx_t_100 = 1;
                                    if (__pyx_t_99 &lt; 0) __pyx_t_99 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_100 &lt; 0) __pyx_t_100 += __pyx_v_xyz.shape[1];
                                    __pyx_t_101 = __pyx_v_nNi;
                                    __pyx_t_102 = 2;
                                    if (__pyx_t_101 &lt; 0) __pyx_t_101 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_102 &lt; 0) __pyx_t_102 += __pyx_v_xyz.shape[1];
                                    __pyx_t_103 = __pyx_v_nOj;
                                    __pyx_t_104 = 0;
                                    if (__pyx_t_103 &lt; 0) __pyx_t_103 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_104 &lt; 0) __pyx_t_104 += __pyx_v_xyz.shape[1];
                                    __pyx_t_105 = __pyx_v_nOj;
                                    __pyx_t_106 = 1;
                                    if (__pyx_t_105 &lt; 0) __pyx_t_105 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_106 &lt; 0) __pyx_t_106 += __pyx_v_xyz.shape[1];
                                    __pyx_t_107 = __pyx_v_nOj;
                                    __pyx_t_108 = 2;
                                    if (__pyx_t_107 &lt; 0) __pyx_t_107 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_108 &lt; 0) __pyx_t_108 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dONji = __pyx_f_3lib_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_97 * __pyx_v_xyz.strides[0]) ) + __pyx_t_98 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_99 * __pyx_v_xyz.strides[0]) ) + __pyx_t_100 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_101 * __pyx_v_xyz.strides[0]) ) + __pyx_t_102 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_103 * __pyx_v_xyz.strides[0]) ) + __pyx_t_104 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_105 * __pyx_v_xyz.strides[0]) ) + __pyx_t_106 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_107 * __pyx_v_xyz.strides[0]) ) + __pyx_t_108 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line191")'> 191:                         E += hPot[1, &lt;int&gt;(dONji / binWidth)]</pre>
<pre id='line191' class='code' style='background-color: #FFFFff'>                                    __pyx_t_109 = 1;
                                    __pyx_t_110 = ((int)(__pyx_v_dONji / __pyx_v_binWidth));
                                    if (__pyx_t_109 &lt; 0) __pyx_t_109 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_110 &lt; 0) __pyx_t_110 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_109 * __pyx_v_hPot.strides[0]) ) + __pyx_t_110 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line192")'> 192:                         dCHji = dist3c(xyz[nCj, 0], xyz[nCj, 1], xyz[nCj, 2], xyz[nHi, 0], xyz[nHi, 1], xyz[nHi, 2])</pre>
<pre id='line192' class='code' style='background-color: #FFFFff'>                                    __pyx_t_111 = __pyx_v_nCj;
                                    __pyx_t_112 = 0;
                                    if (__pyx_t_111 &lt; 0) __pyx_t_111 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_112 &lt; 0) __pyx_t_112 += __pyx_v_xyz.shape[1];
                                    __pyx_t_113 = __pyx_v_nCj;
                                    __pyx_t_114 = 1;
                                    if (__pyx_t_113 &lt; 0) __pyx_t_113 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_114 &lt; 0) __pyx_t_114 += __pyx_v_xyz.shape[1];
                                    __pyx_t_115 = __pyx_v_nCj;
                                    __pyx_t_116 = 2;
                                    if (__pyx_t_115 &lt; 0) __pyx_t_115 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_116 &lt; 0) __pyx_t_116 += __pyx_v_xyz.shape[1];
                                    __pyx_t_117 = __pyx_v_nHi;
                                    __pyx_t_118 = 0;
                                    if (__pyx_t_117 &lt; 0) __pyx_t_117 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_118 &lt; 0) __pyx_t_118 += __pyx_v_xyz.shape[1];
                                    __pyx_t_119 = __pyx_v_nHi;
                                    __pyx_t_120 = 1;
                                    if (__pyx_t_119 &lt; 0) __pyx_t_119 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_120 &lt; 0) __pyx_t_120 += __pyx_v_xyz.shape[1];
                                    __pyx_t_121 = __pyx_v_nHi;
                                    __pyx_t_122 = 2;
                                    if (__pyx_t_121 &lt; 0) __pyx_t_121 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_122 &lt; 0) __pyx_t_122 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dCHji = __pyx_f_3lib_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_111 * __pyx_v_xyz.strides[0]) ) + __pyx_t_112 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_113 * __pyx_v_xyz.strides[0]) ) + __pyx_t_114 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_115 * __pyx_v_xyz.strides[0]) ) + __pyx_t_116 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_117 * __pyx_v_xyz.strides[0]) ) + __pyx_t_118 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_119 * __pyx_v_xyz.strides[0]) ) + __pyx_t_120 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_121 * __pyx_v_xyz.strides[0]) ) + __pyx_t_122 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line193")'> 193:                         E += hPot[0, &lt;int&gt;(dCHji / binWidth)]</pre>
<pre id='line193' class='code' style='background-color: #FFFFff'>                                    __pyx_t_123 = 0;
                                    __pyx_t_124 = ((int)(__pyx_v_dCHji / __pyx_v_binWidth));
                                    if (__pyx_t_123 &lt; 0) __pyx_t_123 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_124 &lt; 0) __pyx_t_124 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_123 * __pyx_v_hPot.strides[0]) ) + __pyx_t_124 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line194")'> 194:                         dCNji = dist3c(xyz[nNi, 0], xyz[nNi, 1], xyz[nNi, 2], xyz[nCj, 0], xyz[nCj, 1], xyz[nCj, 2])</pre>
<pre id='line194' class='code' style='background-color: #FFFFff'>                                    __pyx_t_125 = __pyx_v_nNi;
                                    __pyx_t_126 = 0;
                                    if (__pyx_t_125 &lt; 0) __pyx_t_125 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_126 &lt; 0) __pyx_t_126 += __pyx_v_xyz.shape[1];
                                    __pyx_t_127 = __pyx_v_nNi;
                                    __pyx_t_128 = 1;
                                    if (__pyx_t_127 &lt; 0) __pyx_t_127 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_128 &lt; 0) __pyx_t_128 += __pyx_v_xyz.shape[1];
                                    __pyx_t_129 = __pyx_v_nNi;
                                    __pyx_t_130 = 2;
                                    if (__pyx_t_129 &lt; 0) __pyx_t_129 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_130 &lt; 0) __pyx_t_130 += __pyx_v_xyz.shape[1];
                                    __pyx_t_131 = __pyx_v_nCj;
                                    __pyx_t_132 = 0;
                                    if (__pyx_t_131 &lt; 0) __pyx_t_131 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_132 &lt; 0) __pyx_t_132 += __pyx_v_xyz.shape[1];
                                    __pyx_t_133 = __pyx_v_nCj;
                                    __pyx_t_134 = 1;
                                    if (__pyx_t_133 &lt; 0) __pyx_t_133 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_134 &lt; 0) __pyx_t_134 += __pyx_v_xyz.shape[1];
                                    __pyx_t_135 = __pyx_v_nCj;
                                    __pyx_t_136 = 2;
                                    if (__pyx_t_135 &lt; 0) __pyx_t_135 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_136 &lt; 0) __pyx_t_136 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dCNji = __pyx_f_3lib_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_125 * __pyx_v_xyz.strides[0]) ) + __pyx_t_126 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_127 * __pyx_v_xyz.strides[0]) ) + __pyx_t_128 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_129 * __pyx_v_xyz.strides[0]) ) + __pyx_t_130 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_131 * __pyx_v_xyz.strides[0]) ) + __pyx_t_132 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_133 * __pyx_v_xyz.strides[0]) ) + __pyx_t_134 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_135 * __pyx_v_xyz.strides[0]) ) + __pyx_t_136 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line195")'> 195:                         E += hPot[3, &lt;int&gt;(dCNji / binWidth)]</pre>
<pre id='line195' class='code' style='background-color: #FFFFff'>                                    __pyx_t_137 = 3;
                                    __pyx_t_138 = ((int)(__pyx_v_dCNji / __pyx_v_binWidth));
                                    if (__pyx_t_137 &lt; 0) __pyx_t_137 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_138 &lt; 0) __pyx_t_138 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_137 * __pyx_v_hPot.strides[0]) ) + __pyx_t_138 * __pyx_v_hPot.strides[1]) ))));
                                    goto __pyx_L15;
                                  }
                                  __pyx_L15:;
                                  goto __pyx_L13;
                                }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line196")'> 196:                 elif (nHj &gt; 0) and (nHi &lt; 0):</pre>
<pre id='line196' class='code' style='background-color: #FFFFff'>                                __pyx_t_26 = ((__pyx_v_nHj &gt; 0) != 0);
                                if (__pyx_t_26) {
                                  __pyx_t_16 = ((__pyx_v_nHi &lt; 0) != 0);
                                  __pyx_t_25 = __pyx_t_16;
                                } else {
                                  __pyx_t_25 = __pyx_t_26;
                                }
                                if (__pyx_t_25) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line197")'> 197:                     # j -&gt; i</pre>
<pre id='line197' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line198")'> 198:                     dOHij = dist3c2(xyz[nHj, 0], xyz[nHj, 1], xyz[nHj, 2], xyz[nOi, 0], xyz[nOi, 1], xyz[nOi, 2])</pre>
<pre id='line198' class='code' style='background-color: #FFFFff'>                                  __pyx_t_139 = __pyx_v_nHj;
                                  __pyx_t_140 = 0;
                                  if (__pyx_t_139 &lt; 0) __pyx_t_139 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_140 &lt; 0) __pyx_t_140 += __pyx_v_xyz.shape[1];
                                  __pyx_t_141 = __pyx_v_nHj;
                                  __pyx_t_142 = 1;
                                  if (__pyx_t_141 &lt; 0) __pyx_t_141 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_142 &lt; 0) __pyx_t_142 += __pyx_v_xyz.shape[1];
                                  __pyx_t_143 = __pyx_v_nHj;
                                  __pyx_t_144 = 2;
                                  if (__pyx_t_143 &lt; 0) __pyx_t_143 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_144 &lt; 0) __pyx_t_144 += __pyx_v_xyz.shape[1];
                                  __pyx_t_145 = __pyx_v_nOi;
                                  __pyx_t_146 = 0;
                                  if (__pyx_t_145 &lt; 0) __pyx_t_145 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_146 &lt; 0) __pyx_t_146 += __pyx_v_xyz.shape[1];
                                  __pyx_t_147 = __pyx_v_nOi;
                                  __pyx_t_148 = 1;
                                  if (__pyx_t_147 &lt; 0) __pyx_t_147 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_148 &lt; 0) __pyx_t_148 += __pyx_v_xyz.shape[1];
                                  __pyx_t_149 = __pyx_v_nOi;
                                  __pyx_t_150 = 2;
                                  if (__pyx_t_149 &lt; 0) __pyx_t_149 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_150 &lt; 0) __pyx_t_150 += __pyx_v_xyz.shape[1];
                                  __pyx_v_dOHij = __pyx_f_3lib_9structure_9potential_11cPotentials_dist3c2((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_139 * __pyx_v_xyz.strides[0]) ) + __pyx_t_140 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_141 * __pyx_v_xyz.strides[0]) ) + __pyx_t_142 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_143 * __pyx_v_xyz.strides[0]) ) + __pyx_t_144 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_145 * __pyx_v_xyz.strides[0]) ) + __pyx_t_146 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_147 * __pyx_v_xyz.strides[0]) ) + __pyx_t_148 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_149 * __pyx_v_xyz.strides[0]) ) + __pyx_t_150 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line199")'> 199:                     if dOHij &lt; cutoffH2:</pre>
<pre id='line199' class='code' style='background-color: #FFFFff'>                                  __pyx_t_25 = ((__pyx_v_dOHij &lt; __pyx_v_cutoffH2) != 0);
                                  if (__pyx_t_25) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line200")'> 200:                         nHBond += 1</pre>
<pre id='line200' class='code' style='background-color: #FFFFff'>                                    __pyx_v_nHBond = (__pyx_v_nHBond + 1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line201")'> 201:                         E += hPot[2, &lt;int&gt;(sqrt(dOHij) / binWidth)]</pre>
<pre id='line201' class='code' style='background-color: #FFFFff'>                                    __pyx_t_151 = 2;
                                    __pyx_t_152 = ((int)(sqrt(__pyx_v_dOHij) / __pyx_v_binWidth));
                                    if (__pyx_t_151 &lt; 0) __pyx_t_151 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_152 &lt; 0) __pyx_t_152 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_151 * __pyx_v_hPot.strides[0]) ) + __pyx_t_152 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line202")'> 202:                         dONij = dist3c(xyz[nNj, 0], xyz[nNj, 1], xyz[nNj, 2], xyz[nOi, 0], xyz[nOi, 1], xyz[nOi, 2])</pre>
<pre id='line202' class='code' style='background-color: #FFFFff'>                                    __pyx_t_153 = __pyx_v_nNj;
                                    __pyx_t_154 = 0;
                                    if (__pyx_t_153 &lt; 0) __pyx_t_153 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_154 &lt; 0) __pyx_t_154 += __pyx_v_xyz.shape[1];
                                    __pyx_t_155 = __pyx_v_nNj;
                                    __pyx_t_156 = 1;
                                    if (__pyx_t_155 &lt; 0) __pyx_t_155 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_156 &lt; 0) __pyx_t_156 += __pyx_v_xyz.shape[1];
                                    __pyx_t_157 = __pyx_v_nNj;
                                    __pyx_t_158 = 2;
                                    if (__pyx_t_157 &lt; 0) __pyx_t_157 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_158 &lt; 0) __pyx_t_158 += __pyx_v_xyz.shape[1];
                                    __pyx_t_159 = __pyx_v_nOi;
                                    __pyx_t_160 = 0;
                                    if (__pyx_t_159 &lt; 0) __pyx_t_159 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_160 &lt; 0) __pyx_t_160 += __pyx_v_xyz.shape[1];
                                    __pyx_t_161 = __pyx_v_nOi;
                                    __pyx_t_162 = 1;
                                    if (__pyx_t_161 &lt; 0) __pyx_t_161 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_162 &lt; 0) __pyx_t_162 += __pyx_v_xyz.shape[1];
                                    __pyx_t_163 = __pyx_v_nOi;
                                    __pyx_t_164 = 2;
                                    if (__pyx_t_163 &lt; 0) __pyx_t_163 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_164 &lt; 0) __pyx_t_164 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dONij = __pyx_f_3lib_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_153 * __pyx_v_xyz.strides[0]) ) + __pyx_t_154 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_155 * __pyx_v_xyz.strides[0]) ) + __pyx_t_156 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_157 * __pyx_v_xyz.strides[0]) ) + __pyx_t_158 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_159 * __pyx_v_xyz.strides[0]) ) + __pyx_t_160 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_161 * __pyx_v_xyz.strides[0]) ) + __pyx_t_162 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_163 * __pyx_v_xyz.strides[0]) ) + __pyx_t_164 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line203")'> 203:                         E += hPot[1, &lt;int&gt;(dONij / binWidth)]</pre>
<pre id='line203' class='code' style='background-color: #FFFFff'>                                    __pyx_t_165 = 1;
                                    __pyx_t_166 = ((int)(__pyx_v_dONij / __pyx_v_binWidth));
                                    if (__pyx_t_165 &lt; 0) __pyx_t_165 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_166 &lt; 0) __pyx_t_166 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_165 * __pyx_v_hPot.strides[0]) ) + __pyx_t_166 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line204")'> 204:                         dCHij = dist3c(xyz[nCi, 0], xyz[nCi, 1], xyz[nCi, 2], xyz[nHj, 0], xyz[nHj, 1], xyz[nHj, 2])</pre>
<pre id='line204' class='code' style='background-color: #FFFFff'>                                    __pyx_t_167 = __pyx_v_nCi;
                                    __pyx_t_168 = 0;
                                    if (__pyx_t_167 &lt; 0) __pyx_t_167 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_168 &lt; 0) __pyx_t_168 += __pyx_v_xyz.shape[1];
                                    __pyx_t_169 = __pyx_v_nCi;
                                    __pyx_t_170 = 1;
                                    if (__pyx_t_169 &lt; 0) __pyx_t_169 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_170 &lt; 0) __pyx_t_170 += __pyx_v_xyz.shape[1];
                                    __pyx_t_171 = __pyx_v_nCi;
                                    __pyx_t_172 = 2;
                                    if (__pyx_t_171 &lt; 0) __pyx_t_171 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_172 &lt; 0) __pyx_t_172 += __pyx_v_xyz.shape[1];
                                    __pyx_t_173 = __pyx_v_nHj;
                                    __pyx_t_174 = 0;
                                    if (__pyx_t_173 &lt; 0) __pyx_t_173 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_174 &lt; 0) __pyx_t_174 += __pyx_v_xyz.shape[1];
                                    __pyx_t_175 = __pyx_v_nHj;
                                    __pyx_t_176 = 1;
                                    if (__pyx_t_175 &lt; 0) __pyx_t_175 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_176 &lt; 0) __pyx_t_176 += __pyx_v_xyz.shape[1];
                                    __pyx_t_177 = __pyx_v_nHj;
                                    __pyx_t_178 = 2;
                                    if (__pyx_t_177 &lt; 0) __pyx_t_177 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_178 &lt; 0) __pyx_t_178 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dCHij = __pyx_f_3lib_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_167 * __pyx_v_xyz.strides[0]) ) + __pyx_t_168 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_169 * __pyx_v_xyz.strides[0]) ) + __pyx_t_170 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_171 * __pyx_v_xyz.strides[0]) ) + __pyx_t_172 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_173 * __pyx_v_xyz.strides[0]) ) + __pyx_t_174 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_175 * __pyx_v_xyz.strides[0]) ) + __pyx_t_176 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_177 * __pyx_v_xyz.strides[0]) ) + __pyx_t_178 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line205")'> 205:                         E += hPot[0, &lt;int&gt;(dCHij / binWidth)]</pre>
<pre id='line205' class='code' style='background-color: #FFFFff'>                                    __pyx_t_179 = 0;
                                    __pyx_t_180 = ((int)(__pyx_v_dCHij / __pyx_v_binWidth));
                                    if (__pyx_t_179 &lt; 0) __pyx_t_179 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_180 &lt; 0) __pyx_t_180 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_179 * __pyx_v_hPot.strides[0]) ) + __pyx_t_180 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line206")'> 206:                         dCNij = dist3c(xyz[nNj, 0], xyz[nNj, 1], xyz[nNj, 2], xyz[nCi, 0], xyz[nCi, 1], xyz[nCi, 2])</pre>
<pre id='line206' class='code' style='background-color: #FFFFff'>                                    __pyx_t_181 = __pyx_v_nNj;
                                    __pyx_t_182 = 0;
                                    if (__pyx_t_181 &lt; 0) __pyx_t_181 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_182 &lt; 0) __pyx_t_182 += __pyx_v_xyz.shape[1];
                                    __pyx_t_183 = __pyx_v_nNj;
                                    __pyx_t_184 = 1;
                                    if (__pyx_t_183 &lt; 0) __pyx_t_183 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_184 &lt; 0) __pyx_t_184 += __pyx_v_xyz.shape[1];
                                    __pyx_t_185 = __pyx_v_nNj;
                                    __pyx_t_186 = 2;
                                    if (__pyx_t_185 &lt; 0) __pyx_t_185 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_186 &lt; 0) __pyx_t_186 += __pyx_v_xyz.shape[1];
                                    __pyx_t_187 = __pyx_v_nCi;
                                    __pyx_t_188 = 0;
                                    if (__pyx_t_187 &lt; 0) __pyx_t_187 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_188 &lt; 0) __pyx_t_188 += __pyx_v_xyz.shape[1];
                                    __pyx_t_189 = __pyx_v_nCi;
                                    __pyx_t_190 = 1;
                                    if (__pyx_t_189 &lt; 0) __pyx_t_189 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_190 &lt; 0) __pyx_t_190 += __pyx_v_xyz.shape[1];
                                    __pyx_t_191 = __pyx_v_nCi;
                                    __pyx_t_192 = 2;
                                    if (__pyx_t_191 &lt; 0) __pyx_t_191 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_192 &lt; 0) __pyx_t_192 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dCNij = __pyx_f_3lib_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_181 * __pyx_v_xyz.strides[0]) ) + __pyx_t_182 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_183 * __pyx_v_xyz.strides[0]) ) + __pyx_t_184 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_185 * __pyx_v_xyz.strides[0]) ) + __pyx_t_186 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_187 * __pyx_v_xyz.strides[0]) ) + __pyx_t_188 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_189 * __pyx_v_xyz.strides[0]) ) + __pyx_t_190 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_191 * __pyx_v_xyz.strides[0]) ) + __pyx_t_192 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line207")'> 207:                         E += hPot[3, &lt;int&gt;(dCNij / binWidth)]</pre>
<pre id='line207' class='code' style='background-color: #FFFFff'>                                    __pyx_t_193 = 3;
                                    __pyx_t_194 = ((int)(__pyx_v_dCNij / __pyx_v_binWidth));
                                    if (__pyx_t_193 &lt; 0) __pyx_t_193 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_194 &lt; 0) __pyx_t_194 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_193 * __pyx_v_hPot.strides[0]) ) + __pyx_t_194 * __pyx_v_hPot.strides[1]) ))));
                                    goto __pyx_L16;
                                  }
                                  __pyx_L16:;
                                  goto __pyx_L13;
                                }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line208")'> 208:                         # j -&gt; i</pre>
<pre id='line208' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line209")'> 209:                 elif (nHj &lt; 0) and (nHi &gt; 0):</pre>
<pre id='line209' class='code' style='background-color: #FFFFff'>                                __pyx_t_25 = ((__pyx_v_nHj &lt; 0) != 0);
                                if (__pyx_t_25) {
                                  __pyx_t_26 = ((__pyx_v_nHi &gt; 0) != 0);
                                  __pyx_t_16 = __pyx_t_26;
                                } else {
                                  __pyx_t_16 = __pyx_t_25;
                                }
                                if (__pyx_t_16) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line210")'> 210:                     # i -&gt; j</pre>
<pre id='line210' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line211")'> 211:                     dOHji = dist3c2(xyz[nHi, 0], xyz[nHi, 1], xyz[nHi, 2], xyz[nOj, 0], xyz[nOj, 1], xyz[nOj, 2])</pre>
<pre id='line211' class='code' style='background-color: #FFFFff'>                                  __pyx_t_195 = __pyx_v_nHi;
                                  __pyx_t_196 = 0;
                                  if (__pyx_t_195 &lt; 0) __pyx_t_195 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_196 &lt; 0) __pyx_t_196 += __pyx_v_xyz.shape[1];
                                  __pyx_t_197 = __pyx_v_nHi;
                                  __pyx_t_198 = 1;
                                  if (__pyx_t_197 &lt; 0) __pyx_t_197 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_198 &lt; 0) __pyx_t_198 += __pyx_v_xyz.shape[1];
                                  __pyx_t_199 = __pyx_v_nHi;
                                  __pyx_t_200 = 2;
                                  if (__pyx_t_199 &lt; 0) __pyx_t_199 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_200 &lt; 0) __pyx_t_200 += __pyx_v_xyz.shape[1];
                                  __pyx_t_201 = __pyx_v_nOj;
                                  __pyx_t_202 = 0;
                                  if (__pyx_t_201 &lt; 0) __pyx_t_201 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_202 &lt; 0) __pyx_t_202 += __pyx_v_xyz.shape[1];
                                  __pyx_t_203 = __pyx_v_nOj;
                                  __pyx_t_204 = 1;
                                  if (__pyx_t_203 &lt; 0) __pyx_t_203 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_204 &lt; 0) __pyx_t_204 += __pyx_v_xyz.shape[1];
                                  __pyx_t_205 = __pyx_v_nOj;
                                  __pyx_t_206 = 2;
                                  if (__pyx_t_205 &lt; 0) __pyx_t_205 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_206 &lt; 0) __pyx_t_206 += __pyx_v_xyz.shape[1];
                                  __pyx_v_dOHji = __pyx_f_3lib_9structure_9potential_11cPotentials_dist3c2((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_195 * __pyx_v_xyz.strides[0]) ) + __pyx_t_196 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_197 * __pyx_v_xyz.strides[0]) ) + __pyx_t_198 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_199 * __pyx_v_xyz.strides[0]) ) + __pyx_t_200 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_201 * __pyx_v_xyz.strides[0]) ) + __pyx_t_202 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_203 * __pyx_v_xyz.strides[0]) ) + __pyx_t_204 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_205 * __pyx_v_xyz.strides[0]) ) + __pyx_t_206 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line212")'> 212:                     if dOHji &lt; cutoffH2:</pre>
<pre id='line212' class='code' style='background-color: #FFFFff'>                                  __pyx_t_16 = ((__pyx_v_dOHji &lt; __pyx_v_cutoffH2) != 0);
                                  if (__pyx_t_16) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line213")'> 213:                         nHBond += 1</pre>
<pre id='line213' class='code' style='background-color: #FFFFff'>                                    __pyx_v_nHBond = (__pyx_v_nHBond + 1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line214")'> 214:                         E += hPot[2, &lt;int&gt;(sqrt(dOHji) / binWidth)]</pre>
<pre id='line214' class='code' style='background-color: #FFFFff'>                                    __pyx_t_207 = 2;
                                    __pyx_t_208 = ((int)(sqrt(__pyx_v_dOHji) / __pyx_v_binWidth));
                                    if (__pyx_t_207 &lt; 0) __pyx_t_207 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_208 &lt; 0) __pyx_t_208 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_207 * __pyx_v_hPot.strides[0]) ) + __pyx_t_208 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line215")'> 215:                         dONji = dist3c(xyz[nNi, 0], xyz[nNi, 1], xyz[nNi, 2], xyz[nOj, 0], xyz[nOj, 1], xyz[nOj, 2])</pre>
<pre id='line215' class='code' style='background-color: #FFFFff'>                                    __pyx_t_209 = __pyx_v_nNi;
                                    __pyx_t_210 = 0;
                                    if (__pyx_t_209 &lt; 0) __pyx_t_209 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_210 &lt; 0) __pyx_t_210 += __pyx_v_xyz.shape[1];
                                    __pyx_t_211 = __pyx_v_nNi;
                                    __pyx_t_212 = 1;
                                    if (__pyx_t_211 &lt; 0) __pyx_t_211 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_212 &lt; 0) __pyx_t_212 += __pyx_v_xyz.shape[1];
                                    __pyx_t_213 = __pyx_v_nNi;
                                    __pyx_t_214 = 2;
                                    if (__pyx_t_213 &lt; 0) __pyx_t_213 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_214 &lt; 0) __pyx_t_214 += __pyx_v_xyz.shape[1];
                                    __pyx_t_215 = __pyx_v_nOj;
                                    __pyx_t_216 = 0;
                                    if (__pyx_t_215 &lt; 0) __pyx_t_215 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_216 &lt; 0) __pyx_t_216 += __pyx_v_xyz.shape[1];
                                    __pyx_t_217 = __pyx_v_nOj;
                                    __pyx_t_218 = 1;
                                    if (__pyx_t_217 &lt; 0) __pyx_t_217 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_218 &lt; 0) __pyx_t_218 += __pyx_v_xyz.shape[1];
                                    __pyx_t_219 = __pyx_v_nOj;
                                    __pyx_t_220 = 2;
                                    if (__pyx_t_219 &lt; 0) __pyx_t_219 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_220 &lt; 0) __pyx_t_220 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dONji = __pyx_f_3lib_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_209 * __pyx_v_xyz.strides[0]) ) + __pyx_t_210 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_211 * __pyx_v_xyz.strides[0]) ) + __pyx_t_212 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_213 * __pyx_v_xyz.strides[0]) ) + __pyx_t_214 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_215 * __pyx_v_xyz.strides[0]) ) + __pyx_t_216 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_217 * __pyx_v_xyz.strides[0]) ) + __pyx_t_218 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_219 * __pyx_v_xyz.strides[0]) ) + __pyx_t_220 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line216")'> 216:                         E += hPot[1, &lt;int&gt;(dONji / binWidth)]</pre>
<pre id='line216' class='code' style='background-color: #FFFFff'>                                    __pyx_t_221 = 1;
                                    __pyx_t_222 = ((int)(__pyx_v_dONji / __pyx_v_binWidth));
                                    if (__pyx_t_221 &lt; 0) __pyx_t_221 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_222 &lt; 0) __pyx_t_222 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_221 * __pyx_v_hPot.strides[0]) ) + __pyx_t_222 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line217")'> 217:                         dCHji = dist3c(xyz[nCj, 0], xyz[nCj, 1], xyz[nCj, 2], xyz[nHi, 0], xyz[nHi, 1], xyz[nHi, 2])</pre>
<pre id='line217' class='code' style='background-color: #FFFFff'>                                    __pyx_t_223 = __pyx_v_nCj;
                                    __pyx_t_224 = 0;
                                    if (__pyx_t_223 &lt; 0) __pyx_t_223 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_224 &lt; 0) __pyx_t_224 += __pyx_v_xyz.shape[1];
                                    __pyx_t_225 = __pyx_v_nCj;
                                    __pyx_t_226 = 1;
                                    if (__pyx_t_225 &lt; 0) __pyx_t_225 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_226 &lt; 0) __pyx_t_226 += __pyx_v_xyz.shape[1];
                                    __pyx_t_227 = __pyx_v_nCj;
                                    __pyx_t_228 = 2;
                                    if (__pyx_t_227 &lt; 0) __pyx_t_227 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_228 &lt; 0) __pyx_t_228 += __pyx_v_xyz.shape[1];
                                    __pyx_t_229 = __pyx_v_nHi;
                                    __pyx_t_230 = 0;
                                    if (__pyx_t_229 &lt; 0) __pyx_t_229 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_230 &lt; 0) __pyx_t_230 += __pyx_v_xyz.shape[1];
                                    __pyx_t_231 = __pyx_v_nHi;
                                    __pyx_t_232 = 1;
                                    if (__pyx_t_231 &lt; 0) __pyx_t_231 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_232 &lt; 0) __pyx_t_232 += __pyx_v_xyz.shape[1];
                                    __pyx_t_233 = __pyx_v_nHi;
                                    __pyx_t_234 = 2;
                                    if (__pyx_t_233 &lt; 0) __pyx_t_233 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_234 &lt; 0) __pyx_t_234 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dCHji = __pyx_f_3lib_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_223 * __pyx_v_xyz.strides[0]) ) + __pyx_t_224 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_225 * __pyx_v_xyz.strides[0]) ) + __pyx_t_226 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_227 * __pyx_v_xyz.strides[0]) ) + __pyx_t_228 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_229 * __pyx_v_xyz.strides[0]) ) + __pyx_t_230 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_231 * __pyx_v_xyz.strides[0]) ) + __pyx_t_232 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_233 * __pyx_v_xyz.strides[0]) ) + __pyx_t_234 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line218")'> 218:                         E += hPot[0, &lt;int&gt;(dCHji / binWidth)]</pre>
<pre id='line218' class='code' style='background-color: #FFFFff'>                                    __pyx_t_235 = 0;
                                    __pyx_t_236 = ((int)(__pyx_v_dCHji / __pyx_v_binWidth));
                                    if (__pyx_t_235 &lt; 0) __pyx_t_235 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_236 &lt; 0) __pyx_t_236 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_235 * __pyx_v_hPot.strides[0]) ) + __pyx_t_236 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line219")'> 219:                         dCNji = dist3c(xyz[nNi, 0], xyz[nNi, 1], xyz[nNi, 2], xyz[nCj, 0], xyz[nCj, 1], xyz[nCj, 2])</pre>
<pre id='line219' class='code' style='background-color: #FFFFff'>                                    __pyx_t_237 = __pyx_v_nNi;
                                    __pyx_t_238 = 0;
                                    if (__pyx_t_237 &lt; 0) __pyx_t_237 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_238 &lt; 0) __pyx_t_238 += __pyx_v_xyz.shape[1];
                                    __pyx_t_239 = __pyx_v_nNi;
                                    __pyx_t_240 = 1;
                                    if (__pyx_t_239 &lt; 0) __pyx_t_239 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_240 &lt; 0) __pyx_t_240 += __pyx_v_xyz.shape[1];
                                    __pyx_t_241 = __pyx_v_nNi;
                                    __pyx_t_242 = 2;
                                    if (__pyx_t_241 &lt; 0) __pyx_t_241 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_242 &lt; 0) __pyx_t_242 += __pyx_v_xyz.shape[1];
                                    __pyx_t_243 = __pyx_v_nCj;
                                    __pyx_t_244 = 0;
                                    if (__pyx_t_243 &lt; 0) __pyx_t_243 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_244 &lt; 0) __pyx_t_244 += __pyx_v_xyz.shape[1];
                                    __pyx_t_245 = __pyx_v_nCj;
                                    __pyx_t_246 = 1;
                                    if (__pyx_t_245 &lt; 0) __pyx_t_245 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_246 &lt; 0) __pyx_t_246 += __pyx_v_xyz.shape[1];
                                    __pyx_t_247 = __pyx_v_nCj;
                                    __pyx_t_248 = 2;
                                    if (__pyx_t_247 &lt; 0) __pyx_t_247 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_248 &lt; 0) __pyx_t_248 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dCNji = __pyx_f_3lib_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_237 * __pyx_v_xyz.strides[0]) ) + __pyx_t_238 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_239 * __pyx_v_xyz.strides[0]) ) + __pyx_t_240 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_241 * __pyx_v_xyz.strides[0]) ) + __pyx_t_242 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_243 * __pyx_v_xyz.strides[0]) ) + __pyx_t_244 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_245 * __pyx_v_xyz.strides[0]) ) + __pyx_t_246 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_247 * __pyx_v_xyz.strides[0]) ) + __pyx_t_248 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line220")'> 220:                         E += hPot[3, &lt;int&gt;(dCNji / binWidth)]</pre>
<pre id='line220' class='code' style='background-color: #FFFFff'>                                    __pyx_t_249 = 3;
                                    __pyx_t_250 = ((int)(__pyx_v_dCNji / __pyx_v_binWidth));
                                    if (__pyx_t_249 &lt; 0) __pyx_t_249 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_250 &lt; 0) __pyx_t_250 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_249 * __pyx_v_hPot.strides[0]) ) + __pyx_t_250 * __pyx_v_hPot.strides[1]) ))));
                                    goto __pyx_L17;
                                  }
                                  __pyx_L17:;
                                  goto __pyx_L13;
                                }
                                __pyx_L13:;
                                goto __pyx_L12;
                              }
                              __pyx_L12:;
                            }
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line221")'> 221:     return nHBond, E</pre>
<pre id='line221' class='code' style='background-color: #FFFF66'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_251 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nHBond);<span class='error_goto'> if (unlikely(!__pyx_t_251)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_251);
  __pyx_t_252 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E);<span class='error_goto'> if (unlikely(!__pyx_t_252)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_252);
  __pyx_t_253 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_253)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_253);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_253, 0, __pyx_t_251);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_251);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_253, 1, __pyx_t_252);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_252);
  __pyx_t_251 = 0;
  __pyx_t_252 = 0;
  __pyx_r = __pyx_t_253;
  __pyx_t_253 = 0;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line222")'> 222: </pre>
<pre id='line222' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line223")'> 223: </pre>
<pre id='line223' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line224")'> 224: @cython.cdivision(True)</pre>
<pre id='line224' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line225")'> 225: @cython.boundscheck(False)</pre>
<pre id='line225' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF1d' onclick='toggleDiv("line226")'> 226: def gb(np.ndarray rAtoms, double epsilon=4.0, double epsilon0 = 80.1, double cutoff=12.0):</pre>
<pre id='line226' class='code' style='background-color: #FFFF1d'>/* Python wrapper */
static PyObject *__pyx_pw_3lib_9structure_9potential_11cPotentials_7gb(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3lib_9structure_9potential_11cPotentials_6gb[] = "\n    Generalized Born http://en.wikipedia.org/wiki/Implicit_solvation\n    with cutoff-potential potential shifted by value at cutoff to smooth the energy\n    :param rAtoms: atom-list\n    :param epsilon: dielectric constant of proteins: 2-40\n    :param epsilon0: dielectric constant of water 80.1\n    :param cutoff: cutoff-distance in Angstrom\n    :return:\n    ";
static PyMethodDef __pyx_mdef_3lib_9structure_9potential_11cPotentials_7gb = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("gb"), (PyCFunction)__pyx_pw_3lib_9structure_9potential_11cPotentials_7gb, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(__pyx_doc_3lib_9structure_9potential_11cPotentials_6gb)};
static PyObject *__pyx_pw_3lib_9structure_9potential_11cPotentials_7gb(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_rAtoms = 0;
  double __pyx_v_epsilon;
  double __pyx_v_epsilon0;
  double __pyx_v_cutoff;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("gb (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_rAtoms,&amp;__pyx_n_s_epsilon,&amp;__pyx_n_s_epsilon0,&amp;__pyx_n_s_cutoff,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_rAtoms)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_epsilon);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_epsilon0);
          if (value) { values[2] = value; kw_args--; }
        }
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_cutoff);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "gb") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_rAtoms = ((PyArrayObject *)values[0]);
    if (values[1]) {
      __pyx_v_epsilon = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_epsilon == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_epsilon = ((double)4.0);
    }
    if (values[2]) {
      __pyx_v_epsilon0 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_epsilon0 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_epsilon0 = ((double)80.1);
    }
    if (values[3]) {
      __pyx_v_cutoff = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_cutoff == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_cutoff = ((double)12.0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("gb", 0, 1, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.potential.cPotentials.gb", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_rAtoms), __pyx_ptype_5numpy_ndarray, 1, "rAtoms", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_3lib_9structure_9potential_11cPotentials_6gb(__pyx_self, __pyx_v_rAtoms, __pyx_v_epsilon, __pyx_v_epsilon0, __pyx_v_cutoff);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3lib_9structure_9potential_11cPotentials_6gb(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_rAtoms, double __pyx_v_epsilon, double __pyx_v_epsilon0, double __pyx_v_cutoff) {
  int __pyx_v_nAtoms;
  double __pyx_v_cutoff2;
  __Pyx_memviewslice __pyx_v_rs = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_aRadii = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_aCharges = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_pre;
  double __pyx_v_E;
  double __pyx_v_fgbr;
  double __pyx_v_D;
  double __pyx_v_fgbc;
  double __pyx_v_r1x;
  double __pyx_v_r1y;
  double __pyx_v_r1z;
  double __pyx_v_r2x;
  double __pyx_v_r2y;
  double __pyx_v_r2z;
  double __pyx_v_rij2;
  double __pyx_v_ai;
  double __pyx_v_aj;
  double __pyx_v_qi;
  double __pyx_v_qj;
  double __pyx_v_qij;
  double __pyx_v_aij2;
  int __pyx_v_i;
  int __pyx_v_j;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("gb", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.potential.cPotentials.gb", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_rs, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_aRadii, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_aCharges, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__24 = <span class='py_c_api'>PyTuple_Pack</span>(31, __pyx_n_s_rAtoms, __pyx_n_s_epsilon, __pyx_n_s_epsilon0, __pyx_n_s_cutoff, __pyx_n_s_nAtoms, __pyx_n_s_cutoff2, __pyx_n_s_rs, __pyx_n_s_aRadii, __pyx_n_s_aCharges, __pyx_n_s_pre, __pyx_n_s_E, __pyx_n_s_fgbr, __pyx_n_s_D, __pyx_n_s_fgbc, __pyx_n_s_r1x, __pyx_n_s_r1y, __pyx_n_s_r1z, __pyx_n_s_r2x, __pyx_n_s_r2y, __pyx_n_s_r2z, __pyx_n_s_rij, __pyx_n_s_rij2, __pyx_n_s_ai, __pyx_n_s_aj, __pyx_n_s_qi, __pyx_n_s_qj, __pyx_n_s_qij, __pyx_n_s_aij, __pyx_n_s_aij2, __pyx_n_s_i, __pyx_n_s_j);<span class='error_goto'> if (unlikely(!__pyx_tuple__24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__24);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__24);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3lib_9structure_9potential_11cPotentials_7gb, NULL, __pyx_n_s_lib_structure_potential_cPotenti);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_gb, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__25 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 31, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__24, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_thomas_devel_lib_structure, __pyx_n_s_gb, 226, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line227")'> 227:     """</pre>
<pre id='line227' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line228")'> 228:     Generalized Born http://en.wikipedia.org/wiki/Implicit_solvation</pre>
<pre id='line228' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line229")'> 229:     with cutoff-potential potential shifted by value at cutoff to smooth the energy</pre>
<pre id='line229' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line230")'> 230:     :param rAtoms: atom-list</pre>
<pre id='line230' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line231")'> 231:     :param epsilon: dielectric constant of proteins: 2-40</pre>
<pre id='line231' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line232")'> 232:     :param epsilon0: dielectric constant of water 80.1</pre>
<pre id='line232' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line233")'> 233:     :param cutoff: cutoff-distance in Angstrom</pre>
<pre id='line233' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line234")'> 234:     :return:</pre>
<pre id='line234' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line235")'> 235:     """</pre>
<pre id='line235' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line236")'> 236: </pre>
<pre id='line236' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line237")'> 237:     cdef int nAtoms = rAtoms.shape[0]</pre>
<pre id='line237' class='code' style='background-color: #FFFFff'>  __pyx_v_nAtoms = (__pyx_v_rAtoms-&gt;dimensions[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line238")'> 238:     cdef double cutoff2 = cutoff ** 2</pre>
<pre id='line238' class='code' style='background-color: #FFFFff'>  __pyx_v_cutoff2 = pow(__pyx_v_cutoff, 2.0);
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line239")'> 239:     cdef double[:, :] rs = rAtoms['coord']</pre>
<pre id='line239' class='code' style='background-color: #FFFF8d'>  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_rAtoms), __pyx_n_s_coord);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_1);
  if (unlikely(!__pyx_t_2.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_rs = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line240")'> 240:     cdef double[:] aRadii = rAtoms['radius']</pre>
<pre id='line240' class='code' style='background-color: #FFFF8d'>  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_rAtoms), __pyx_n_s_radius);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1);
  if (unlikely(!__pyx_t_3.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_aRadii = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line241")'> 241:     cdef double[:] aCharges = rAtoms['charge']</pre>
<pre id='line241' class='code' style='background-color: #FFFF8d'>  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_rAtoms), __pyx_n_s_charge);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1);
  if (unlikely(!__pyx_t_4.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_aCharges = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line242")'> 242:     cdef double pre = 1. / (8 * 3.14159265359) * (1. / epsilon0 - 1. / epsilon)</pre>
<pre id='line242' class='code' style='background-color: #FFFFff'>  __pyx_v_pre = ((1. / (8.0 * 3.14159265359)) * ((1. / __pyx_v_epsilon0) - (1. / __pyx_v_epsilon)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line243")'> 243:     cdef double E, fgbr, D, fgbc</pre>
<pre id='line243' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line244")'> 244:     cdef double r1x, r1y, r1z, r2x, r2y, r2z, rij, rij2</pre>
<pre id='line244' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line245")'> 245:     cdef double ai, aj, qi, qj, qij, aij, aij2</pre>
<pre id='line245' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line246")'> 246:     cdef int i, j</pre>
<pre id='line246' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line247")'> 247:     E = 0.0</pre>
<pre id='line247' class='code' style='background-color: #FFFFff'>  __pyx_v_E = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line248")'> 248:     for i in range(nAtoms):</pre>
<pre id='line248' class='code' style='background-color: #FFFFff'>  __pyx_t_5 = __pyx_v_nAtoms;
  for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_i = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line249")'> 249:         qi = aCharges[i]</pre>
<pre id='line249' class='code' style='background-color: #FFFFff'>    __pyx_t_7 = __pyx_v_i;
    if (__pyx_t_7 &lt; 0) __pyx_t_7 += __pyx_v_aCharges.shape[0];
    __pyx_v_qi = (*((double *) ( /* dim=0 */ (__pyx_v_aCharges.data + __pyx_t_7 * __pyx_v_aCharges.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line250")'> 250:         if qi == 0.0:</pre>
<pre id='line250' class='code' style='background-color: #FFFFff'>    __pyx_t_8 = ((__pyx_v_qi == 0.0) != 0);
    if (__pyx_t_8) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line251")'> 251:             continue</pre>
<pre id='line251' class='code' style='background-color: #FFFFff'>      goto __pyx_L3_continue;
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line252")'> 252:         r1x = rs[i, 0]</pre>
<pre id='line252' class='code' style='background-color: #FFFFff'>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = 0;
    if (__pyx_t_9 &lt; 0) __pyx_t_9 += __pyx_v_rs.shape[0];
    if (__pyx_t_10 &lt; 0) __pyx_t_10 += __pyx_v_rs.shape[1];
    __pyx_v_r1x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs.data + __pyx_t_9 * __pyx_v_rs.strides[0]) ) + __pyx_t_10 * __pyx_v_rs.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line253")'> 253:         r1y = rs[i, 1]</pre>
<pre id='line253' class='code' style='background-color: #FFFFff'>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = 1;
    if (__pyx_t_11 &lt; 0) __pyx_t_11 += __pyx_v_rs.shape[0];
    if (__pyx_t_12 &lt; 0) __pyx_t_12 += __pyx_v_rs.shape[1];
    __pyx_v_r1y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs.data + __pyx_t_11 * __pyx_v_rs.strides[0]) ) + __pyx_t_12 * __pyx_v_rs.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line254")'> 254:         r1z = rs[i, 2]</pre>
<pre id='line254' class='code' style='background-color: #FFFFff'>    __pyx_t_13 = __pyx_v_i;
    __pyx_t_14 = 2;
    if (__pyx_t_13 &lt; 0) __pyx_t_13 += __pyx_v_rs.shape[0];
    if (__pyx_t_14 &lt; 0) __pyx_t_14 += __pyx_v_rs.shape[1];
    __pyx_v_r1z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs.data + __pyx_t_13 * __pyx_v_rs.strides[0]) ) + __pyx_t_14 * __pyx_v_rs.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line255")'> 255:         ai = aRadii[i]</pre>
<pre id='line255' class='code' style='background-color: #FFFFff'>    __pyx_t_15 = __pyx_v_i;
    if (__pyx_t_15 &lt; 0) __pyx_t_15 += __pyx_v_aRadii.shape[0];
    __pyx_v_ai = (*((double *) ( /* dim=0 */ (__pyx_v_aRadii.data + __pyx_t_15 * __pyx_v_aRadii.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line256")'> 256:         for j in range(i, nAtoms):</pre>
<pre id='line256' class='code' style='background-color: #FFFFff'>    __pyx_t_16 = __pyx_v_nAtoms;
    for (__pyx_t_17 = __pyx_v_i; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
      __pyx_v_j = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line257")'> 257:             qj = aCharges[j]</pre>
<pre id='line257' class='code' style='background-color: #FFFFff'>      __pyx_t_18 = __pyx_v_j;
      if (__pyx_t_18 &lt; 0) __pyx_t_18 += __pyx_v_aCharges.shape[0];
      __pyx_v_qj = (*((double *) ( /* dim=0 */ (__pyx_v_aCharges.data + __pyx_t_18 * __pyx_v_aCharges.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line258")'> 258:             if qj == 0.0:</pre>
<pre id='line258' class='code' style='background-color: #FFFFff'>      __pyx_t_8 = ((__pyx_v_qj == 0.0) != 0);
      if (__pyx_t_8) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line259")'> 259:                 continue</pre>
<pre id='line259' class='code' style='background-color: #FFFFff'>        goto __pyx_L6_continue;
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line260")'> 260:             r2x = rs[j, 0]</pre>
<pre id='line260' class='code' style='background-color: #FFFFff'>      __pyx_t_19 = __pyx_v_j;
      __pyx_t_20 = 0;
      if (__pyx_t_19 &lt; 0) __pyx_t_19 += __pyx_v_rs.shape[0];
      if (__pyx_t_20 &lt; 0) __pyx_t_20 += __pyx_v_rs.shape[1];
      __pyx_v_r2x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs.data + __pyx_t_19 * __pyx_v_rs.strides[0]) ) + __pyx_t_20 * __pyx_v_rs.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line261")'> 261:             r2y = rs[j, 1]</pre>
<pre id='line261' class='code' style='background-color: #FFFFff'>      __pyx_t_21 = __pyx_v_j;
      __pyx_t_22 = 1;
      if (__pyx_t_21 &lt; 0) __pyx_t_21 += __pyx_v_rs.shape[0];
      if (__pyx_t_22 &lt; 0) __pyx_t_22 += __pyx_v_rs.shape[1];
      __pyx_v_r2y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs.data + __pyx_t_21 * __pyx_v_rs.strides[0]) ) + __pyx_t_22 * __pyx_v_rs.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line262")'> 262:             r2z = rs[j, 2]</pre>
<pre id='line262' class='code' style='background-color: #FFFFff'>      __pyx_t_23 = __pyx_v_j;
      __pyx_t_24 = 2;
      if (__pyx_t_23 &lt; 0) __pyx_t_23 += __pyx_v_rs.shape[0];
      if (__pyx_t_24 &lt; 0) __pyx_t_24 += __pyx_v_rs.shape[1];
      __pyx_v_r2z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs.data + __pyx_t_23 * __pyx_v_rs.strides[0]) ) + __pyx_t_24 * __pyx_v_rs.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line263")'> 263:             aj = aRadii[j]</pre>
<pre id='line263' class='code' style='background-color: #FFFFff'>      __pyx_t_25 = __pyx_v_j;
      if (__pyx_t_25 &lt; 0) __pyx_t_25 += __pyx_v_aRadii.shape[0];
      __pyx_v_aj = (*((double *) ( /* dim=0 */ (__pyx_v_aRadii.data + __pyx_t_25 * __pyx_v_aRadii.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line264")'> 264:             rij2 = (r1x - r2x)*(r1x - r2x) + (r1y - r2y)*(r1y - r2y) + (r1z - r2z)*(r1z - r2z)</pre>
<pre id='line264' class='code' style='background-color: #FFFFff'>      __pyx_v_rij2 = ((((__pyx_v_r1x - __pyx_v_r2x) * (__pyx_v_r1x - __pyx_v_r2x)) + ((__pyx_v_r1y - __pyx_v_r2y) * (__pyx_v_r1y - __pyx_v_r2y))) + ((__pyx_v_r1z - __pyx_v_r2z) * (__pyx_v_r1z - __pyx_v_r2z)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line265")'> 265:             if rij2 &gt; cutoff2:</pre>
<pre id='line265' class='code' style='background-color: #FFFFff'>      __pyx_t_8 = ((__pyx_v_rij2 &gt; __pyx_v_cutoff2) != 0);
      if (__pyx_t_8) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line266")'> 266:                 continue</pre>
<pre id='line266' class='code' style='background-color: #FFFFff'>        goto __pyx_L6_continue;
      }
      /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line267")'> 267:             else:</pre>
<pre id='line267' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line268")'> 268:                 aij2 = ai * aj</pre>
<pre id='line268' class='code' style='background-color: #FFFFff'>        __pyx_v_aij2 = (__pyx_v_ai * __pyx_v_aj);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line269")'> 269:                 qij = qi * qj</pre>
<pre id='line269' class='code' style='background-color: #FFFFff'>        __pyx_v_qij = (__pyx_v_qi * __pyx_v_qj);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line270")'> 270:                 D = rij2 / (4.0 * aij2)</pre>
<pre id='line270' class='code' style='background-color: #FFFFff'>        __pyx_v_D = (__pyx_v_rij2 / (4.0 * __pyx_v_aij2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line271")'> 271:                 fgbr = sqrt(rij2 + aij2 * exp(-D))</pre>
<pre id='line271' class='code' style='background-color: #FFFFff'>        __pyx_v_fgbr = sqrt((__pyx_v_rij2 + (__pyx_v_aij2 * exp((-__pyx_v_D)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line272")'> 272:                 fgbc = sqrt(cutoff + aij2 * exp(-D))</pre>
<pre id='line272' class='code' style='background-color: #FFFFff'>        __pyx_v_fgbc = sqrt((__pyx_v_cutoff + (__pyx_v_aij2 * exp((-__pyx_v_D)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line273")'> 273:                 E = E + qij / fgbr - qij/fgbc</pre>
<pre id='line273' class='code' style='background-color: #FFFFff'>        __pyx_v_E = ((__pyx_v_E + (__pyx_v_qij / __pyx_v_fgbr)) - (__pyx_v_qij / __pyx_v_fgbc));
      }
      __pyx_L6_continue:;
    }
    __pyx_L3_continue:;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line274")'> 274:     E *= pre</pre>
<pre id='line274' class='code' style='background-color: #FFFFff'>  __pyx_v_E = (__pyx_v_E * __pyx_v_pre);
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line275")'> 275:     return E</pre>
<pre id='line275' class='code' style='background-color: #FFFF9f'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line276")'> 276: </pre>
<pre id='line276' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line277")'> 277: </pre>
<pre id='line277' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line278")'> 278: @cython.cdivision(True)</pre>
<pre id='line278' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line279")'> 279: @cython.boundscheck(False)</pre>
<pre id='line279' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF1d' onclick='toggleDiv("line280")'> 280: def clash_potential(double[:, :] xyz, double[:] vdw, double clash_tolerance=1.0, double covalent_radius=1.0):</pre>
<pre id='line280' class='code' style='background-color: #FFFF1d'>/* Python wrapper */
static PyObject *__pyx_pw_3lib_9structure_9potential_11cPotentials_9clash_potential(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3lib_9structure_9potential_11cPotentials_8clash_potential[] = "\n    Clash potential\n    with cutoff-potential potential shifted by value at cutoff to smooth the energy\n    :param xyz: Cartesian coordinates of the atoms\n    :param vdw: van der Waals radii of the atoms\n    :param clash_tolerance: clash tolerance\n    :return:\n    ";
static PyMethodDef __pyx_mdef_3lib_9structure_9potential_11cPotentials_9clash_potential = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("clash_potential"), (PyCFunction)__pyx_pw_3lib_9structure_9potential_11cPotentials_9clash_potential, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(__pyx_doc_3lib_9structure_9potential_11cPotentials_8clash_potential)};
static PyObject *__pyx_pw_3lib_9structure_9potential_11cPotentials_9clash_potential(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_xyz = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vdw = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_clash_tolerance;
  double __pyx_v_covalent_radius;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("clash_potential (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_xyz,&amp;__pyx_n_s_vdw,&amp;__pyx_n_s_clash_tolerance,&amp;__pyx_n_s_covalent_radius,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_xyz)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vdw)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("clash_potential", 0, 2, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_clash_tolerance);
          if (value) { values[2] = value; kw_args--; }
        }
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_covalent_radius);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "clash_potential") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_xyz = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[0]);<span class='error_goto'> if (unlikely(!__pyx_v_xyz.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_vdw = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[1]);<span class='error_goto'> if (unlikely(!__pyx_v_vdw.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    if (values[2]) {
      __pyx_v_clash_tolerance = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_clash_tolerance == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_clash_tolerance = ((double)1.0);
    }
    if (values[3]) {
      __pyx_v_covalent_radius = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_covalent_radius == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_covalent_radius = ((double)1.0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("clash_potential", 0, 2, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.potential.cPotentials.clash_potential", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3lib_9structure_9potential_11cPotentials_8clash_potential(__pyx_self, __pyx_v_xyz, __pyx_v_vdw, __pyx_v_clash_tolerance, __pyx_v_covalent_radius);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3lib_9structure_9potential_11cPotentials_8clash_potential(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_xyz, __Pyx_memviewslice __pyx_v_vdw, double __pyx_v_clash_tolerance, double __pyx_v_covalent_radius) {
  int __pyx_v_nAtoms;
  double __pyx_v_E;
  double __pyx_v_r1x;
  double __pyx_v_r1y;
  double __pyx_v_r1z;
  double __pyx_v_r2x;
  double __pyx_v_r2y;
  double __pyx_v_r2z;
  double __pyx_v_rij;
  double __pyx_v_vdwi;
  double __pyx_v_vdwj;
  double __pyx_v_vdwij;
  int __pyx_v_i;
  int __pyx_v_j;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("clash_potential", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.potential.cPotentials.clash_potential", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xyz, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vdw, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__26 = <span class='py_c_api'>PyTuple_Pack</span>(19, __pyx_n_s_xyz, __pyx_n_s_vdw, __pyx_n_s_clash_tolerance, __pyx_n_s_covalent_radius, __pyx_n_s_nAtoms, __pyx_n_s_E, __pyx_n_s_r1x, __pyx_n_s_r1y, __pyx_n_s_r1z, __pyx_n_s_r2x, __pyx_n_s_r2y, __pyx_n_s_r2z, __pyx_n_s_rij, __pyx_n_s_rij2, __pyx_n_s_vdwi, __pyx_n_s_vdwj, __pyx_n_s_vdwij, __pyx_n_s_i, __pyx_n_s_j);<span class='error_goto'> if (unlikely(!__pyx_tuple__26)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__26);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__26);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3lib_9structure_9potential_11cPotentials_9clash_potential, NULL, __pyx_n_s_lib_structure_potential_cPotenti);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_clash_potential, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__27 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 19, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__26, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_thomas_devel_lib_structure, __pyx_n_s_clash_potential, 280, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line281")'> 281:     """</pre>
<pre id='line281' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line282")'> 282:     Clash potential</pre>
<pre id='line282' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line283")'> 283:     with cutoff-potential potential shifted by value at cutoff to smooth the energy</pre>
<pre id='line283' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line284")'> 284:     :param xyz: Cartesian coordinates of the atoms</pre>
<pre id='line284' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line285")'> 285:     :param vdw: van der Waals radii of the atoms</pre>
<pre id='line285' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line286")'> 286:     :param clash_tolerance: clash tolerance</pre>
<pre id='line286' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line287")'> 287:     :return:</pre>
<pre id='line287' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line288")'> 288:     """</pre>
<pre id='line288' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line289")'> 289: </pre>
<pre id='line289' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line290")'> 290:     cdef int nAtoms = xyz.shape[0]</pre>
<pre id='line290' class='code' style='background-color: #FFFFff'>  __pyx_v_nAtoms = (__pyx_v_xyz.shape[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line291")'> 291:     cdef double E</pre>
<pre id='line291' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line292")'> 292:     cdef double r1x, r1y, r1z, r2x, r2y, r2z, rij, rij2</pre>
<pre id='line292' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line293")'> 293:     cdef double vdwi, vdwj, vdwij</pre>
<pre id='line293' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line294")'> 294:     cdef int i, j</pre>
<pre id='line294' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line295")'> 295:     E = 0.0</pre>
<pre id='line295' class='code' style='background-color: #FFFFff'>  __pyx_v_E = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line296")'> 296:     for i in range(nAtoms):</pre>
<pre id='line296' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_nAtoms;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line297")'> 297:         r1x = xyz[i, 0]</pre>
<pre id='line297' class='code' style='background-color: #FFFFff'>    __pyx_t_3 = __pyx_v_i;
    __pyx_t_4 = 0;
    if (__pyx_t_3 &lt; 0) __pyx_t_3 += __pyx_v_xyz.shape[0];
    if (__pyx_t_4 &lt; 0) __pyx_t_4 += __pyx_v_xyz.shape[1];
    __pyx_v_r1x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_3 * __pyx_v_xyz.strides[0]) ) + __pyx_t_4 * __pyx_v_xyz.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line298")'> 298:         r1y = xyz[i, 1]</pre>
<pre id='line298' class='code' style='background-color: #FFFFff'>    __pyx_t_5 = __pyx_v_i;
    __pyx_t_6 = 1;
    if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_v_xyz.shape[0];
    if (__pyx_t_6 &lt; 0) __pyx_t_6 += __pyx_v_xyz.shape[1];
    __pyx_v_r1y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_5 * __pyx_v_xyz.strides[0]) ) + __pyx_t_6 * __pyx_v_xyz.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line299")'> 299:         r1z = xyz[i, 2]</pre>
<pre id='line299' class='code' style='background-color: #FFFFff'>    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = 2;
    if (__pyx_t_7 &lt; 0) __pyx_t_7 += __pyx_v_xyz.shape[0];
    if (__pyx_t_8 &lt; 0) __pyx_t_8 += __pyx_v_xyz.shape[1];
    __pyx_v_r1z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_7 * __pyx_v_xyz.strides[0]) ) + __pyx_t_8 * __pyx_v_xyz.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line300")'> 300:         vdwi = vdw[i]</pre>
<pre id='line300' class='code' style='background-color: #FFFFff'>    __pyx_t_9 = __pyx_v_i;
    if (__pyx_t_9 &lt; 0) __pyx_t_9 += __pyx_v_vdw.shape[0];
    __pyx_v_vdwi = (*((double *) ( /* dim=0 */ (__pyx_v_vdw.data + __pyx_t_9 * __pyx_v_vdw.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line301")'> 301:         for j in range(i + 1, nAtoms):</pre>
<pre id='line301' class='code' style='background-color: #FFFFff'>    __pyx_t_10 = __pyx_v_nAtoms;
    for (__pyx_t_11 = (__pyx_v_i + 1); __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
      __pyx_v_j = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line302")'> 302:             vdwj = vdw[j]</pre>
<pre id='line302' class='code' style='background-color: #FFFFff'>      __pyx_t_12 = __pyx_v_j;
      if (__pyx_t_12 &lt; 0) __pyx_t_12 += __pyx_v_vdw.shape[0];
      __pyx_v_vdwj = (*((double *) ( /* dim=0 */ (__pyx_v_vdw.data + __pyx_t_12 * __pyx_v_vdw.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line303")'> 303:             r2x = xyz[j, 0]</pre>
<pre id='line303' class='code' style='background-color: #FFFFff'>      __pyx_t_13 = __pyx_v_j;
      __pyx_t_14 = 0;
      if (__pyx_t_13 &lt; 0) __pyx_t_13 += __pyx_v_xyz.shape[0];
      if (__pyx_t_14 &lt; 0) __pyx_t_14 += __pyx_v_xyz.shape[1];
      __pyx_v_r2x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_13 * __pyx_v_xyz.strides[0]) ) + __pyx_t_14 * __pyx_v_xyz.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line304")'> 304:             r2y = xyz[j, 1]</pre>
<pre id='line304' class='code' style='background-color: #FFFFff'>      __pyx_t_15 = __pyx_v_j;
      __pyx_t_16 = 1;
      if (__pyx_t_15 &lt; 0) __pyx_t_15 += __pyx_v_xyz.shape[0];
      if (__pyx_t_16 &lt; 0) __pyx_t_16 += __pyx_v_xyz.shape[1];
      __pyx_v_r2y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_15 * __pyx_v_xyz.strides[0]) ) + __pyx_t_16 * __pyx_v_xyz.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line305")'> 305:             r2z = xyz[j, 2]</pre>
<pre id='line305' class='code' style='background-color: #FFFFff'>      __pyx_t_17 = __pyx_v_j;
      __pyx_t_18 = 2;
      if (__pyx_t_17 &lt; 0) __pyx_t_17 += __pyx_v_xyz.shape[0];
      if (__pyx_t_18 &lt; 0) __pyx_t_18 += __pyx_v_xyz.shape[1];
      __pyx_v_r2z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_17 * __pyx_v_xyz.strides[0]) ) + __pyx_t_18 * __pyx_v_xyz.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line306")'> 306:             rij = sqrt((r1x - r2x)*(r1x - r2x) + (r1y - r2y)*(r1y - r2y) + (r1z - r2z)*(r1z - r2z))</pre>
<pre id='line306' class='code' style='background-color: #FFFFff'>      __pyx_v_rij = sqrt(((((__pyx_v_r1x - __pyx_v_r2x) * (__pyx_v_r1x - __pyx_v_r2x)) + ((__pyx_v_r1y - __pyx_v_r2y) * (__pyx_v_r1y - __pyx_v_r2y))) + ((__pyx_v_r1z - __pyx_v_r2z) * (__pyx_v_r1z - __pyx_v_r2z))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line307")'> 307:             vdwij = (vdwi + vdwj)</pre>
<pre id='line307' class='code' style='background-color: #FFFFff'>      __pyx_v_vdwij = (__pyx_v_vdwi + __pyx_v_vdwj);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line308")'> 308:             if covalent_radius &lt; rij &lt; vdwij:</pre>
<pre id='line308' class='code' style='background-color: #FFFFff'>      __pyx_t_19 = (__pyx_v_covalent_radius &lt; __pyx_v_rij);
      if (__pyx_t_19) {
        __pyx_t_19 = (__pyx_v_rij &lt; __pyx_v_vdwij);
      }
      __pyx_t_20 = (__pyx_t_19 != 0);
      if (__pyx_t_20) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line309")'> 309:                 E += ((vdwi + vdwj - rij) / clash_tolerance)**2.0</pre>
<pre id='line309' class='code' style='background-color: #FFFFff'>        __pyx_v_E = (__pyx_v_E + pow((((__pyx_v_vdwi + __pyx_v_vdwj) - __pyx_v_rij) / __pyx_v_clash_tolerance), 2.0));
        goto __pyx_L7;
      }
      __pyx_L7:;
    }
  }
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line310")'> 310:     return E</pre>
<pre id='line310' class='code' style='background-color: #FFFF9f'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_21 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  __pyx_r = __pyx_t_21;
  __pyx_t_21 = 0;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line311")'> 311: </pre>
<pre id='line311' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line312")'> 312: </pre>
<pre id='line312' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line313")'> 313: @cython.boundscheck(False)</pre>
<pre id='line313' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF17' onclick='toggleDiv("line314")'> 314: def go_init(double[:, :] caDist, double epsilon, double nnEFactor=0.1, double cutoff=6.5):</pre>
<pre id='line314' class='code' style='background-color: #FFFF17'>/* Python wrapper */
static PyObject *__pyx_pw_3lib_9structure_9potential_11cPotentials_11go_init(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3lib_9structure_9potential_11cPotentials_10go_init[] = "\n    The go-interactions are implemented as truncated LJ-(6,12) potential. The function looks for each\n    residue within a radius of nativeCut for neighbors if the residues are within the cutoff. If the\n    residues are within the cutoff the value in the returned interaction matrix is set to epsilon\n    otherwise the value is set to epsilon*nnFraction (non-native interaction).\n    ";
static PyMethodDef __pyx_mdef_3lib_9structure_9potential_11cPotentials_11go_init = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("go_init"), (PyCFunction)__pyx_pw_3lib_9structure_9potential_11cPotentials_11go_init, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(__pyx_doc_3lib_9structure_9potential_11cPotentials_10go_init)};
static PyObject *__pyx_pw_3lib_9structure_9potential_11cPotentials_11go_init(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_caDist = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_epsilon;
  double __pyx_v_nnEFactor;
  double __pyx_v_cutoff;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("go_init (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_caDist,&amp;__pyx_n_s_epsilon,&amp;__pyx_n_s_nnEFactor,&amp;__pyx_n_s_cutoff,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_caDist)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_epsilon)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("go_init", 0, 2, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_nnEFactor);
          if (value) { values[2] = value; kw_args--; }
        }
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_cutoff);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "go_init") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_caDist = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[0]);<span class='error_goto'> if (unlikely(!__pyx_v_caDist.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_epsilon = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_epsilon == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    if (values[2]) {
      __pyx_v_nnEFactor = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_nnEFactor == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_nnEFactor = ((double)0.1);
    }
    if (values[3]) {
      __pyx_v_cutoff = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_cutoff == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_cutoff = ((double)6.5);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("go_init", 0, 2, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.potential.cPotentials.go_init", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3lib_9structure_9potential_11cPotentials_10go_init(__pyx_self, __pyx_v_caDist, __pyx_v_epsilon, __pyx_v_nnEFactor, __pyx_v_cutoff);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3lib_9structure_9potential_11cPotentials_10go_init(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_caDist, double __pyx_v_epsilon, double __pyx_v_nnEFactor, double __pyx_v_cutoff) {
  int __pyx_v_i;
  int __pyx_v_j;
  double __pyx_v_rm;
  double __pyx_v_intE;
  int __pyx_v_nRes;
  PyArrayObject *__pyx_v_eMatrix = 0;
  PyArrayObject *__pyx_v_rmMatrix = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_eMatrix;
  __Pyx_Buffer __pyx_pybuffer_eMatrix;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_rmMatrix;
  __Pyx_Buffer __pyx_pybuffer_rmMatrix;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("go_init", 0);
  __pyx_pybuffer_eMatrix.pybuffer.buf = NULL;
  __pyx_pybuffer_eMatrix.refcount = 0;
  __pyx_pybuffernd_eMatrix.data = NULL;
  __pyx_pybuffernd_eMatrix.rcbuffer = &amp;__pyx_pybuffer_eMatrix;
  __pyx_pybuffer_rmMatrix.pybuffer.buf = NULL;
  __pyx_pybuffer_rmMatrix.refcount = 0;
  __pyx_pybuffernd_rmMatrix.data = NULL;
  __pyx_pybuffernd_rmMatrix.rcbuffer = &amp;__pyx_pybuffer_rmMatrix;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_rmMatrix.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.potential.cPotentials.go_init", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_rmMatrix.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_eMatrix);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_rmMatrix);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_caDist, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__28 = <span class='py_c_api'>PyTuple_Pack</span>(11, __pyx_n_s_caDist, __pyx_n_s_epsilon, __pyx_n_s_nnEFactor, __pyx_n_s_cutoff, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_rm, __pyx_n_s_intE, __pyx_n_s_nRes, __pyx_n_s_eMatrix, __pyx_n_s_rmMatrix);<span class='error_goto'> if (unlikely(!__pyx_tuple__28)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__28);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__28);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3lib_9structure_9potential_11cPotentials_11go_init, NULL, __pyx_n_s_lib_structure_potential_cPotenti);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_go_init, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__29 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 11, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__28, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_thomas_devel_lib_structure, __pyx_n_s_go_init, 314, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__29)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line315")'> 315:     """</pre>
<pre id='line315' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line316")'> 316:     The go-interactions are implemented as truncated LJ-(6,12) potential. The function looks for each</pre>
<pre id='line316' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line317")'> 317:     residue within a radius of nativeCut for neighbors if the residues are within the cutoff. If the</pre>
<pre id='line317' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line318")'> 318:     residues are within the cutoff the value in the returned interaction matrix is set to epsilon</pre>
<pre id='line318' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line319")'> 319:     otherwise the value is set to epsilon*nnFraction (non-native interaction).</pre>
<pre id='line319' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line320")'> 320:     """</pre>
<pre id='line320' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line321")'> 321:     cdef int i, j</pre>
<pre id='line321' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line322")'> 322:     cdef double rm, intE</pre>
<pre id='line322' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line323")'> 323:     cdef int nRes = caDist.shape[0]</pre>
<pre id='line323' class='code' style='background-color: #FFFFff'>  __pyx_v_nRes = (__pyx_v_caDist.shape[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line324")'> 324: </pre>
<pre id='line324' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2b' onclick='toggleDiv("line325")'> 325:     cdef np.ndarray[np.float64_t, ndim=2] eMatrix = np.zeros((nRes, nRes), dtype=np.float64)</pre>
<pre id='line325' class='code' style='background-color: #FFFF2b'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nRes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nRes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  __pyx_t_1 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_eMatrix = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_eMatrix.diminfo[0].strides = __pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_eMatrix.diminfo[0].shape = __pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_eMatrix.diminfo[1].strides = __pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_eMatrix.diminfo[1].shape = __pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_6 = 0;
  __pyx_v_eMatrix = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFF2b' onclick='toggleDiv("line326")'> 326:     cdef np.ndarray[np.float64_t, ndim=2] rmMatrix = np.zeros((nRes, nRes), dtype=np.float64)</pre>
<pre id='line326' class='code' style='background-color: #FFFF2b'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nRes);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nRes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  __pyx_t_5 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_rmMatrix.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_rmMatrix = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_rmMatrix.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_rmMatrix.diminfo[0].strides = __pyx_pybuffernd_rmMatrix.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_rmMatrix.diminfo[0].shape = __pyx_pybuffernd_rmMatrix.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_rmMatrix.diminfo[1].strides = __pyx_pybuffernd_rmMatrix.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_rmMatrix.diminfo[1].shape = __pyx_pybuffernd_rmMatrix.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_rmMatrix = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line327")'> 327: </pre>
<pre id='line327' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line328")'> 328:     for i in range(nRes):</pre>
<pre id='line328' class='code' style='background-color: #FFFFff'>  __pyx_t_8 = __pyx_v_nRes;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_i = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line329")'> 329:         for j in range(i + 1, nRes):</pre>
<pre id='line329' class='code' style='background-color: #FFFFff'>    __pyx_t_10 = __pyx_v_nRes;
    for (__pyx_t_11 = (__pyx_v_i + 1); __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
      __pyx_v_j = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line330")'> 330:             rm = caDist[i, j]</pre>
<pre id='line330' class='code' style='background-color: #FFFFff'>      __pyx_t_12 = __pyx_v_i;
      __pyx_t_13 = __pyx_v_j;
      if (__pyx_t_12 &lt; 0) __pyx_t_12 += __pyx_v_caDist.shape[0];
      if (__pyx_t_13 &lt; 0) __pyx_t_13 += __pyx_v_caDist.shape[1];
      __pyx_v_rm = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_caDist.data + __pyx_t_12 * __pyx_v_caDist.strides[0]) ) + __pyx_t_13 * __pyx_v_caDist.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line331")'> 331:             intE = (17./55. + 1.) * rm  # (2.5 sigma)</pre>
<pre id='line331' class='code' style='background-color: #FFFFff'>      __pyx_v_intE = (((17. / 55.) + 1.) * __pyx_v_rm);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line332")'> 332:             rmMatrix[i, j] = rm</pre>
<pre id='line332' class='code' style='background-color: #FFFFff'>      __pyx_t_14 = __pyx_v_i;
      __pyx_t_15 = __pyx_v_j;
      if (__pyx_t_14 &lt; 0) __pyx_t_14 += __pyx_pybuffernd_rmMatrix.diminfo[0].shape;
      if (__pyx_t_15 &lt; 0) __pyx_t_15 += __pyx_pybuffernd_rmMatrix.diminfo[1].shape;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_rmMatrix.rcbuffer-&gt;pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_rmMatrix.diminfo[0].strides, __pyx_t_15, __pyx_pybuffernd_rmMatrix.diminfo[1].strides) = __pyx_v_rm;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line333")'> 333:             rmMatrix[j, i] = rm</pre>
<pre id='line333' class='code' style='background-color: #FFFFff'>      __pyx_t_16 = __pyx_v_j;
      __pyx_t_17 = __pyx_v_i;
      if (__pyx_t_16 &lt; 0) __pyx_t_16 += __pyx_pybuffernd_rmMatrix.diminfo[0].shape;
      if (__pyx_t_17 &lt; 0) __pyx_t_17 += __pyx_pybuffernd_rmMatrix.diminfo[1].shape;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_rmMatrix.rcbuffer-&gt;pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_rmMatrix.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_rmMatrix.diminfo[1].strides) = __pyx_v_rm;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line334")'> 334:             if caDist[i, j] &lt; cutoff:</pre>
<pre id='line334' class='code' style='background-color: #FFFFff'>      __pyx_t_18 = __pyx_v_i;
      __pyx_t_19 = __pyx_v_j;
      if (__pyx_t_18 &lt; 0) __pyx_t_18 += __pyx_v_caDist.shape[0];
      if (__pyx_t_19 &lt; 0) __pyx_t_19 += __pyx_v_caDist.shape[1];
      __pyx_t_20 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_caDist.data + __pyx_t_18 * __pyx_v_caDist.strides[0]) ) + __pyx_t_19 * __pyx_v_caDist.strides[1]) ))) &lt; __pyx_v_cutoff) != 0);
      if (__pyx_t_20) {
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line335")'> 335:                 eMatrix[i, j] = epsilon / intE</pre>
<pre id='line335' class='code' style='background-color: #FFFFaa'>        if (unlikely(__pyx_v_intE == 0)) {
          #ifdef WITH_THREAD
          PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
          #endif
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          #ifdef WITH_THREAD
          PyGILState_Release(__pyx_gilstate_save);
          #endif
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_22 = __pyx_v_j;
        if (__pyx_t_21 &lt; 0) __pyx_t_21 += __pyx_pybuffernd_eMatrix.diminfo[0].shape;
        if (__pyx_t_22 &lt; 0) __pyx_t_22 += __pyx_pybuffernd_eMatrix.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_eMatrix.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_eMatrix.diminfo[1].strides) = (__pyx_v_epsilon / __pyx_v_intE);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line336")'> 336:                 eMatrix[j, i] = epsilon / intE</pre>
<pre id='line336' class='code' style='background-color: #FFFFaa'>        if (unlikely(__pyx_v_intE == 0)) {
          #ifdef WITH_THREAD
          PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
          #endif
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          #ifdef WITH_THREAD
          PyGILState_Release(__pyx_gilstate_save);
          #endif
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_23 = __pyx_v_j;
        __pyx_t_24 = __pyx_v_i;
        if (__pyx_t_23 &lt; 0) __pyx_t_23 += __pyx_pybuffernd_eMatrix.diminfo[0].shape;
        if (__pyx_t_24 &lt; 0) __pyx_t_24 += __pyx_pybuffernd_eMatrix.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_eMatrix.diminfo[0].strides, __pyx_t_24, __pyx_pybuffernd_eMatrix.diminfo[1].strides) = (__pyx_v_epsilon / __pyx_v_intE);
        goto __pyx_L7;
      }
      /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line337")'> 337:             else:</pre>
<pre id='line337' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line338")'> 338:                 eMatrix[i, j] = nnEFactor * epsilon / intE</pre>
<pre id='line338' class='code' style='background-color: #FFFFaa'>        __pyx_t_25 = (__pyx_v_nnEFactor * __pyx_v_epsilon);
        if (unlikely(__pyx_v_intE == 0)) {
          #ifdef WITH_THREAD
          PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
          #endif
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          #ifdef WITH_THREAD
          PyGILState_Release(__pyx_gilstate_save);
          #endif
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_26 = __pyx_v_i;
        __pyx_t_27 = __pyx_v_j;
        if (__pyx_t_26 &lt; 0) __pyx_t_26 += __pyx_pybuffernd_eMatrix.diminfo[0].shape;
        if (__pyx_t_27 &lt; 0) __pyx_t_27 += __pyx_pybuffernd_eMatrix.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer.buf, __pyx_t_26, __pyx_pybuffernd_eMatrix.diminfo[0].strides, __pyx_t_27, __pyx_pybuffernd_eMatrix.diminfo[1].strides) = (__pyx_t_25 / __pyx_v_intE);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line339")'> 339:                 eMatrix[j, i] = nnEFactor * epsilon / intE</pre>
<pre id='line339' class='code' style='background-color: #FFFFaa'>        __pyx_t_25 = (__pyx_v_nnEFactor * __pyx_v_epsilon);
        if (unlikely(__pyx_v_intE == 0)) {
          #ifdef WITH_THREAD
          PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
          #endif
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          #ifdef WITH_THREAD
          PyGILState_Release(__pyx_gilstate_save);
          #endif
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_28 = __pyx_v_j;
        __pyx_t_29 = __pyx_v_i;
        if (__pyx_t_28 &lt; 0) __pyx_t_28 += __pyx_pybuffernd_eMatrix.diminfo[0].shape;
        if (__pyx_t_29 &lt; 0) __pyx_t_29 += __pyx_pybuffernd_eMatrix.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer.buf, __pyx_t_28, __pyx_pybuffernd_eMatrix.diminfo[0].strides, __pyx_t_29, __pyx_pybuffernd_eMatrix.diminfo[1].strides) = (__pyx_t_25 / __pyx_v_intE);
      }
      __pyx_L7:;
    }
  }
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line340")'> 340:     return eMatrix, rmMatrix</pre>
<pre id='line340' class='code' style='background-color: #FFFF7f'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_eMatrix));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_eMatrix));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_eMatrix));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_rmMatrix));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_rmMatrix));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_rmMatrix));
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line341")'> 341: </pre>
<pre id='line341' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line342")'> 342: @cython.cdivision(True)</pre>
<pre id='line342' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line343")'> 343: @cython.boundscheck(False)</pre>
<pre id='line343' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF1f' onclick='toggleDiv("line344")'> 344: def go(double[:, :] caDist, double[:, :] eMatrix, double[:, :] rmMatrix, int cutoff=1):</pre>
<pre id='line344' class='code' style='background-color: #FFFF1f'>/* Python wrapper */
static PyObject *__pyx_pw_3lib_9structure_9potential_11cPotentials_13go(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3lib_9structure_9potential_11cPotentials_12go[] = "\n    If cutoff is True the LJ-Potential is cutoff and shifted at 2.5 sigma\n\n    :param resLookUp:\n    :param caDist:\n    :param eMatrix:\n    :param rmMatrix:\n    :param cutoff:\n    :return:\n    ";
static PyMethodDef __pyx_mdef_3lib_9structure_9potential_11cPotentials_13go = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("go"), (PyCFunction)__pyx_pw_3lib_9structure_9potential_11cPotentials_13go, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(__pyx_doc_3lib_9structure_9potential_11cPotentials_12go)};
static PyObject *__pyx_pw_3lib_9structure_9potential_11cPotentials_13go(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_caDist = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_eMatrix = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_rmMatrix = { 0, 0, { 0 }, { 0 }, { 0 } };
  CYTHON_UNUSED int __pyx_v_cutoff;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("go (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_caDist,&amp;__pyx_n_s_eMatrix,&amp;__pyx_n_s_rmMatrix,&amp;__pyx_n_s_cutoff,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_caDist)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_eMatrix)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("go", 0, 3, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_rmMatrix)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("go", 0, 3, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_cutoff);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "go") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_caDist = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[0]);<span class='error_goto'> if (unlikely(!__pyx_v_caDist.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_eMatrix = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[1]);<span class='error_goto'> if (unlikely(!__pyx_v_eMatrix.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_rmMatrix = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[2]);<span class='error_goto'> if (unlikely(!__pyx_v_rmMatrix.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    if (values[3]) {
      __pyx_v_cutoff = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_cutoff == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_cutoff = ((int)1);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("go", 0, 3, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.potential.cPotentials.go", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3lib_9structure_9potential_11cPotentials_12go(__pyx_self, __pyx_v_caDist, __pyx_v_eMatrix, __pyx_v_rmMatrix, __pyx_v_cutoff);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3lib_9structure_9potential_11cPotentials_12go(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_caDist, __Pyx_memviewslice __pyx_v_eMatrix, __Pyx_memviewslice __pyx_v_rmMatrix, CYTHON_UNUSED int __pyx_v_cutoff) {
  double __pyx_v_Etemp;
  double __pyx_v_Etot;
  double __pyx_v_r;
  double __pyx_v_sr;
  int __pyx_v_nRes;
  int __pyx_v_i;
  int __pyx_v_j;
  double __pyx_v_epsilon;
  double __pyx_v_rm;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("go", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.potential.cPotentials.go", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_caDist, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_eMatrix, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_rmMatrix, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__30 = <span class='py_c_api'>PyTuple_Pack</span>(16, __pyx_n_s_caDist, __pyx_n_s_eMatrix, __pyx_n_s_rmMatrix, __pyx_n_s_cutoff, __pyx_n_s_Etemp, __pyx_n_s_Etot, __pyx_n_s_Enn, __pyx_n_s_Ena, __pyx_n_s_r, __pyx_n_s_sr, __pyx_n_s_nRes, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_n, __pyx_n_s_epsilon, __pyx_n_s_rm);<span class='error_goto'> if (unlikely(!__pyx_tuple__30)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__30);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__30);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3lib_9structure_9potential_11cPotentials_13go, NULL, __pyx_n_s_lib_structure_potential_cPotenti);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_go, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__31 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 16, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__30, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_thomas_devel_lib_structure, __pyx_n_s_go, 344, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__31)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line345")'> 345:     """</pre>
<pre id='line345' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line346")'> 346:     If cutoff is True the LJ-Potential is cutoff and shifted at 2.5 sigma</pre>
<pre id='line346' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line347")'> 347: </pre>
<pre id='line347' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line348")'> 348:     :param resLookUp:</pre>
<pre id='line348' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line349")'> 349:     :param caDist:</pre>
<pre id='line349' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line350")'> 350:     :param eMatrix:</pre>
<pre id='line350' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line351")'> 351:     :param rmMatrix:</pre>
<pre id='line351' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line352")'> 352:     :param cutoff:</pre>
<pre id='line352' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line353")'> 353:     :return:</pre>
<pre id='line353' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line354")'> 354:     """</pre>
<pre id='line354' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line355")'> 355:     cdef double Etemp, Etot, Enn, Ena, r, sr</pre>
<pre id='line355' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line356")'> 356:     cdef int nRes</pre>
<pre id='line356' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line357")'> 357:     cdef int i, j, n</pre>
<pre id='line357' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line358")'> 358:     cdef double epsilon, rm</pre>
<pre id='line358' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line359")'> 359: </pre>
<pre id='line359' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line360")'> 360:     Etemp = 0.0</pre>
<pre id='line360' class='code' style='background-color: #FFFFff'>  __pyx_v_Etemp = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line361")'> 361:     Etot = 0.0  # total energy</pre>
<pre id='line361' class='code' style='background-color: #FFFFff'>  __pyx_v_Etot = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line362")'> 362:     nRes = caDist.shape[0]</pre>
<pre id='line362' class='code' style='background-color: #FFFFff'>  __pyx_v_nRes = (__pyx_v_caDist.shape[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line363")'> 363:     for i in range(nRes):</pre>
<pre id='line363' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_nRes;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line364")'> 364:         for j in range(i + 1, nRes):</pre>
<pre id='line364' class='code' style='background-color: #FFFFff'>    __pyx_t_3 = __pyx_v_nRes;
    for (__pyx_t_4 = (__pyx_v_i + 1); __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_j = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line365")'> 365:             epsilon = eMatrix[i, j]</pre>
<pre id='line365' class='code' style='background-color: #FFFFff'>      __pyx_t_5 = __pyx_v_i;
      __pyx_t_6 = __pyx_v_j;
      if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_v_eMatrix.shape[0];
      if (__pyx_t_6 &lt; 0) __pyx_t_6 += __pyx_v_eMatrix.shape[1];
      __pyx_v_epsilon = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_eMatrix.data + __pyx_t_5 * __pyx_v_eMatrix.strides[0]) ) + __pyx_t_6 * __pyx_v_eMatrix.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line366")'> 366:             rm = rmMatrix[i, j]</pre>
<pre id='line366' class='code' style='background-color: #FFFFff'>      __pyx_t_7 = __pyx_v_i;
      __pyx_t_8 = __pyx_v_j;
      if (__pyx_t_7 &lt; 0) __pyx_t_7 += __pyx_v_rmMatrix.shape[0];
      if (__pyx_t_8 &lt; 0) __pyx_t_8 += __pyx_v_rmMatrix.shape[1];
      __pyx_v_rm = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rmMatrix.data + __pyx_t_7 * __pyx_v_rmMatrix.strides[0]) ) + __pyx_t_8 * __pyx_v_rmMatrix.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line367")'> 367:             r = caDist[i, j]</pre>
<pre id='line367' class='code' style='background-color: #FFFFff'>      __pyx_t_9 = __pyx_v_i;
      __pyx_t_10 = __pyx_v_j;
      if (__pyx_t_9 &lt; 0) __pyx_t_9 += __pyx_v_caDist.shape[0];
      if (__pyx_t_10 &lt; 0) __pyx_t_10 += __pyx_v_caDist.shape[1];
      __pyx_v_r = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_caDist.data + __pyx_t_9 * __pyx_v_caDist.strides[0]) ) + __pyx_t_10 * __pyx_v_caDist.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line368")'> 368:             if rm &lt; r &lt; rm * 2.5:</pre>
<pre id='line368' class='code' style='background-color: #FFFFff'>      __pyx_t_11 = (__pyx_v_rm &lt; __pyx_v_r);
      if (__pyx_t_11) {
        __pyx_t_11 = (__pyx_v_r &lt; (__pyx_v_rm * 2.5));
      }
      __pyx_t_12 = (__pyx_t_11 != 0);
      if (__pyx_t_12) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line369")'> 369:                 sr = 2*(rm / r) ** 6</pre>
<pre id='line369' class='code' style='background-color: #FFFFff'>        __pyx_v_sr = (2.0 * pow((__pyx_v_rm / __pyx_v_r), 6.0));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line370")'> 370:                 Etemp -= sr</pre>
<pre id='line370' class='code' style='background-color: #FFFFff'>        __pyx_v_Etemp = (__pyx_v_Etemp - __pyx_v_sr);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line371")'> 371:                 Etemp += sr ** 2 / 4.0</pre>
<pre id='line371' class='code' style='background-color: #FFFFff'>        __pyx_v_Etemp = (__pyx_v_Etemp + (pow(__pyx_v_sr, 2.0) / 4.0));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line372")'> 372:                 Etemp *= epsilon</pre>
<pre id='line372' class='code' style='background-color: #FFFFff'>        __pyx_v_Etemp = (__pyx_v_Etemp * __pyx_v_epsilon);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line373")'> 373:                 Etemp += 0.00818 * epsilon</pre>
<pre id='line373' class='code' style='background-color: #FFFFff'>        __pyx_v_Etemp = (__pyx_v_Etemp + (0.00818 * __pyx_v_epsilon));
        goto __pyx_L7;
      }
      /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line374")'> 374:             else:</pre>
<pre id='line374' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line375")'> 375:                 Etemp = - epsilon</pre>
<pre id='line375' class='code' style='background-color: #FFFFff'>        __pyx_v_Etemp = (-__pyx_v_epsilon);
      }
      __pyx_L7:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line376")'> 376:             Etot += Etemp</pre>
<pre id='line376' class='code' style='background-color: #FFFFff'>      __pyx_v_Etot = (__pyx_v_Etot + __pyx_v_Etemp);
    }
  }
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line377")'> 377:     return Etot</pre>
<pre id='line377' class='code' style='background-color: #FFFF9f'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_13 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_Etot);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_r = __pyx_t_13;
  __pyx_t_13 = 0;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line378")'> 378: </pre>
<pre id='line378' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line379")'> 379: </pre>
<pre id='line379' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line380")'> 380: def spherePoints(int nSphere):</pre>
<pre id='line380' class='code' style='background-color: #FFFF46'>/* Python wrapper */
static PyObject *__pyx_pw_3lib_9structure_9potential_11cPotentials_15spherePoints(PyObject *__pyx_self, PyObject *__pyx_arg_nSphere); /*proto*/
static PyMethodDef __pyx_mdef_3lib_9structure_9potential_11cPotentials_15spherePoints = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("spherePoints"), (PyCFunction)__pyx_pw_3lib_9structure_9potential_11cPotentials_15spherePoints, METH_O, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_3lib_9structure_9potential_11cPotentials_15spherePoints(PyObject *__pyx_self, PyObject *__pyx_arg_nSphere) {
  int __pyx_v_nSphere;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("spherePoints (wrapper)", 0);
  assert(__pyx_arg_nSphere); {
    __pyx_v_nSphere = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_arg_nSphere);<span class='error_goto'> if (unlikely((__pyx_v_nSphere == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 380; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.potential.cPotentials.spherePoints", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3lib_9structure_9potential_11cPotentials_14spherePoints(__pyx_self, ((int)__pyx_v_nSphere));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3lib_9structure_9potential_11cPotentials_14spherePoints(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_nSphere) {
  double __pyx_v_offset;
  double __pyx_v_rd;
  double __pyx_v_y;
  double __pyx_v_phi;
  __Pyx_memviewslice __pyx_v_sphere_points = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_inc;
  int32_t __pyx_v_k;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("spherePoints", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.potential.cPotentials.spherePoints", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_sphere_points, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__32 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_nSphere, __pyx_n_s_nSphere, __pyx_n_s_offset, __pyx_n_s_rd, __pyx_n_s_y, __pyx_n_s_phi, __pyx_n_s_sphere_points, __pyx_n_s_inc, __pyx_n_s_k);<span class='error_goto'> if (unlikely(!__pyx_tuple__32)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__32);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__32);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3lib_9structure_9potential_11cPotentials_15spherePoints, NULL, __pyx_n_s_lib_structure_potential_cPotenti);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_spherePoints, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__33 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 9, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__32, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_thomas_devel_lib_structure, __pyx_n_s_spherePoints, 380, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line381")'> 381:     # generate sphere points Returns list of 3d coordinates of points on a sphere using the</pre>
<pre id='line381' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line382")'> 382:     # Golden Section Spiral algorithm.</pre>
<pre id='line382' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line383")'> 383:     cdef double offset, rd, y, phi</pre>
<pre id='line383' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2e' onclick='toggleDiv("line384")'> 384:     cdef double[:, :] sphere_points = np.zeros((nSphere,3), dtype=np.float64)</pre>
<pre id='line384' class='code' style='background-color: #FFFF2e'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nSphere);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_5);
  if (unlikely(!__pyx_t_6.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_sphere_points = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line385")'> 385:     cdef double inc = 3.14159265359 * (3 - sqrt(5))</pre>
<pre id='line385' class='code' style='background-color: #FFFFff'>  __pyx_v_inc = (3.14159265359 * (3.0 - sqrt(5.0)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line386")'> 386:     cdef int32_t k</pre>
<pre id='line386' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line387")'> 387:     offset = 2.0 / (&lt;double&gt; nSphere)</pre>
<pre id='line387' class='code' style='background-color: #FFFFaa'>  if (unlikely(((double)__pyx_v_nSphere) == 0)) {
    #ifdef WITH_THREAD
    PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    #ifdef WITH_THREAD
    PyGILState_Release(__pyx_gilstate_save);
    #endif
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_offset = (2.0 / ((double)__pyx_v_nSphere));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line388")'> 388:     for k in range(nSphere):</pre>
<pre id='line388' class='code' style='background-color: #FFFFff'>  __pyx_t_7 = __pyx_v_nSphere;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_k = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line389")'> 389:         y = k * offset - 1.0 + (offset / 2.0)</pre>
<pre id='line389' class='code' style='background-color: #FFFFff'>    __pyx_v_y = (((__pyx_v_k * __pyx_v_offset) - 1.0) + (__pyx_v_offset / 2.0));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line390")'> 390:         rd = sqrt(1 - y * y)</pre>
<pre id='line390' class='code' style='background-color: #FFFFff'>    __pyx_v_rd = sqrt((1.0 - (__pyx_v_y * __pyx_v_y)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line391")'> 391:         phi = k * inc</pre>
<pre id='line391' class='code' style='background-color: #FFFFff'>    __pyx_v_phi = (__pyx_v_k * __pyx_v_inc);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line392")'> 392:         sphere_points[k, 0] = cos(phi) * rd</pre>
<pre id='line392' class='code' style='background-color: #FFFFd4'>    __pyx_t_9 = __pyx_v_k;
    __pyx_t_10 = 0;
    __pyx_t_11 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_sphere_points.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_sphere_points.shape[0])) __pyx_t_11 = 0;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_sphere_points.shape[1];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 1;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_sphere_points.shape[1])) __pyx_t_11 = 1;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_sphere_points.data + __pyx_t_9 * __pyx_v_sphere_points.strides[0]) ) + __pyx_t_10 * __pyx_v_sphere_points.strides[1]) )) = (cos(__pyx_v_phi) * __pyx_v_rd);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line393")'> 393:         sphere_points[k, 1] = y</pre>
<pre id='line393' class='code' style='background-color: #FFFFd4'>    __pyx_t_12 = __pyx_v_k;
    __pyx_t_13 = 1;
    __pyx_t_11 = -1;
    if (__pyx_t_12 &lt; 0) {
      __pyx_t_12 += __pyx_v_sphere_points.shape[0];
      if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_sphere_points.shape[0])) __pyx_t_11 = 0;
    if (__pyx_t_13 &lt; 0) {
      __pyx_t_13 += __pyx_v_sphere_points.shape[1];
      if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_11 = 1;
    } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_sphere_points.shape[1])) __pyx_t_11 = 1;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_sphere_points.data + __pyx_t_12 * __pyx_v_sphere_points.strides[0]) ) + __pyx_t_13 * __pyx_v_sphere_points.strides[1]) )) = __pyx_v_y;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line394")'> 394:         sphere_points[k, 2] = sin(phi) * rd</pre>
<pre id='line394' class='code' style='background-color: #FFFFd4'>    __pyx_t_14 = __pyx_v_k;
    __pyx_t_15 = 2;
    __pyx_t_11 = -1;
    if (__pyx_t_14 &lt; 0) {
      __pyx_t_14 += __pyx_v_sphere_points.shape[0];
      if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_sphere_points.shape[0])) __pyx_t_11 = 0;
    if (__pyx_t_15 &lt; 0) {
      __pyx_t_15 += __pyx_v_sphere_points.shape[1];
      if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_11 = 1;
    } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_sphere_points.shape[1])) __pyx_t_11 = 1;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_sphere_points.data + __pyx_t_14 * __pyx_v_sphere_points.strides[0]) ) + __pyx_t_15 * __pyx_v_sphere_points.strides[1]) )) = (sin(__pyx_v_phi) * __pyx_v_rd);
  }
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line395")'> 395:     return sphere_points</pre>
<pre id='line395' class='code' style='background-color: #FFFFe7'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_sphere_points, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line396")'> 396: </pre>
<pre id='line396' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line397")'> 397: </pre>
<pre id='line397' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line398")'> 398: </pre>
<pre id='line398' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line399")'> 399: @cython.cdivision(True)</pre>
<pre id='line399' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line400")'> 400: @cython.boundscheck(False)</pre>
<pre id='line400' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF15' onclick='toggleDiv("line401")'> 401: def asa(double[:, :] xyz, int[:, :] resLookUp, double[:, :] caDist, double[:, :] sphere_points,</pre>
<pre id='line401' class='code' style='background-color: #FFFF15'>/* Python wrapper */
static PyObject *__pyx_pw_3lib_9structure_9potential_11cPotentials_17asa(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3lib_9structure_9potential_11cPotentials_16asa[] = "\n    Returns list of accessible surface areas of the atoms, using the probe\n    and atom radius to define the surface.\n\n    Routines to calculate the Accessible Surface Area of a set of atoms.\n    The algorithm is adapted from the Rose lab's chasa.py, which uses\n\n    :param xyz:\n    :param resLookUp:\n    :param caDist:\n    :param sphere_points:\n    :param probe:\n    :param radius:\n    :param sum:\n    the dot density technique found in:\n\n    Shrake, A., and J. A. Rupley. \"Environment and Exposure to Solvent\n    of Protein Atoms. Lysozyme and Insulin.\" JMB (1973) 79:351-371.\n    ";
static PyMethodDef __pyx_mdef_3lib_9structure_9potential_11cPotentials_17asa = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("asa"), (PyCFunction)__pyx_pw_3lib_9structure_9potential_11cPotentials_17asa, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(__pyx_doc_3lib_9structure_9potential_11cPotentials_16asa)};
static PyObject *__pyx_pw_3lib_9structure_9potential_11cPotentials_17asa(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_xyz = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_resLookUp = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_caDist = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_sphere_points = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_probe;
  double __pyx_v_radius;
  CYTHON_UNUSED char __pyx_v_sum;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("asa (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_xyz,&amp;__pyx_n_s_resLookUp,&amp;__pyx_n_s_caDist,&amp;__pyx_n_s_sphere_points,&amp;__pyx_n_s_probe,&amp;__pyx_n_s_radius,&amp;__pyx_n_s_sum,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_xyz)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_resLookUp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("asa", 0, 4, 7, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_caDist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("asa", 0, 4, 7, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sphere_points)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("asa", 0, 4, 7, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_probe);
          if (value) { values[4] = value; kw_args--; }
        }
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_radius);
          if (value) { values[5] = value; kw_args--; }
        }
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sum);
          if (value) { values[6] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "asa") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_xyz = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[0]);<span class='error_goto'> if (unlikely(!__pyx_v_xyz.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_resLookUp = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[1]);<span class='error_goto'> if (unlikely(!__pyx_v_resLookUp.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_caDist = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[2]);<span class='error_goto'> if (unlikely(!__pyx_v_caDist.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_sphere_points = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[3]);<span class='error_goto'> if (unlikely(!__pyx_v_sphere_points.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    if (values[4]) {
      __pyx_v_probe = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_probe == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_probe = ((double)1.0);
    }
    if (values[5]) {
      __pyx_v_radius = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]);<span class='error_goto'> if (unlikely((__pyx_v_radius == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_radius = ((double)2.5);
    }
    if (values[6]) {
      __pyx_v_sum = <span class='pyx_c_api'>__Pyx_PyInt_As_char</span>(values[6]);<span class='error_goto'> if (unlikely((__pyx_v_sum == (char)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_sum = ((char)1);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("asa", 0, 4, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.potential.cPotentials.asa", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3lib_9structure_9potential_11cPotentials_16asa(__pyx_self, __pyx_v_xyz, __pyx_v_resLookUp, __pyx_v_caDist, __pyx_v_sphere_points, __pyx_v_probe, __pyx_v_radius, __pyx_v_sum);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3lib_9structure_9potential_11cPotentials_16asa(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_xyz, __Pyx_memviewslice __pyx_v_resLookUp, __Pyx_memviewslice __pyx_v_caDist, __Pyx_memviewslice __pyx_v_sphere_points, double __pyx_v_probe, double __pyx_v_radius, CYTHON_UNUSED char __pyx_v_sum) {
  char __pyx_v_is_accessible;
  int32_t __pyx_v_n_accessible_point;
  int32_t __pyx_v_n_neighbor;
  int32_t __pyx_v_i;
  int32_t __pyx_v_j;
  int32_t __pyx_v_k;
  int32_t __pyx_v_nSphere;
  int32_t __pyx_v_nCi;
  int32_t __pyx_v_nRes;
  double __pyx_v_area;
  double __pyx_v_aX;
  double __pyx_v_aY;
  double __pyx_v_aZ;
  double __pyx_v_bX;
  double __pyx_v_bY;
  double __pyx_v_bZ;
  int *__pyx_v_neighbor_indices;
  double __pyx_v_c;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("asa", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_32);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.potential.cPotentials.asa", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xyz, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_resLookUp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_caDist, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_sphere_points, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__34 = <span class='py_c_api'>PyTuple_Pack</span>(25, __pyx_n_s_xyz, __pyx_n_s_resLookUp, __pyx_n_s_caDist, __pyx_n_s_sphere_points, __pyx_n_s_probe, __pyx_n_s_radius, __pyx_n_s_sum, __pyx_n_s_is_accessible, __pyx_n_s_n_accessible_point, __pyx_n_s_n_neighbor, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_nSphere, __pyx_n_s_nCi, __pyx_n_s_nRes, __pyx_n_s_area, __pyx_n_s_aX, __pyx_n_s_aY, __pyx_n_s_aZ, __pyx_n_s_bX, __pyx_n_s_bY, __pyx_n_s_bZ, __pyx_n_s_neighbor_indices, __pyx_n_s_c);<span class='error_goto'> if (unlikely(!__pyx_tuple__34)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__34);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__34);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3lib_9structure_9potential_11cPotentials_17asa, NULL, __pyx_n_s_lib_structure_potential_cPotenti);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_asa, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__35 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 25, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__34, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_thomas_devel_lib_structure, __pyx_n_s_asa, 401, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__35)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line402")'> 402:         double probe=1.0, double radius = 2.5, char sum=1):</pre>
<pre id='line402' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line403")'> 403:     """</pre>
<pre id='line403' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line404")'> 404:     Returns list of accessible surface areas of the atoms, using the probe</pre>
<pre id='line404' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line405")'> 405:     and atom radius to define the surface.</pre>
<pre id='line405' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line406")'> 406: </pre>
<pre id='line406' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line407")'> 407:     Routines to calculate the Accessible Surface Area of a set of atoms.</pre>
<pre id='line407' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line408")'> 408:     The algorithm is adapted from the Rose lab's chasa.py, which uses</pre>
<pre id='line408' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line409")'> 409: </pre>
<pre id='line409' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line410")'> 410:     :param xyz:</pre>
<pre id='line410' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line411")'> 411:     :param resLookUp:</pre>
<pre id='line411' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line412")'> 412:     :param caDist:</pre>
<pre id='line412' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line413")'> 413:     :param sphere_points:</pre>
<pre id='line413' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line414")'> 414:     :param probe:</pre>
<pre id='line414' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line415")'> 415:     :param radius:</pre>
<pre id='line415' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line416")'> 416:     :param sum:</pre>
<pre id='line416' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line417")'> 417:     the dot density technique found in:</pre>
<pre id='line417' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line418")'> 418: </pre>
<pre id='line418' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line419")'> 419:     Shrake, A., and J. A. Rupley. "Environment and Exposure to Solvent</pre>
<pre id='line419' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line420")'> 420:     of Protein Atoms. Lysozyme and Insulin." JMB (1973) 79:351-371.</pre>
<pre id='line420' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line421")'> 421:     """</pre>
<pre id='line421' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line422")'> 422:     cdef char is_accessible</pre>
<pre id='line422' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line423")'> 423:     cdef int32_t n_accessible_point, n_neighbor</pre>
<pre id='line423' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line424")'> 424:     cdef int32_t i, j, k, nSphere, nCi, nRes</pre>
<pre id='line424' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line425")'> 425: </pre>
<pre id='line425' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line426")'> 426:     cdef double area</pre>
<pre id='line426' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line427")'> 427:     cdef double aX, aY, aZ, bX, bY, bZ</pre>
<pre id='line427' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line428")'> 428: </pre>
<pre id='line428' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line429")'> 429:     nSphere = sphere_points.shape[0]</pre>
<pre id='line429' class='code' style='background-color: #FFFFff'>  __pyx_v_nSphere = (__pyx_v_sphere_points.shape[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line430")'> 430:     nRes = caDist.shape[0]</pre>
<pre id='line430' class='code' style='background-color: #FFFFff'>  __pyx_v_nRes = (__pyx_v_caDist.shape[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line431")'> 431: </pre>
<pre id='line431' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line432")'> 432:     cdef int* neighbor_indices = &lt;int*&gt; malloc(sizeof(int) * nRes)</pre>
<pre id='line432' class='code' style='background-color: #FFFFff'>  __pyx_v_neighbor_indices = ((int *)malloc(((sizeof(int)) * __pyx_v_nRes)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line433")'> 433: </pre>
<pre id='line433' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line434")'> 434:     # calcuate asa</pre>
<pre id='line434' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line435")'> 435:     area = 0.0</pre>
<pre id='line435' class='code' style='background-color: #FFFFff'>  __pyx_v_area = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line436")'> 436:     cdef double c = 4.0 * 3.14159265359 / (&lt;double&gt; nSphere)</pre>
<pre id='line436' class='code' style='background-color: #FFFFff'>  __pyx_v_c = ((4.0 * 3.14159265359) / ((double)__pyx_v_nSphere));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line437")'> 437:     for i in range(nRes):</pre>
<pre id='line437' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_nRes;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line438")'> 438:         nCi = resLookUp[i, 3 + 3]</pre>
<pre id='line438' class='code' style='background-color: #FFFFff'>    __pyx_t_3 = __pyx_v_i;
    __pyx_t_4 = 6;
    if (__pyx_t_3 &lt; 0) __pyx_t_3 += __pyx_v_resLookUp.shape[0];
    if (__pyx_t_4 &lt; 0) __pyx_t_4 += __pyx_v_resLookUp.shape[1];
    __pyx_v_nCi = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_3 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_4 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line439")'> 439:         # find neighbors!</pre>
<pre id='line439' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line440")'> 440:         n_neighbor = 0</pre>
<pre id='line440' class='code' style='background-color: #FFFFff'>    __pyx_v_n_neighbor = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line441")'> 441:         for j in range(nRes):</pre>
<pre id='line441' class='code' style='background-color: #FFFFff'>    __pyx_t_5 = __pyx_v_nRes;
    for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_j = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line442")'> 442:             if i != j:</pre>
<pre id='line442' class='code' style='background-color: #FFFFff'>      __pyx_t_7 = ((__pyx_v_i != __pyx_v_j) != 0);
      if (__pyx_t_7) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line443")'> 443:                 if caDist[i, j] &lt; 2 * (radius + probe):</pre>
<pre id='line443' class='code' style='background-color: #FFFFff'>        __pyx_t_8 = __pyx_v_i;
        __pyx_t_9 = __pyx_v_j;
        if (__pyx_t_8 &lt; 0) __pyx_t_8 += __pyx_v_caDist.shape[0];
        if (__pyx_t_9 &lt; 0) __pyx_t_9 += __pyx_v_caDist.shape[1];
        __pyx_t_7 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_caDist.data + __pyx_t_8 * __pyx_v_caDist.strides[0]) ) + __pyx_t_9 * __pyx_v_caDist.strides[1]) ))) &lt; (2.0 * (__pyx_v_radius + __pyx_v_probe))) != 0);
        if (__pyx_t_7) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line444")'> 444:                     neighbor_indices[n_neighbor] = resLookUp[j, 3 + 3]</pre>
<pre id='line444' class='code' style='background-color: #FFFFff'>          __pyx_t_10 = __pyx_v_j;
          __pyx_t_11 = 6;
          if (__pyx_t_10 &lt; 0) __pyx_t_10 += __pyx_v_resLookUp.shape[0];
          if (__pyx_t_11 &lt; 0) __pyx_t_11 += __pyx_v_resLookUp.shape[1];
          (__pyx_v_neighbor_indices[__pyx_v_n_neighbor]) = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_10 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_11 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line445")'> 445:                     n_neighbor += 1</pre>
<pre id='line445' class='code' style='background-color: #FFFFff'>          __pyx_v_n_neighbor = (__pyx_v_n_neighbor + 1);
          goto __pyx_L8;
        }
        __pyx_L8:;
        goto __pyx_L7;
      }
      __pyx_L7:;
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line446")'> 446:         # accessible?</pre>
<pre id='line446' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line447")'> 447:         n_accessible_point = 0</pre>
<pre id='line447' class='code' style='background-color: #FFFFff'>    __pyx_v_n_accessible_point = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line448")'> 448:         for j in range(nSphere):</pre>
<pre id='line448' class='code' style='background-color: #FFFFff'>    __pyx_t_5 = __pyx_v_nSphere;
    for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_j = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line449")'> 449:             is_accessible = 1</pre>
<pre id='line449' class='code' style='background-color: #FFFFff'>      __pyx_v_is_accessible = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line450")'> 450:             aX = sphere_points[j, 0] * radius + xyz[nCi, 0]</pre>
<pre id='line450' class='code' style='background-color: #FFFFff'>      __pyx_t_12 = __pyx_v_j;
      __pyx_t_13 = 0;
      if (__pyx_t_12 &lt; 0) __pyx_t_12 += __pyx_v_sphere_points.shape[0];
      if (__pyx_t_13 &lt; 0) __pyx_t_13 += __pyx_v_sphere_points.shape[1];
      __pyx_t_14 = __pyx_v_nCi;
      __pyx_t_15 = 0;
      if (__pyx_t_14 &lt; 0) __pyx_t_14 += __pyx_v_xyz.shape[0];
      if (__pyx_t_15 &lt; 0) __pyx_t_15 += __pyx_v_xyz.shape[1];
      __pyx_v_aX = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_sphere_points.data + __pyx_t_12 * __pyx_v_sphere_points.strides[0]) ) + __pyx_t_13 * __pyx_v_sphere_points.strides[1]) ))) * __pyx_v_radius) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_14 * __pyx_v_xyz.strides[0]) ) + __pyx_t_15 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line451")'> 451:             aY = sphere_points[j, 1] * radius + xyz[nCi, 1]</pre>
<pre id='line451' class='code' style='background-color: #FFFFff'>      __pyx_t_16 = __pyx_v_j;
      __pyx_t_17 = 1;
      if (__pyx_t_16 &lt; 0) __pyx_t_16 += __pyx_v_sphere_points.shape[0];
      if (__pyx_t_17 &lt; 0) __pyx_t_17 += __pyx_v_sphere_points.shape[1];
      __pyx_t_18 = __pyx_v_nCi;
      __pyx_t_19 = 1;
      if (__pyx_t_18 &lt; 0) __pyx_t_18 += __pyx_v_xyz.shape[0];
      if (__pyx_t_19 &lt; 0) __pyx_t_19 += __pyx_v_xyz.shape[1];
      __pyx_v_aY = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_sphere_points.data + __pyx_t_16 * __pyx_v_sphere_points.strides[0]) ) + __pyx_t_17 * __pyx_v_sphere_points.strides[1]) ))) * __pyx_v_radius) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_18 * __pyx_v_xyz.strides[0]) ) + __pyx_t_19 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line452")'> 452:             aZ = sphere_points[j, 2] * radius + xyz[nCi, 2]</pre>
<pre id='line452' class='code' style='background-color: #FFFFff'>      __pyx_t_20 = __pyx_v_j;
      __pyx_t_21 = 2;
      if (__pyx_t_20 &lt; 0) __pyx_t_20 += __pyx_v_sphere_points.shape[0];
      if (__pyx_t_21 &lt; 0) __pyx_t_21 += __pyx_v_sphere_points.shape[1];
      __pyx_t_22 = __pyx_v_nCi;
      __pyx_t_23 = 2;
      if (__pyx_t_22 &lt; 0) __pyx_t_22 += __pyx_v_xyz.shape[0];
      if (__pyx_t_23 &lt; 0) __pyx_t_23 += __pyx_v_xyz.shape[1];
      __pyx_v_aZ = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_sphere_points.data + __pyx_t_20 * __pyx_v_sphere_points.strides[0]) ) + __pyx_t_21 * __pyx_v_sphere_points.strides[1]) ))) * __pyx_v_radius) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_22 * __pyx_v_xyz.strides[0]) ) + __pyx_t_23 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line453")'> 453:             for k in range(n_neighbor):</pre>
<pre id='line453' class='code' style='background-color: #FFFFff'>      __pyx_t_24 = __pyx_v_n_neighbor;
      for (__pyx_t_25 = 0; __pyx_t_25 &lt; __pyx_t_24; __pyx_t_25+=1) {
        __pyx_v_k = __pyx_t_25;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line454")'> 454:                 bX = xyz[neighbor_indices[k], 0]</pre>
<pre id='line454' class='code' style='background-color: #FFFFff'>        __pyx_t_26 = (__pyx_v_neighbor_indices[__pyx_v_k]);
        __pyx_t_27 = 0;
        if (__pyx_t_26 &lt; 0) __pyx_t_26 += __pyx_v_xyz.shape[0];
        if (__pyx_t_27 &lt; 0) __pyx_t_27 += __pyx_v_xyz.shape[1];
        __pyx_v_bX = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_26 * __pyx_v_xyz.strides[0]) ) + __pyx_t_27 * __pyx_v_xyz.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line455")'> 455:                 bY = xyz[neighbor_indices[k], 1]</pre>
<pre id='line455' class='code' style='background-color: #FFFFff'>        __pyx_t_28 = (__pyx_v_neighbor_indices[__pyx_v_k]);
        __pyx_t_29 = 1;
        if (__pyx_t_28 &lt; 0) __pyx_t_28 += __pyx_v_xyz.shape[0];
        if (__pyx_t_29 &lt; 0) __pyx_t_29 += __pyx_v_xyz.shape[1];
        __pyx_v_bY = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_28 * __pyx_v_xyz.strides[0]) ) + __pyx_t_29 * __pyx_v_xyz.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line456")'> 456:                 bZ = xyz[neighbor_indices[k], 2]</pre>
<pre id='line456' class='code' style='background-color: #FFFFff'>        __pyx_t_30 = (__pyx_v_neighbor_indices[__pyx_v_k]);
        __pyx_t_31 = 2;
        if (__pyx_t_30 &lt; 0) __pyx_t_30 += __pyx_v_xyz.shape[0];
        if (__pyx_t_31 &lt; 0) __pyx_t_31 += __pyx_v_xyz.shape[1];
        __pyx_v_bZ = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_30 * __pyx_v_xyz.strides[0]) ) + __pyx_t_31 * __pyx_v_xyz.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line457")'> 457:                 if dist3c2(aX, aY, aZ, bX, bY, bZ) &lt; (radius + probe) * (radius + probe):</pre>
<pre id='line457' class='code' style='background-color: #FFFFff'>        __pyx_t_7 = ((__pyx_f_3lib_9structure_9potential_11cPotentials_dist3c2(__pyx_v_aX, __pyx_v_aY, __pyx_v_aZ, __pyx_v_bX, __pyx_v_bY, __pyx_v_bZ) &lt; ((__pyx_v_radius + __pyx_v_probe) * (__pyx_v_radius + __pyx_v_probe))) != 0);
        if (__pyx_t_7) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line458")'> 458:                     is_accessible = 0</pre>
<pre id='line458' class='code' style='background-color: #FFFFff'>          __pyx_v_is_accessible = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line459")'> 459:                     break</pre>
<pre id='line459' class='code' style='background-color: #FFFFff'>          goto __pyx_L12_break;
        }
      }
      __pyx_L12_break:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line460")'> 460:             if is_accessible &gt; 0:</pre>
<pre id='line460' class='code' style='background-color: #FFFFff'>      __pyx_t_7 = ((__pyx_v_is_accessible &gt; 0) != 0);
      if (__pyx_t_7) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line461")'> 461:                 n_accessible_point += 1</pre>
<pre id='line461' class='code' style='background-color: #FFFFff'>        __pyx_v_n_accessible_point = (__pyx_v_n_accessible_point + 1);
        goto __pyx_L14;
      }
      __pyx_L14:;
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line462")'> 462:         area += c * n_accessible_point * radius ** 2</pre>
<pre id='line462' class='code' style='background-color: #FFFFff'>    __pyx_v_area = (__pyx_v_area + ((__pyx_v_c * __pyx_v_n_accessible_point) * pow(__pyx_v_radius, 2.0)));
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line463")'> 463:     free(neighbor_indices)</pre>
<pre id='line463' class='code' style='background-color: #FFFFff'>  free(__pyx_v_neighbor_indices);
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line464")'> 464:     return area</pre>
<pre id='line464' class='code' style='background-color: #FFFF9f'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_32 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_area);<span class='error_goto'> if (unlikely(!__pyx_t_32)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_32);
  __pyx_r = __pyx_t_32;
  __pyx_t_32 = 0;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line465")'> 465: </pre>
<pre id='line465' class='code' style='background-color: #FFFFff'></pre></body></html>
