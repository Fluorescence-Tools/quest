<!DOCTYPE html>
<!-- Generated by Cython 0.20 on Tue Aug 19 23:01:16 2014 -->
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">

body { font-family: courier; font-size: 12; }

.code  { font-size: 9; color: #444444; display: none; margin-left: 20px; }
.py_c_api  { color: red; }
.py_macro_api  { color: #FF7000; }
.pyx_c_api  { color: #FF3000; }
.pyx_macro_api  { color: #FF7000; }
.refnanny  { color: #FFA000; }

.error_goto  { color: #FFA000; }

.tag  {  }

.coerce  { color: #008000; border: 1px dotted #008000 }

.py_attr { color: #FF0000; font-weight: bold; }
.c_attr  { color: #0000FF; }

.py_call { color: #FF0000; font-weight: bold; }
.c_call  { color: #0000FF; }

.line { margin: 0em }

</style>
<script>
function toggleDiv(id) {
    theDiv = document.getElementById(id);
    if (theDiv.style.display != 'block') theDiv.style.display = 'block';
    else theDiv.style.display = 'none';
}
</script>
</head>
        <body>
<p>Generated by Cython 0.20 on Tue Aug 19 23:01:16 2014
<p>Raw output: <a href="cStructure.c">cStructure.c</a>
<pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line1")'> 1: import numpy as np</pre>
<pre id='line1' class='code' style='background-color: #FFFF4b'>
  /* "lib\structure\cStructure.pyx":1
 * import numpy as np             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * cimport numpy as np
 * cimport cython
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;

  /* "lib\structure\cStructure.pyx":1
 * import numpy as np             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * cimport numpy as np
 * cimport cython
 */
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_kp_u_rotate_line_211, __pyx_kp_u_Rotates_a_trajectory_frame_atom) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2")'> 2: cimport numpy as np</pre>
<pre id='line2' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line3")'> 3: cimport cython</pre>
<pre id='line3' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line4")'> 4: from cython.parallel import parallel, prange</pre>
<pre id='line4' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line5")'> 5: from libc.stdlib cimport malloc, free</pre>
<pre id='line5' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line6")'> 6: from libc.math cimport sin, cos, sqrt, fabs</pre>
<pre id='line6' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line7")'> 7: </pre>
<pre id='line7' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line8")'> 8: </pre>
<pre id='line8' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line9")'> 9: @cython.wraparound(False)</pre>
<pre id='line9' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line10")'> 10: @cython.boundscheck(False)</pre>
<pre id='line10' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line11")'> 11: @cython.cdivision(True)</pre>
<pre id='line11' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF16' onclick='toggleDiv("line12")'> 12: def calcalute_kappa2_distance(float[:,:,:] xyz, int aid1, int aid2, int aia1, int aia2):</pre>
<pre id='line12' class='code' style='background-color: #FFFF16'>
/* "lib\structure\cStructure.pyx":12
 * @cython.boundscheck(False)
 * @cython.cdivision(True)
 * def calcalute_kappa2_distance(float[:,:,:] xyz, int aid1, int aid2, int aia1, int aia2):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     cdef int n_frames, i_frame
 *     # coordinates of the dipole
 */

/* Python wrapper */
static PyObject *__pyx_pw_3lib_9structure_10cStructure_1calcalute_kappa2_distance(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_3lib_9structure_10cStructure_1calcalute_kappa2_distance = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("calcalute_kappa2_distance"), (PyCFunction)__pyx_pw_3lib_9structure_10cStructure_1calcalute_kappa2_distance, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_3lib_9structure_10cStructure_1calcalute_kappa2_distance(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_xyz = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_aid1;
  int __pyx_v_aid2;
  int __pyx_v_aia1;
  int __pyx_v_aia2;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calcalute_kappa2_distance (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_xyz,&amp;__pyx_n_s_aid1,&amp;__pyx_n_s_aid2,&amp;__pyx_n_s_aia1,&amp;__pyx_n_s_aia2,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_xyz)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_aid1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calcalute_kappa2_distance", 1, 5, 5, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_aid2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calcalute_kappa2_distance", 1, 5, 5, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_aia1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calcalute_kappa2_distance", 1, 5, 5, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_aia2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calcalute_kappa2_distance", 1, 5, 5, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calcalute_kappa2_distance") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_xyz = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(values[0]);<span class='error_goto'> if (unlikely(!__pyx_v_xyz.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_aid1 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_aid1 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_aid2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_aid2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_aia1 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_aia1 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_aia2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_aia2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calcalute_kappa2_distance", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.cStructure.calcalute_kappa2_distance", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3lib_9structure_10cStructure_calcalute_kappa2_distance(__pyx_self, __pyx_v_xyz, __pyx_v_aid1, __pyx_v_aid2, __pyx_v_aia1, __pyx_v_aia2);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3lib_9structure_10cStructure_calcalute_kappa2_distance(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_xyz, int __pyx_v_aid1, int __pyx_v_aid2, int __pyx_v_aia1, int __pyx_v_aia2) {
  int __pyx_v_n_frames;
  int __pyx_v_i_frame;
  float __pyx_v_d11;
  float __pyx_v_d12;
  float __pyx_v_d13;
  float __pyx_v_d21;
  float __pyx_v_d22;
  float __pyx_v_d23;
  float __pyx_v_a11;
  float __pyx_v_a12;
  float __pyx_v_a13;
  float __pyx_v_a21;
  float __pyx_v_a22;
  float __pyx_v_a23;
  float __pyx_v_dD21;
  float __pyx_v_dA21;
  float __pyx_v_muD1;
  float __pyx_v_muD2;
  float __pyx_v_muD3;
  float __pyx_v_muA1;
  float __pyx_v_muA2;
  float __pyx_v_muA3;
  float __pyx_v_RDA1;
  float __pyx_v_RDA2;
  float __pyx_v_RDA3;
  float __pyx_v_dM1;
  float __pyx_v_dM2;
  float __pyx_v_dM3;
  float __pyx_v_aM1;
  float __pyx_v_aM2;
  float __pyx_v_aM3;
  float __pyx_v_nRDA1;
  float __pyx_v_nRDA2;
  float __pyx_v_nRDA3;
  float __pyx_v_kappa;
  float __pyx_v_kappa2;
  PyArrayObject *__pyx_v_k2 = 0;
  PyArrayObject *__pyx_v_d = 0;
  double __pyx_v_dRDA;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_d;
  __Pyx_Buffer __pyx_pybuffer_d;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_k2;
  __Pyx_Buffer __pyx_pybuffer_k2;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calcalute_kappa2_distance", 0);
  __pyx_pybuffer_k2.pybuffer.buf = NULL;
  __pyx_pybuffer_k2.refcount = 0;
  __pyx_pybuffernd_k2.data = NULL;
  __pyx_pybuffernd_k2.rcbuffer = &amp;__pyx_pybuffer_k2;
  __pyx_pybuffer_d.pybuffer.buf = NULL;
  __pyx_pybuffer_d.refcount = 0;
  __pyx_pybuffernd_d.data = NULL;
  __pyx_pybuffernd_d.rcbuffer = &amp;__pyx_pybuffer_d;

  /* "lib\structure\cStructure.pyx":12
 * @cython.boundscheck(False)
 * @cython.cdivision(True)
 * def calcalute_kappa2_distance(float[:,:,:] xyz, int aid1, int aid2, int aia1, int aia2):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     cdef int n_frames, i_frame
 *     # coordinates of the dipole
 */

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_d.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_k2.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.cStructure.calcalute_kappa2_distance", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_d.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_k2.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_k2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_d);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xyz, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

  /* "lib\structure\cStructure.pyx":12
 * @cython.boundscheck(False)
 * @cython.cdivision(True)
 * def calcalute_kappa2_distance(float[:,:,:] xyz, int aid1, int aid2, int aia1, int aia2):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     cdef int n_frames, i_frame
 *     # coordinates of the dipole
 */
  __pyx_tuple__21 = <span class='py_c_api'>PyTuple_Pack</span>(44, __pyx_n_s_xyz, __pyx_n_s_aid1, __pyx_n_s_aid2, __pyx_n_s_aia1, __pyx_n_s_aia2, __pyx_n_s_n_frames, __pyx_n_s_i_frame, __pyx_n_s_d11, __pyx_n_s_d12, __pyx_n_s_d13, __pyx_n_s_d21, __pyx_n_s_d22, __pyx_n_s_d23, __pyx_n_s_a11, __pyx_n_s_a12, __pyx_n_s_a13, __pyx_n_s_a21, __pyx_n_s_a22, __pyx_n_s_a23, __pyx_n_s_dD21, __pyx_n_s_dA21, __pyx_n_s_muD1, __pyx_n_s_muD2, __pyx_n_s_muD3, __pyx_n_s_muA1, __pyx_n_s_muA2, __pyx_n_s_muA3, __pyx_n_s_RDA1, __pyx_n_s_RDA2, __pyx_n_s_RDA3, __pyx_n_s_dM1, __pyx_n_s_dM2, __pyx_n_s_dM3, __pyx_n_s_aM1, __pyx_n_s_aM2, __pyx_n_s_aM3, __pyx_n_s_nRDA1, __pyx_n_s_nRDA2, __pyx_n_s_nRDA3, __pyx_n_s_kappa, __pyx_n_s_kappa2, __pyx_n_s_k2, __pyx_n_s_d, __pyx_n_s_dRDA);<span class='error_goto'> if (unlikely(!__pyx_tuple__21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__21);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__21);

  /* "lib\structure\cStructure.pyx":12
 * @cython.boundscheck(False)
 * @cython.cdivision(True)
 * def calcalute_kappa2_distance(float[:,:,:] xyz, int aid1, int aid2, int aia1, int aia2):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     cdef int n_frames, i_frame
 *     # coordinates of the dipole
 */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3lib_9structure_10cStructure_1calcalute_kappa2_distance, NULL, __pyx_n_s_lib_structure_cStructure);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_calcalute_kappa2_distance, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__22 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 44, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__21, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_F_devel_lib_structure_cStructure, __pyx_n_s_calcalute_kappa2_distance, 12, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line13")'> 13:     cdef int n_frames, i_frame</pre>
<pre id='line13' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line14")'> 14:     # coordinates of the dipole</pre>
<pre id='line14' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line15")'> 15:     cdef float d11, d12, d13, d21, d22, d23</pre>
<pre id='line15' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line16")'> 16:     cdef float a11, a12, a13, a21, a22, a23</pre>
<pre id='line16' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line17")'> 17:     # length of the dipole</pre>
<pre id='line17' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line18")'> 18:     cdef float dD21, dA21</pre>
<pre id='line18' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line19")'> 19:     # normal vector of the dipoles</pre>
<pre id='line19' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line20")'> 20:     cdef float muD1, muD2, muD3</pre>
<pre id='line20' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line21")'> 21:     cdef float muA1, muA2, muA3</pre>
<pre id='line21' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line22")'> 22:     # connection vector of the dipole</pre>
<pre id='line22' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line23")'> 23:     cdef float RDA1, RDA2, RDA3</pre>
<pre id='line23' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line24")'> 24:     # vector to the middle of the dipoles</pre>
<pre id='line24' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line25")'> 25:     cdef float dM1, dM2, dM3</pre>
<pre id='line25' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line26")'> 26:     cdef float aM1, aM2, aM3</pre>
<pre id='line26' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line27")'> 27:     # normalized DA-connection vector</pre>
<pre id='line27' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line28")'> 28:     cdef float nRDA1, nRDA2, nRDA3</pre>
<pre id='line28' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line29")'> 29:     cdef float kappa, kappa2</pre>
<pre id='line29' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line30")'> 30: </pre>
<pre id='line30' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line31")'> 31:     n_frames = xyz.shape[0]</pre>
<pre id='line31' class='code' style='background-color: #FFFFff'>
  /* "lib\structure\cStructure.pyx":31
 *     cdef float kappa, kappa2
 * 
 *     n_frames = xyz.shape[0]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     cdef np.ndarray[ndim=1, dtype=np.float32_t] k2 = np.empty(n_frames, dtype=np.float32)
 *     cdef np.ndarray[ndim=1, dtype=np.float32_t] d = np.empty(n_frames, dtype=np.float32)
 */
  __pyx_v_n_frames = (__pyx_v_xyz.shape[0]);
</pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line32")'> 32:     cdef np.ndarray[ndim=1, dtype=np.float32_t] k2 = np.empty(n_frames, dtype=np.float32)</pre>
<pre id='line32' class='code' style='background-color: #FFFF31'>
  /* "lib\structure\cStructure.pyx":32
 * 
 *     n_frames = xyz.shape[0]
 *     cdef np.ndarray[ndim=1, dtype=np.float32_t] k2 = np.empty(n_frames, dtype=np.float32)             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     cdef np.ndarray[ndim=1, dtype=np.float32_t] d = np.empty(n_frames, dtype=np.float32)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_frames);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_k2.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_k2 = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_k2.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_k2.diminfo[0].strides = __pyx_pybuffernd_k2.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_k2.diminfo[0].shape = __pyx_pybuffernd_k2.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_6 = 0;
  __pyx_v_k2 = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line33")'> 33:     cdef np.ndarray[ndim=1, dtype=np.float32_t] d = np.empty(n_frames, dtype=np.float32)</pre>
<pre id='line33' class='code' style='background-color: #FFFF31'>
  /* "lib\structure\cStructure.pyx":33
 *     n_frames = xyz.shape[0]
 *     cdef np.ndarray[ndim=1, dtype=np.float32_t] k2 = np.empty(n_frames, dtype=np.float32)
 *     cdef np.ndarray[ndim=1, dtype=np.float32_t] d = np.empty(n_frames, dtype=np.float32)             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *     for i_frame in range(n_frames):
 */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_frames);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_d.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_d = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_d.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_d.diminfo[0].strides = __pyx_pybuffernd_d.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_d.diminfo[0].shape = __pyx_pybuffernd_d.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_d = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line34")'> 34: </pre>
<pre id='line34' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line35")'> 35:     for i_frame in range(n_frames):</pre>
<pre id='line35' class='code' style='background-color: #FFFFff'>
  /* "lib\structure\cStructure.pyx":35
 *     cdef np.ndarray[ndim=1, dtype=np.float32_t] d = np.empty(n_frames, dtype=np.float32)
 * 
 *     for i_frame in range(n_frames):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         ### Donor ###
 * 
 */
  __pyx_t_8 = __pyx_v_n_frames;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_i_frame = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line36")'> 36:         ### Donor ###</pre>
<pre id='line36' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line37")'> 37: </pre>
<pre id='line37' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line38")'> 38:         # cartesian coordinates of the donor-dipole</pre>
<pre id='line38' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line39")'> 39:         d11 = xyz[i_frame, aid1, 0]</pre>
<pre id='line39' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":39
 * 
 *         # cartesian coordinates of the donor-dipole
 *         d11 = xyz[i_frame, aid1, 0]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         d12 = xyz[i_frame, aid1, 1]
 *         d13 = xyz[i_frame, aid1, 2]
 */
    __pyx_t_10 = __pyx_v_i_frame;
    __pyx_t_11 = __pyx_v_aid1;
    __pyx_t_12 = 0;
    __pyx_v_d11 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_10 * __pyx_v_xyz.strides[0]) ) + __pyx_t_11 * __pyx_v_xyz.strides[1]) ) + __pyx_t_12 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line40")'> 40:         d12 = xyz[i_frame, aid1, 1]</pre>
<pre id='line40' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":40
 *         # cartesian coordinates of the donor-dipole
 *         d11 = xyz[i_frame, aid1, 0]
 *         d12 = xyz[i_frame, aid1, 1]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         d13 = xyz[i_frame, aid1, 2]
 * 
 */
    __pyx_t_13 = __pyx_v_i_frame;
    __pyx_t_14 = __pyx_v_aid1;
    __pyx_t_15 = 1;
    __pyx_v_d12 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_13 * __pyx_v_xyz.strides[0]) ) + __pyx_t_14 * __pyx_v_xyz.strides[1]) ) + __pyx_t_15 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line41")'> 41:         d13 = xyz[i_frame, aid1, 2]</pre>
<pre id='line41' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":41
 *         d11 = xyz[i_frame, aid1, 0]
 *         d12 = xyz[i_frame, aid1, 1]
 *         d13 = xyz[i_frame, aid1, 2]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *         d21 = xyz[i_frame, aid2, 0]
 */
    __pyx_t_16 = __pyx_v_i_frame;
    __pyx_t_17 = __pyx_v_aid1;
    __pyx_t_18 = 2;
    __pyx_v_d13 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_16 * __pyx_v_xyz.strides[0]) ) + __pyx_t_17 * __pyx_v_xyz.strides[1]) ) + __pyx_t_18 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line42")'> 42: </pre>
<pre id='line42' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line43")'> 43:         d21 = xyz[i_frame, aid2, 0]</pre>
<pre id='line43' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":43
 *         d13 = xyz[i_frame, aid1, 2]
 * 
 *         d21 = xyz[i_frame, aid2, 0]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         d22 = xyz[i_frame, aid2, 1]
 *         d23 = xyz[i_frame, aid2, 2]
 */
    __pyx_t_19 = __pyx_v_i_frame;
    __pyx_t_20 = __pyx_v_aid2;
    __pyx_t_21 = 0;
    __pyx_v_d21 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_19 * __pyx_v_xyz.strides[0]) ) + __pyx_t_20 * __pyx_v_xyz.strides[1]) ) + __pyx_t_21 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line44")'> 44:         d22 = xyz[i_frame, aid2, 1]</pre>
<pre id='line44' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":44
 * 
 *         d21 = xyz[i_frame, aid2, 0]
 *         d22 = xyz[i_frame, aid2, 1]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         d23 = xyz[i_frame, aid2, 2]
 * 
 */
    __pyx_t_22 = __pyx_v_i_frame;
    __pyx_t_23 = __pyx_v_aid2;
    __pyx_t_24 = 1;
    __pyx_v_d22 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_22 * __pyx_v_xyz.strides[0]) ) + __pyx_t_23 * __pyx_v_xyz.strides[1]) ) + __pyx_t_24 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line45")'> 45:         d23 = xyz[i_frame, aid2, 2]</pre>
<pre id='line45' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":45
 *         d21 = xyz[i_frame, aid2, 0]
 *         d22 = xyz[i_frame, aid2, 1]
 *         d23 = xyz[i_frame, aid2, 2]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *         # distance between the two end points of the donor
 */
    __pyx_t_25 = __pyx_v_i_frame;
    __pyx_t_26 = __pyx_v_aid2;
    __pyx_t_27 = 2;
    __pyx_v_d23 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_25 * __pyx_v_xyz.strides[0]) ) + __pyx_t_26 * __pyx_v_xyz.strides[1]) ) + __pyx_t_27 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line46")'> 46: </pre>
<pre id='line46' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line47")'> 47:         # distance between the two end points of the donor</pre>
<pre id='line47' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line48")'> 48:         dD21 = sqrt( (d11 - d21)*(d11 - d21) +</pre>
<pre id='line48' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":48
 * 
 *         # distance between the two end points of the donor
 *         dD21 = sqrt( (d11 - d21)*(d11 - d21) +             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                      (d12 - d22)*(d12 - d22) +
 *                      (d13 - d23)*(d13 - d23)
 */
    __pyx_v_dD21 = sqrt(((((__pyx_v_d11 - __pyx_v_d21) * (__pyx_v_d11 - __pyx_v_d21)) + ((__pyx_v_d12 - __pyx_v_d22) * (__pyx_v_d12 - __pyx_v_d22))) + ((__pyx_v_d13 - __pyx_v_d23) * (__pyx_v_d13 - __pyx_v_d23))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line49")'> 49:                      (d12 - d22)*(d12 - d22) +</pre>
<pre id='line49' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line50")'> 50:                      (d13 - d23)*(d13 - d23)</pre>
<pre id='line50' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line51")'> 51:         )</pre>
<pre id='line51' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line52")'> 52: </pre>
<pre id='line52' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line53")'> 53:         # normal vector of the donor-dipole</pre>
<pre id='line53' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line54")'> 54:         muD1 = (d21 - d11) / dD21</pre>
<pre id='line54' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":54
 * 
 *         # normal vector of the donor-dipole
 *         muD1 = (d21 - d11) / dD21             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         muD2 = (d22 - d12) / dD21
 *         muD3 = (d23 - d13) / dD21
 */
    __pyx_v_muD1 = ((__pyx_v_d21 - __pyx_v_d11) / __pyx_v_dD21);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line55")'> 55:         muD2 = (d22 - d12) / dD21</pre>
<pre id='line55' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":55
 *         # normal vector of the donor-dipole
 *         muD1 = (d21 - d11) / dD21
 *         muD2 = (d22 - d12) / dD21             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         muD3 = (d23 - d13) / dD21
 * 
 */
    __pyx_v_muD2 = ((__pyx_v_d22 - __pyx_v_d12) / __pyx_v_dD21);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line56")'> 56:         muD3 = (d23 - d13) / dD21</pre>
<pre id='line56' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":56
 *         muD1 = (d21 - d11) / dD21
 *         muD2 = (d22 - d12) / dD21
 *         muD3 = (d23 - d13) / dD21             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *         # vector to the middle of the donor-dipole
 */
    __pyx_v_muD3 = ((__pyx_v_d23 - __pyx_v_d13) / __pyx_v_dD21);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line57")'> 57: </pre>
<pre id='line57' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line58")'> 58:         # vector to the middle of the donor-dipole</pre>
<pre id='line58' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line59")'> 59:         dM1 = d11 + dD21 * muD1 / 2.0</pre>
<pre id='line59' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":59
 * 
 *         # vector to the middle of the donor-dipole
 *         dM1 = d11 + dD21 * muD1 / 2.0             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         dM2 = d12 + dD21 * muD2 / 2.0
 *         dM3 = d13 + dD21 * muD3 / 2.0
 */
    __pyx_v_dM1 = (__pyx_v_d11 + ((__pyx_v_dD21 * __pyx_v_muD1) / 2.0));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line60")'> 60:         dM2 = d12 + dD21 * muD2 / 2.0</pre>
<pre id='line60' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":60
 *         # vector to the middle of the donor-dipole
 *         dM1 = d11 + dD21 * muD1 / 2.0
 *         dM2 = d12 + dD21 * muD2 / 2.0             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         dM3 = d13 + dD21 * muD3 / 2.0
 * 
 */
    __pyx_v_dM2 = (__pyx_v_d12 + ((__pyx_v_dD21 * __pyx_v_muD2) / 2.0));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line61")'> 61:         dM3 = d13 + dD21 * muD3 / 2.0</pre>
<pre id='line61' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":61
 *         dM1 = d11 + dD21 * muD1 / 2.0
 *         dM2 = d12 + dD21 * muD2 / 2.0
 *         dM3 = d13 + dD21 * muD3 / 2.0             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *         ### Acceptor ###
 */
    __pyx_v_dM3 = (__pyx_v_d13 + ((__pyx_v_dD21 * __pyx_v_muD3) / 2.0));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line62")'> 62: </pre>
<pre id='line62' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line63")'> 63:         ### Acceptor ###</pre>
<pre id='line63' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line64")'> 64: </pre>
<pre id='line64' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line65")'> 65:         # cartesian coordinates of the acceptor</pre>
<pre id='line65' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line66")'> 66:         a11 = xyz[i_frame, aia1, 0]</pre>
<pre id='line66' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":66
 * 
 *         # cartesian coordinates of the acceptor
 *         a11 = xyz[i_frame, aia1, 0]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         a12 = xyz[i_frame, aia1, 1]
 *         a13 = xyz[i_frame, aia1, 2]
 */
    __pyx_t_28 = __pyx_v_i_frame;
    __pyx_t_29 = __pyx_v_aia1;
    __pyx_t_30 = 0;
    __pyx_v_a11 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_28 * __pyx_v_xyz.strides[0]) ) + __pyx_t_29 * __pyx_v_xyz.strides[1]) ) + __pyx_t_30 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line67")'> 67:         a12 = xyz[i_frame, aia1, 1]</pre>
<pre id='line67' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":67
 *         # cartesian coordinates of the acceptor
 *         a11 = xyz[i_frame, aia1, 0]
 *         a12 = xyz[i_frame, aia1, 1]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         a13 = xyz[i_frame, aia1, 2]
 * 
 */
    __pyx_t_31 = __pyx_v_i_frame;
    __pyx_t_32 = __pyx_v_aia1;
    __pyx_t_33 = 1;
    __pyx_v_a12 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_31 * __pyx_v_xyz.strides[0]) ) + __pyx_t_32 * __pyx_v_xyz.strides[1]) ) + __pyx_t_33 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line68")'> 68:         a13 = xyz[i_frame, aia1, 2]</pre>
<pre id='line68' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":68
 *         a11 = xyz[i_frame, aia1, 0]
 *         a12 = xyz[i_frame, aia1, 1]
 *         a13 = xyz[i_frame, aia1, 2]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *         a21 = xyz[i_frame, aia2, 0]
 */
    __pyx_t_34 = __pyx_v_i_frame;
    __pyx_t_35 = __pyx_v_aia1;
    __pyx_t_36 = 2;
    __pyx_v_a13 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_34 * __pyx_v_xyz.strides[0]) ) + __pyx_t_35 * __pyx_v_xyz.strides[1]) ) + __pyx_t_36 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line69")'> 69: </pre>
<pre id='line69' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line70")'> 70:         a21 = xyz[i_frame, aia2, 0]</pre>
<pre id='line70' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":70
 *         a13 = xyz[i_frame, aia1, 2]
 * 
 *         a21 = xyz[i_frame, aia2, 0]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         a22 = xyz[i_frame, aia2, 1]
 *         a23 = xyz[i_frame, aia2, 2]
 */
    __pyx_t_37 = __pyx_v_i_frame;
    __pyx_t_38 = __pyx_v_aia2;
    __pyx_t_39 = 0;
    __pyx_v_a21 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_37 * __pyx_v_xyz.strides[0]) ) + __pyx_t_38 * __pyx_v_xyz.strides[1]) ) + __pyx_t_39 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line71")'> 71:         a22 = xyz[i_frame, aia2, 1]</pre>
<pre id='line71' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":71
 * 
 *         a21 = xyz[i_frame, aia2, 0]
 *         a22 = xyz[i_frame, aia2, 1]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         a23 = xyz[i_frame, aia2, 2]
 * 
 */
    __pyx_t_40 = __pyx_v_i_frame;
    __pyx_t_41 = __pyx_v_aia2;
    __pyx_t_42 = 1;
    __pyx_v_a22 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_40 * __pyx_v_xyz.strides[0]) ) + __pyx_t_41 * __pyx_v_xyz.strides[1]) ) + __pyx_t_42 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line72")'> 72:         a23 = xyz[i_frame, aia2, 2]</pre>
<pre id='line72' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":72
 *         a21 = xyz[i_frame, aia2, 0]
 *         a22 = xyz[i_frame, aia2, 1]
 *         a23 = xyz[i_frame, aia2, 2]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *         # distance between the two end points of the acceptor
 */
    __pyx_t_43 = __pyx_v_i_frame;
    __pyx_t_44 = __pyx_v_aia2;
    __pyx_t_45 = 2;
    __pyx_v_a23 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_43 * __pyx_v_xyz.strides[0]) ) + __pyx_t_44 * __pyx_v_xyz.strides[1]) ) + __pyx_t_45 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line73")'> 73: </pre>
<pre id='line73' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line74")'> 74:         # distance between the two end points of the acceptor</pre>
<pre id='line74' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line75")'> 75:         dA21 = sqrt( (a11 - a21)*(a11 - a21) +</pre>
<pre id='line75' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":75
 * 
 *         # distance between the two end points of the acceptor
 *         dA21 = sqrt( (a11 - a21)*(a11 - a21) +             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                      (a12 - a22)*(a12 - a22) +
 *                      (a13 - a23)*(a13 - a23)
 */
    __pyx_v_dA21 = sqrt(((((__pyx_v_a11 - __pyx_v_a21) * (__pyx_v_a11 - __pyx_v_a21)) + ((__pyx_v_a12 - __pyx_v_a22) * (__pyx_v_a12 - __pyx_v_a22))) + ((__pyx_v_a13 - __pyx_v_a23) * (__pyx_v_a13 - __pyx_v_a23))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line76")'> 76:                      (a12 - a22)*(a12 - a22) +</pre>
<pre id='line76' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line77")'> 77:                      (a13 - a23)*(a13 - a23)</pre>
<pre id='line77' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line78")'> 78:         )</pre>
<pre id='line78' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line79")'> 79: </pre>
<pre id='line79' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line80")'> 80:         # normal vector of the acceptor-dipole</pre>
<pre id='line80' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line81")'> 81:         muA1 = (a21 - a11) / dA21</pre>
<pre id='line81' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":81
 * 
 *         # normal vector of the acceptor-dipole
 *         muA1 = (a21 - a11) / dA21             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         muA2 = (a22 - a12) / dA21
 *         muA3 = (a23 - a13) / dA21
 */
    __pyx_v_muA1 = ((__pyx_v_a21 - __pyx_v_a11) / __pyx_v_dA21);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line82")'> 82:         muA2 = (a22 - a12) / dA21</pre>
<pre id='line82' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":82
 *         # normal vector of the acceptor-dipole
 *         muA1 = (a21 - a11) / dA21
 *         muA2 = (a22 - a12) / dA21             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         muA3 = (a23 - a13) / dA21
 * 
 */
    __pyx_v_muA2 = ((__pyx_v_a22 - __pyx_v_a12) / __pyx_v_dA21);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line83")'> 83:         muA3 = (a23 - a13) / dA21</pre>
<pre id='line83' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":83
 *         muA1 = (a21 - a11) / dA21
 *         muA2 = (a22 - a12) / dA21
 *         muA3 = (a23 - a13) / dA21             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *         # vector to the middle of the acceptor-dipole
 */
    __pyx_v_muA3 = ((__pyx_v_a23 - __pyx_v_a13) / __pyx_v_dA21);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line84")'> 84: </pre>
<pre id='line84' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line85")'> 85:         # vector to the middle of the acceptor-dipole</pre>
<pre id='line85' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line86")'> 86:         aM1 = a11 + dA21 * muA1 / 2.0</pre>
<pre id='line86' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":86
 * 
 *         # vector to the middle of the acceptor-dipole
 *         aM1 = a11 + dA21 * muA1 / 2.0             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         aM2 = a12 + dA21 * muA2 / 2.0
 *         aM3 = a13 + dA21 * muA3 / 2.0
 */
    __pyx_v_aM1 = (__pyx_v_a11 + ((__pyx_v_dA21 * __pyx_v_muA1) / 2.0));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line87")'> 87:         aM2 = a12 + dA21 * muA2 / 2.0</pre>
<pre id='line87' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":87
 *         # vector to the middle of the acceptor-dipole
 *         aM1 = a11 + dA21 * muA1 / 2.0
 *         aM2 = a12 + dA21 * muA2 / 2.0             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         aM3 = a13 + dA21 * muA3 / 2.0
 * 
 */
    __pyx_v_aM2 = (__pyx_v_a12 + ((__pyx_v_dA21 * __pyx_v_muA2) / 2.0));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line88")'> 88:         aM3 = a13 + dA21 * muA3 / 2.0</pre>
<pre id='line88' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":88
 *         aM1 = a11 + dA21 * muA1 / 2.0
 *         aM2 = a12 + dA21 * muA2 / 2.0
 *         aM3 = a13 + dA21 * muA3 / 2.0             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *         # vector connecting the middle of the dipoles
 */
    __pyx_v_aM3 = (__pyx_v_a13 + ((__pyx_v_dA21 * __pyx_v_muA3) / 2.0));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line89")'> 89: </pre>
<pre id='line89' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line90")'> 90:         # vector connecting the middle of the dipoles</pre>
<pre id='line90' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line91")'> 91:         RDA1 = dM1 - aM1</pre>
<pre id='line91' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":91
 * 
 *         # vector connecting the middle of the dipoles
 *         RDA1 = dM1 - aM1             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         RDA2 = dM2 - aM2
 *         RDA3 = dM3 - aM3
 */
    __pyx_v_RDA1 = (__pyx_v_dM1 - __pyx_v_aM1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line92")'> 92:         RDA2 = dM2 - aM2</pre>
<pre id='line92' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":92
 *         # vector connecting the middle of the dipoles
 *         RDA1 = dM1 - aM1
 *         RDA2 = dM2 - aM2             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         RDA3 = dM3 - aM3
 * 
 */
    __pyx_v_RDA2 = (__pyx_v_dM2 - __pyx_v_aM2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line93")'> 93:         RDA3 = dM3 - aM3</pre>
<pre id='line93' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":93
 *         RDA1 = dM1 - aM1
 *         RDA2 = dM2 - aM2
 *         RDA3 = dM3 - aM3             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *         # Length of the dipole-dipole vector (distance)
 */
    __pyx_v_RDA3 = (__pyx_v_dM3 - __pyx_v_aM3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line94")'> 94: </pre>
<pre id='line94' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line95")'> 95:         # Length of the dipole-dipole vector (distance)</pre>
<pre id='line95' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line96")'> 96:         dRDA = sqrt(RDA1*RDA1 + RDA2*RDA2 + RDA3*RDA3)</pre>
<pre id='line96' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":96
 * 
 *         # Length of the dipole-dipole vector (distance)
 *         dRDA = sqrt(RDA1*RDA1 + RDA2*RDA2 + RDA3*RDA3)             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *         # Normalized dipole-diple vector
 */
    __pyx_v_dRDA = sqrt((((__pyx_v_RDA1 * __pyx_v_RDA1) + (__pyx_v_RDA2 * __pyx_v_RDA2)) + (__pyx_v_RDA3 * __pyx_v_RDA3)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line97")'> 97: </pre>
<pre id='line97' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line98")'> 98:         # Normalized dipole-diple vector</pre>
<pre id='line98' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line99")'> 99:         nRDA1 = RDA1 / dRDA</pre>
<pre id='line99' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":99
 * 
 *         # Normalized dipole-diple vector
 *         nRDA1 = RDA1 / dRDA             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         nRDA2 = RDA2 / dRDA
 *         nRDA3 = RDA3 / dRDA
 */
    __pyx_v_nRDA1 = (__pyx_v_RDA1 / __pyx_v_dRDA);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line100")'> 100:         nRDA2 = RDA2 / dRDA</pre>
<pre id='line100' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":100
 *         # Normalized dipole-diple vector
 *         nRDA1 = RDA1 / dRDA
 *         nRDA2 = RDA2 / dRDA             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         nRDA3 = RDA3 / dRDA
 * 
 */
    __pyx_v_nRDA2 = (__pyx_v_RDA2 / __pyx_v_dRDA);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line101")'> 101:         nRDA3 = RDA3 / dRDA</pre>
<pre id='line101' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":101
 *         nRDA1 = RDA1 / dRDA
 *         nRDA2 = RDA2 / dRDA
 *         nRDA3 = RDA3 / dRDA             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *         # Orientation factor kappa2
 */
    __pyx_v_nRDA3 = (__pyx_v_RDA3 / __pyx_v_dRDA);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line102")'> 102: </pre>
<pre id='line102' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line103")'> 103:         # Orientation factor kappa2</pre>
<pre id='line103' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line104")'> 104:         kappa = muA1*muD1 + muA2*muD2 + muA3*muD3 - 3.0 * (muD1*nRDA1+muD2*nRDA2+muD3*nRDA3) * (muA1*nRDA1+muA2*nRDA2+muA3*nRDA3)</pre>
<pre id='line104' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":104
 * 
 *         # Orientation factor kappa2
 *         kappa = muA1*muD1 + muA2*muD2 + muA3*muD3 - 3.0 * (muD1*nRDA1+muD2*nRDA2+muD3*nRDA3) * (muA1*nRDA1+muA2*nRDA2+muA3*nRDA3)             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         kappa2 = kappa * kappa
 * 
 */
    __pyx_v_kappa = ((((__pyx_v_muA1 * __pyx_v_muD1) + (__pyx_v_muA2 * __pyx_v_muD2)) + (__pyx_v_muA3 * __pyx_v_muD3)) - ((3.0 * (((__pyx_v_muD1 * __pyx_v_nRDA1) + (__pyx_v_muD2 * __pyx_v_nRDA2)) + (__pyx_v_muD3 * __pyx_v_nRDA3))) * (((__pyx_v_muA1 * __pyx_v_nRDA1) + (__pyx_v_muA2 * __pyx_v_nRDA2)) + (__pyx_v_muA3 * __pyx_v_nRDA3))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line105")'> 105:         kappa2 = kappa * kappa</pre>
<pre id='line105' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":105
 *         # Orientation factor kappa2
 *         kappa = muA1*muD1 + muA2*muD2 + muA3*muD3 - 3.0 * (muD1*nRDA1+muD2*nRDA2+muD3*nRDA3) * (muA1*nRDA1+muA2*nRDA2+muA3*nRDA3)
 *         kappa2 = kappa * kappa             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *         k2[i_frame] = kappa2
 */
    __pyx_v_kappa2 = (__pyx_v_kappa * __pyx_v_kappa);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line106")'> 106: </pre>
<pre id='line106' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line107")'> 107:         k2[i_frame] = kappa2</pre>
<pre id='line107' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":107
 *         kappa2 = kappa * kappa
 * 
 *         k2[i_frame] = kappa2             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         d[i_frame] = dRDA
 * 
 */
    __pyx_t_46 = __pyx_v_i_frame;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_k2.rcbuffer-&gt;pybuffer.buf, __pyx_t_46, __pyx_pybuffernd_k2.diminfo[0].strides) = __pyx_v_kappa2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line108")'> 108:         d[i_frame] = dRDA</pre>
<pre id='line108' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":108
 * 
 *         k2[i_frame] = kappa2
 *         d[i_frame] = dRDA             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *     return d, k2
 */
    __pyx_t_47 = __pyx_v_i_frame;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_d.rcbuffer-&gt;pybuffer.buf, __pyx_t_47, __pyx_pybuffernd_d.diminfo[0].strides) = __pyx_v_dRDA;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line109")'> 109: </pre>
<pre id='line109' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line110")'> 110:     return d, k2</pre>
<pre id='line110' class='code' style='background-color: #FFFF7f'>
  /* "lib\structure\cStructure.pyx":110
 *         d[i_frame] = dRDA
 * 
 *     return d, k2             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 * @cython.wraparound(False)
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_d));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, ((PyObject *)__pyx_v_d));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_d));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_k2));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, ((PyObject *)__pyx_v_k2));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_k2));
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line111")'> 111: </pre>
<pre id='line111' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line112")'> 112: @cython.wraparound(False)</pre>
<pre id='line112' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line113")'> 113: @cython.boundscheck(False)</pre>
<pre id='line113' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF14' onclick='toggleDiv("line114")'> 114: def below_min_distance(float[:,:,:] xyz, float min_distance, int[:] atom_selection=np.empty(0, dtype=np.int32)):</pre>
<pre id='line114' class='code' style='background-color: #FFFF14'>
/* "lib\structure\cStructure.pyx":114
 * @cython.wraparound(False)
 * @cython.boundscheck(False)
 * def below_min_distance(float[:,:,:] xyz, float min_distance, int[:] atom_selection=np.empty(0, dtype=np.int32)):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     """Takes the xyz-coordinates (frame, atom, xyz) of a trajectory as an argument an returns a vector of booleans
 *     of length of the number of frames. The bool is False if the frame contains a atomic distance smaller than the
 */

/* Python wrapper */
static PyObject *__pyx_pw_3lib_9structure_10cStructure_3below_min_distance(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3lib_9structure_10cStructure_2below_min_distance[] = "Takes the xyz-coordinates (frame, atom, xyz) of a trajectory as an argument an returns a vector of booleans\n    of length of the number of frames. The bool is False if the frame contains a atomic distance smaller than the\n    min distance.\n\n    :param xyz: numpy array\n        The coordinates (frame nbr, atom nbr, coord)\n\n    :param min_distance: float\n        Minimum distance if a distance\n\n    :return: numpy-array\n        If a atom-atom distance within a frame is smaller than min_distance the value within the array is True otherwise\n        it is False.\n\n    ";
static PyMethodDef __pyx_mdef_3lib_9structure_10cStructure_3below_min_distance = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("below_min_distance"), (PyCFunction)__pyx_pw_3lib_9structure_10cStructure_3below_min_distance, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(__pyx_doc_3lib_9structure_10cStructure_2below_min_distance)};
static PyObject *__pyx_pw_3lib_9structure_10cStructure_3below_min_distance(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_xyz = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_min_distance;
  __Pyx_memviewslice __pyx_v_atom_selection = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("below_min_distance (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_xyz,&amp;__pyx_n_s_min_distance,&amp;__pyx_n_s_atom_selection,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_xyz)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_min_distance)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("below_min_distance", 0, 2, 3, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_atom_selection);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "below_min_distance") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_xyz = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(values[0]);<span class='error_goto'> if (unlikely(!__pyx_v_xyz.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_min_distance = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_min_distance == (float)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    if (values[2]) {
      __pyx_v_atom_selection = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[2]);<span class='error_goto'> if (unlikely(!__pyx_v_atom_selection.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_atom_selection = __pyx_k_;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_atom_selection, 1);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("below_min_distance", 0, 2, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.cStructure.below_min_distance", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3lib_9structure_10cStructure_2below_min_distance(__pyx_self, __pyx_v_xyz, __pyx_v_min_distance, __pyx_v_atom_selection);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3lib_9structure_10cStructure_2below_min_distance(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_xyz, float __pyx_v_min_distance, __Pyx_memviewslice __pyx_v_atom_selection) {
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_n_atoms;
  int __pyx_v_n_frames;
  int __pyx_v_i_frame;
  int __pyx_v_i_atom;
  int __pyx_v_j_atom;
  float __pyx_v_x1;
  float __pyx_v_y1;
  float __pyx_v_z1;
  float __pyx_v_x2;
  float __pyx_v_y2;
  float __pyx_v_z2;
  float __pyx_v_dx;
  float __pyx_v_dy;
  float __pyx_v_dz;
  PyArrayObject *__pyx_v_re = 0;
  __Pyx_memviewslice __pyx_v_atoms = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_LocalBuf_ND __pyx_pybuffernd_re;
  __Pyx_Buffer __pyx_pybuffer_re;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("below_min_distance", 0);
  __pyx_pybuffer_re.pybuffer.buf = NULL;
  __pyx_pybuffer_re.refcount = 0;
  __pyx_pybuffernd_re.data = NULL;
  __pyx_pybuffernd_re.rcbuffer = &amp;__pyx_pybuffer_re;

  /* "lib\structure\cStructure.pyx":114
 * @cython.wraparound(False)
 * @cython.boundscheck(False)
 * def below_min_distance(float[:,:,:] xyz, float min_distance, int[:] atom_selection=np.empty(0, dtype=np.int32)):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     """Takes the xyz-coordinates (frame, atom, xyz) of a trajectory as an argument an returns a vector of booleans
 *     of length of the number of frames. The bool is False if the frame contains a atomic distance smaller than the
 */

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_re.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.cStructure.below_min_distance", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_re.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_re);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_atoms, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xyz, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_atom_selection, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

  /* "lib\structure\cStructure.pyx":114
 * @cython.wraparound(False)
 * @cython.boundscheck(False)
 * def below_min_distance(float[:,:,:] xyz, float min_distance, int[:] atom_selection=np.empty(0, dtype=np.int32)):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     """Takes the xyz-coordinates (frame, atom, xyz) of a trajectory as an argument an returns a vector of booleans
 *     of length of the number of frames. The bool is False if the frame contains a atomic distance smaller than the
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, __pyx_tuple__23, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_k_ = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;

  /* "lib\structure\cStructure.pyx":114
 * @cython.wraparound(False)
 * @cython.boundscheck(False)
 * def below_min_distance(float[:,:,:] xyz, float min_distance, int[:] atom_selection=np.empty(0, dtype=np.int32)):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     """Takes the xyz-coordinates (frame, atom, xyz) of a trajectory as an argument an returns a vector of booleans
 *     of length of the number of frames. The bool is False if the frame contains a atomic distance smaller than the
 */
  __pyx_tuple__23 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__23);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__23);
  __pyx_tuple__24 = <span class='py_c_api'>PyTuple_Pack</span>(21, __pyx_n_s_xyz, __pyx_n_s_min_distance, __pyx_n_s_atom_selection, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_n_atoms, __pyx_n_s_n_frames, __pyx_n_s_i_frame, __pyx_n_s_i_atom, __pyx_n_s_j_atom, __pyx_n_s_x1, __pyx_n_s_y1, __pyx_n_s_z1, __pyx_n_s_x2, __pyx_n_s_y2, __pyx_n_s_z2, __pyx_n_s_dx, __pyx_n_s_dy, __pyx_n_s_dz, __pyx_n_s_re, __pyx_n_s_atoms);<span class='error_goto'> if (unlikely(!__pyx_tuple__24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__24);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__24);
  __pyx_t_4 = PyCFunction_NewEx(&amp;__pyx_mdef_3lib_9structure_10cStructure_3below_min_distance, NULL, __pyx_n_s_lib_structure_cStructure);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_below_min_distance, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__25 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 21, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__24, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_F_devel_lib_structure_cStructure, __pyx_n_s_below_min_distance, 114, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line115")'> 115:     """Takes the xyz-coordinates (frame, atom, xyz) of a trajectory as an argument an returns a vector of booleans</pre>
<pre id='line115' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line116")'> 116:     of length of the number of frames. The bool is False if the frame contains a atomic distance smaller than the</pre>
<pre id='line116' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line117")'> 117:     min distance.</pre>
<pre id='line117' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line118")'> 118: </pre>
<pre id='line118' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line119")'> 119:     :param xyz: numpy array</pre>
<pre id='line119' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line120")'> 120:         The coordinates (frame nbr, atom nbr, coord)</pre>
<pre id='line120' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line121")'> 121: </pre>
<pre id='line121' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line122")'> 122:     :param min_distance: float</pre>
<pre id='line122' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line123")'> 123:         Minimum distance if a distance</pre>
<pre id='line123' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line124")'> 124: </pre>
<pre id='line124' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line125")'> 125:     :return: numpy-array</pre>
<pre id='line125' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line126")'> 126:         If a atom-atom distance within a frame is smaller than min_distance the value within the array is True otherwise</pre>
<pre id='line126' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line127")'> 127:         it is False.</pre>
<pre id='line127' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line128")'> 128: </pre>
<pre id='line128' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line129")'> 129:     """</pre>
<pre id='line129' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line130")'> 130:     cdef int i, j, n_atoms, n_frames</pre>
<pre id='line130' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line131")'> 131:     cdef int i_frame, i_atom, j_atom</pre>
<pre id='line131' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line132")'> 132:     cdef float x1, y1, z1</pre>
<pre id='line132' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line133")'> 133:     cdef float x2, y2, z2</pre>
<pre id='line133' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line134")'> 134:     cdef float dx, dy, dz</pre>
<pre id='line134' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line135")'> 135: </pre>
<pre id='line135' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line136")'> 136:     n_frames = xyz.shape[0]</pre>
<pre id='line136' class='code' style='background-color: #FFFFff'>
  /* "lib\structure\cStructure.pyx":136
 *     cdef float dx, dy, dz
 * 
 *     n_frames = xyz.shape[0]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     cdef np.ndarray[ndim=1, dtype=np.uint8_t] re = np.zeros(n_frames, dtype=np.uint8)
 * 
 */
  __pyx_v_n_frames = (__pyx_v_xyz.shape[0]);
</pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line137")'> 137:     cdef np.ndarray[ndim=1, dtype=np.uint8_t] re = np.zeros(n_frames, dtype=np.uint8)</pre>
<pre id='line137' class='code' style='background-color: #FFFF31'>
  /* "lib\structure\cStructure.pyx":137
 * 
 *     n_frames = xyz.shape[0]
 *     cdef np.ndarray[ndim=1, dtype=np.uint8_t] re = np.zeros(n_frames, dtype=np.uint8)             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *     cdef int[:] atoms = range(xyz.shape[1]) if atom_selection.shape[0] == 0 else atom_selection
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_frames);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_uint8);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_re.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_re = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_re.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_re.diminfo[0].strides = __pyx_pybuffernd_re.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_re.diminfo[0].shape = __pyx_pybuffernd_re.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_6 = 0;
  __pyx_v_re = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line138")'> 138: </pre>
<pre id='line138' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line139")'> 139:     cdef int[:] atoms = range(xyz.shape[1]) if atom_selection.shape[0] == 0 else atom_selection</pre>
<pre id='line139' class='code' style='background-color: #FFFF4d'>
  /* "lib\structure\cStructure.pyx":139
 *     cdef np.ndarray[ndim=1, dtype=np.uint8_t] re = np.zeros(n_frames, dtype=np.uint8)
 * 
 *     cdef int[:] atoms = range(xyz.shape[1]) if atom_selection.shape[0] == 0 else atom_selection             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     n_atoms = atoms.shape[0]
 * 
 */
  if ((((__pyx_v_atom_selection.shape[0]) == 0) != 0)) {
    __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_xyz.shape[1]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_5);
    if (unlikely(!__pyx_t_8.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_7 = __pyx_t_8;
    __pyx_t_8.memview = NULL;
    __pyx_t_8.data = NULL;
  } else {
    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_atom_selection, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_5);
    if (unlikely(!__pyx_t_8.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_7 = __pyx_t_8;
    __pyx_t_8.memview = NULL;
    __pyx_t_8.data = NULL;
  }
  __pyx_v_atoms = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line140")'> 140:     n_atoms = atoms.shape[0]</pre>
<pre id='line140' class='code' style='background-color: #FFFFff'>
  /* "lib\structure\cStructure.pyx":140
 * 
 *     cdef int[:] atoms = range(xyz.shape[1]) if atom_selection.shape[0] == 0 else atom_selection
 *     n_atoms = atoms.shape[0]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *     for i_frame in prange(n_frames, nogil=True):
 */
  __pyx_v_n_atoms = (__pyx_v_atoms.shape[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line141")'> 141: </pre>
<pre id='line141' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line142")'> 142:     for i_frame in prange(n_frames, nogil=True):</pre>
<pre id='line142' class='code' style='background-color: #FFFFff'>
  /* "lib\structure\cStructure.pyx":142
 *     n_atoms = atoms.shape[0]
 * 
 *     for i_frame in prange(n_frames, nogil=True):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     #for i_frame in range(n_frames):
 * 
 */
  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
        __pyx_t_9 = __pyx_v_n_frames;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_11 = (__pyx_t_9 - 0) / 1;
            if (__pyx_t_11 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_i_frame) lastprivate(__pyx_v_i_frame) lastprivate(__pyx_v_dy) lastprivate(__pyx_v_i_atom) lastprivate(__pyx_v_i) lastprivate(__pyx_v_j_atom) lastprivate(__pyx_v_z2) lastprivate(__pyx_v_j) lastprivate(__pyx_v_y1) lastprivate(__pyx_v_z1) lastprivate(__pyx_v_x2) lastprivate(__pyx_v_x1) lastprivate(__pyx_v_dx) lastprivate(__pyx_v_y2) lastprivate(__pyx_v_dz)
                    #endif /* _OPENMP */
                    for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_11; __pyx_t_10++){
                        {
                            __pyx_v_i_frame = 0 + 1 * __pyx_t_10;
                            /* Initialize private variables to invalid values */
                            __pyx_v_dy = ((float)__PYX_NAN());
                            __pyx_v_i_atom = ((int)0xbad0bad0);
                            __pyx_v_i = ((int)0xbad0bad0);
                            __pyx_v_j_atom = ((int)0xbad0bad0);
                            __pyx_v_z2 = ((float)__PYX_NAN());
                            __pyx_v_j = ((int)0xbad0bad0);
                            __pyx_v_y1 = ((float)__PYX_NAN());
                            __pyx_v_z1 = ((float)__PYX_NAN());
                            __pyx_v_x2 = ((float)__PYX_NAN());
                            __pyx_v_x1 = ((float)__PYX_NAN());
                            __pyx_v_dx = ((float)__PYX_NAN());
                            __pyx_v_y2 = ((float)__PYX_NAN());
                            __pyx_v_dz = ((float)__PYX_NAN());

      /* "lib\structure\cStructure.pyx":142
 *     n_atoms = atoms.shape[0]
 * 
 *     for i_frame in prange(n_frames, nogil=True):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     #for i_frame in range(n_frames):
 * 
 */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line143")'> 143:     #for i_frame in range(n_frames):</pre>
<pre id='line143' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line144")'> 144: </pre>
<pre id='line144' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line145")'> 145:         for i in range(n_atoms):</pre>
<pre id='line145' class='code' style='background-color: #FFFFff'>
                            /* "lib\structure\cStructure.pyx":145
 *     #for i_frame in range(n_frames):
 * 
 *         for i in range(n_atoms):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             i_atom = atoms[i]
 *             x1 = xyz[i_frame, i_atom, 0]
 */
                            __pyx_t_12 = __pyx_v_n_atoms;
                            for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
                              __pyx_v_i = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line146")'> 146:             i_atom = atoms[i]</pre>
<pre id='line146' class='code' style='background-color: #FFFFff'>
                              /* "lib\structure\cStructure.pyx":146
 * 
 *         for i in range(n_atoms):
 *             i_atom = atoms[i]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             x1 = xyz[i_frame, i_atom, 0]
 *             y1 = xyz[i_frame, i_atom, 1]
 */
                              __pyx_t_14 = __pyx_v_i;
                              __pyx_v_i_atom = (*((int *) ( /* dim=0 */ (__pyx_v_atoms.data + __pyx_t_14 * __pyx_v_atoms.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line147")'> 147:             x1 = xyz[i_frame, i_atom, 0]</pre>
<pre id='line147' class='code' style='background-color: #FFFFff'>
                              /* "lib\structure\cStructure.pyx":147
 *         for i in range(n_atoms):
 *             i_atom = atoms[i]
 *             x1 = xyz[i_frame, i_atom, 0]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             y1 = xyz[i_frame, i_atom, 1]
 *             z1 = xyz[i_frame, i_atom, 2]
 */
                              __pyx_t_15 = __pyx_v_i_frame;
                              __pyx_t_16 = __pyx_v_i_atom;
                              __pyx_t_17 = 0;
                              __pyx_v_x1 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_15 * __pyx_v_xyz.strides[0]) ) + __pyx_t_16 * __pyx_v_xyz.strides[1]) ) + __pyx_t_17 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line148")'> 148:             y1 = xyz[i_frame, i_atom, 1]</pre>
<pre id='line148' class='code' style='background-color: #FFFFff'>
                              /* "lib\structure\cStructure.pyx":148
 *             i_atom = atoms[i]
 *             x1 = xyz[i_frame, i_atom, 0]
 *             y1 = xyz[i_frame, i_atom, 1]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             z1 = xyz[i_frame, i_atom, 2]
 * 
 */
                              __pyx_t_18 = __pyx_v_i_frame;
                              __pyx_t_19 = __pyx_v_i_atom;
                              __pyx_t_20 = 1;
                              __pyx_v_y1 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_18 * __pyx_v_xyz.strides[0]) ) + __pyx_t_19 * __pyx_v_xyz.strides[1]) ) + __pyx_t_20 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line149")'> 149:             z1 = xyz[i_frame, i_atom, 2]</pre>
<pre id='line149' class='code' style='background-color: #FFFFff'>
                              /* "lib\structure\cStructure.pyx":149
 *             x1 = xyz[i_frame, i_atom, 0]
 *             y1 = xyz[i_frame, i_atom, 1]
 *             z1 = xyz[i_frame, i_atom, 2]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *             for j in range(i + 1, n_atoms):
 */
                              __pyx_t_21 = __pyx_v_i_frame;
                              __pyx_t_22 = __pyx_v_i_atom;
                              __pyx_t_23 = 2;
                              __pyx_v_z1 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_21 * __pyx_v_xyz.strides[0]) ) + __pyx_t_22 * __pyx_v_xyz.strides[1]) ) + __pyx_t_23 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line150")'> 150: </pre>
<pre id='line150' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line151")'> 151:             for j in range(i + 1, n_atoms):</pre>
<pre id='line151' class='code' style='background-color: #FFFFff'>
                              /* "lib\structure\cStructure.pyx":151
 *             z1 = xyz[i_frame, i_atom, 2]
 * 
 *             for j in range(i + 1, n_atoms):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 j_atom = atoms[j]
 * 
 */
                              __pyx_t_24 = __pyx_v_n_atoms;
                              for (__pyx_t_25 = (__pyx_v_i + 1); __pyx_t_25 &lt; __pyx_t_24; __pyx_t_25+=1) {
                                __pyx_v_j = __pyx_t_25;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line152")'> 152:                 j_atom = atoms[j]</pre>
<pre id='line152' class='code' style='background-color: #FFFFff'>
                                /* "lib\structure\cStructure.pyx":152
 * 
 *             for j in range(i + 1, n_atoms):
 *                 j_atom = atoms[j]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *                 x2 = xyz[i_frame, j_atom, 0]
 */
                                __pyx_t_26 = __pyx_v_j;
                                __pyx_v_j_atom = (*((int *) ( /* dim=0 */ (__pyx_v_atoms.data + __pyx_t_26 * __pyx_v_atoms.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line153")'> 153: </pre>
<pre id='line153' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line154")'> 154:                 x2 = xyz[i_frame, j_atom, 0]</pre>
<pre id='line154' class='code' style='background-color: #FFFFff'>
                                /* "lib\structure\cStructure.pyx":154
 *                 j_atom = atoms[j]
 * 
 *                 x2 = xyz[i_frame, j_atom, 0]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 y2 = xyz[i_frame, j_atom, 1]
 *                 z2 = xyz[i_frame, j_atom, 2]
 */
                                __pyx_t_27 = __pyx_v_i_frame;
                                __pyx_t_28 = __pyx_v_j_atom;
                                __pyx_t_29 = 0;
                                __pyx_v_x2 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_27 * __pyx_v_xyz.strides[0]) ) + __pyx_t_28 * __pyx_v_xyz.strides[1]) ) + __pyx_t_29 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line155")'> 155:                 y2 = xyz[i_frame, j_atom, 1]</pre>
<pre id='line155' class='code' style='background-color: #FFFFff'>
                                /* "lib\structure\cStructure.pyx":155
 * 
 *                 x2 = xyz[i_frame, j_atom, 0]
 *                 y2 = xyz[i_frame, j_atom, 1]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 z2 = xyz[i_frame, j_atom, 2]
 * 
 */
                                __pyx_t_30 = __pyx_v_i_frame;
                                __pyx_t_31 = __pyx_v_j_atom;
                                __pyx_t_32 = 1;
                                __pyx_v_y2 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_30 * __pyx_v_xyz.strides[0]) ) + __pyx_t_31 * __pyx_v_xyz.strides[1]) ) + __pyx_t_32 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line156")'> 156:                 z2 = xyz[i_frame, j_atom, 2]</pre>
<pre id='line156' class='code' style='background-color: #FFFFff'>
                                /* "lib\structure\cStructure.pyx":156
 *                 x2 = xyz[i_frame, j_atom, 0]
 *                 y2 = xyz[i_frame, j_atom, 1]
 *                 z2 = xyz[i_frame, j_atom, 2]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *                 dx = fabs(x1-x2)
 */
                                __pyx_t_33 = __pyx_v_i_frame;
                                __pyx_t_34 = __pyx_v_j_atom;
                                __pyx_t_35 = 2;
                                __pyx_v_z2 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_33 * __pyx_v_xyz.strides[0]) ) + __pyx_t_34 * __pyx_v_xyz.strides[1]) ) + __pyx_t_35 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line157")'> 157: </pre>
<pre id='line157' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line158")'> 158:                 dx = fabs(x1-x2)</pre>
<pre id='line158' class='code' style='background-color: #FFFFff'>
                                /* "lib\structure\cStructure.pyx":158
 *                 z2 = xyz[i_frame, j_atom, 2]
 * 
 *                 dx = fabs(x1-x2)             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 dy = fabs(y1-y2)
 *                 dz = fabs(z1-z2)
 */
                                __pyx_v_dx = fabs((__pyx_v_x1 - __pyx_v_x2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line159")'> 159:                 dy = fabs(y1-y2)</pre>
<pre id='line159' class='code' style='background-color: #FFFFff'>
                                /* "lib\structure\cStructure.pyx":159
 * 
 *                 dx = fabs(x1-x2)
 *                 dy = fabs(y1-y2)             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 dz = fabs(z1-z2)
 * 
 */
                                __pyx_v_dy = fabs((__pyx_v_y1 - __pyx_v_y2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line160")'> 160:                 dz = fabs(z1-z2)</pre>
<pre id='line160' class='code' style='background-color: #FFFFff'>
                                /* "lib\structure\cStructure.pyx":160
 *                 dx = fabs(x1-x2)
 *                 dy = fabs(y1-y2)
 *                 dz = fabs(z1-z2)             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *                 if dx + dy + dz &lt; min_distance:
 */
                                __pyx_v_dz = fabs((__pyx_v_z1 - __pyx_v_z2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line161")'> 161: </pre>
<pre id='line161' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line162")'> 162:                 if dx + dy + dz &lt; min_distance:</pre>
<pre id='line162' class='code' style='background-color: #FFFFff'>
                                /* "lib\structure\cStructure.pyx":162
 *                 dz = fabs(z1-z2)
 * 
 *                 if dx + dy + dz &lt; min_distance:             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                     re[i_frame] += 1
 *                     break
 */
                                __pyx_t_36 = ((((__pyx_v_dx + __pyx_v_dy) + __pyx_v_dz) &lt; __pyx_v_min_distance) != 0);
                                if (__pyx_t_36) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line163")'> 163:                     re[i_frame] += 1</pre>
<pre id='line163' class='code' style='background-color: #FFFFff'>
                                  /* "lib\structure\cStructure.pyx":163
 * 
 *                 if dx + dy + dz &lt; min_distance:
 *                     re[i_frame] += 1             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                     break
 * 
 */
                                  __pyx_t_37 = __pyx_v_i_frame;
                                  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_uint8_t *, __pyx_pybuffernd_re.rcbuffer-&gt;pybuffer.buf, __pyx_t_37, __pyx_pybuffernd_re.diminfo[0].strides) += 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line164")'> 164:                     break</pre>
<pre id='line164' class='code' style='background-color: #FFFFff'>
                                  /* "lib\structure\cStructure.pyx":164
 *                 if dx + dy + dz &lt; min_distance:
 *                     re[i_frame] += 1
 *                     break             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *             if re[i_frame] &gt; 0:
 */
                                  goto __pyx_L13_break;
                                }
                              }
                              __pyx_L13_break:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line165")'> 165: </pre>
<pre id='line165' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line166")'> 166:             if re[i_frame] &gt; 0:</pre>
<pre id='line166' class='code' style='background-color: #FFFFff'>
                              /* "lib\structure\cStructure.pyx":166
 *                     break
 * 
 *             if re[i_frame] &gt; 0:             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 break
 *     return re
 */
                              __pyx_t_24 = __pyx_v_i_frame;
                              __pyx_t_36 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_uint8_t *, __pyx_pybuffernd_re.rcbuffer-&gt;pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_re.diminfo[0].strides)) &gt; 0) != 0);
                              if (__pyx_t_36) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line167")'> 167:                 break</pre>
<pre id='line167' class='code' style='background-color: #FFFFff'>
                                /* "lib\structure\cStructure.pyx":167
 * 
 *             if re[i_frame] &gt; 0:
 *                 break             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     return re
 * 
 */
                                goto __pyx_L11_break;
                              }
                            }
                            __pyx_L11_break:;
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line168")'> 168:     return re</pre>
<pre id='line168' class='code' style='background-color: #FFFFd4'>
  /* "lib\structure\cStructure.pyx":168
 *             if re[i_frame] &gt; 0:
 *                 break
 *     return re             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_re));
  __pyx_r = ((PyObject *)__pyx_v_re);
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line169")'> 169: </pre>
<pre id='line169' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line170")'> 170: </pre>
<pre id='line170' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line171")'> 171: </pre>
<pre id='line171' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line172")'> 172: @cython.wraparound(False)</pre>
<pre id='line172' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line173")'> 173: @cython.boundscheck(False)</pre>
<pre id='line173' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF38' onclick='toggleDiv("line174")'> 174: def min_distance_sq(float[:,:,:] xyz):</pre>
<pre id='line174' class='code' style='background-color: #FFFF38'>
/* "lib\structure\cStructure.pyx":174
 * @cython.wraparound(False)
 * @cython.boundscheck(False)
 * def min_distance_sq(float[:,:,:] xyz):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     """Determines the minimum distance in each frame of a trajectory
 * 
 */

/* Python wrapper */
static PyObject *__pyx_pw_3lib_9structure_10cStructure_5min_distance_sq(PyObject *__pyx_self, PyObject *__pyx_arg_xyz); /*proto*/
static char __pyx_doc_3lib_9structure_10cStructure_4min_distance_sq[] = "Determines the minimum distance in each frame of a trajectory\n\n    :param xyz: numpy array\n        The coordinates (frame nbr, atom nbr, coord)\n\n    :return: numpy-array\n\n    ";
static PyMethodDef __pyx_mdef_3lib_9structure_10cStructure_5min_distance_sq = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("min_distance_sq"), (PyCFunction)__pyx_pw_3lib_9structure_10cStructure_5min_distance_sq, METH_O, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(__pyx_doc_3lib_9structure_10cStructure_4min_distance_sq)};
static PyObject *__pyx_pw_3lib_9structure_10cStructure_5min_distance_sq(PyObject *__pyx_self, PyObject *__pyx_arg_xyz) {
  __Pyx_memviewslice __pyx_v_xyz = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("min_distance_sq (wrapper)", 0);
  assert(__pyx_arg_xyz); {
    __pyx_v_xyz = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_arg_xyz);<span class='error_goto'> if (unlikely(!__pyx_v_xyz.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.cStructure.min_distance_sq", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3lib_9structure_10cStructure_4min_distance_sq(__pyx_self, __pyx_v_xyz);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3lib_9structure_10cStructure_4min_distance_sq(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_xyz) {
  int __pyx_v_i_frame;
  int __pyx_v_i_atom;
  int __pyx_v_j_atom;
  float __pyx_v_x1;
  float __pyx_v_y1;
  float __pyx_v_z1;
  float __pyx_v_x2;
  float __pyx_v_y2;
  float __pyx_v_z2;
  float __pyx_v_distance_sq;
  Py_ssize_t __pyx_v_n_frames;
  Py_ssize_t __pyx_v_n_atoms;
  PyArrayObject *__pyx_v_re = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_re;
  __Pyx_Buffer __pyx_pybuffer_re;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("min_distance_sq", 0);
  __pyx_pybuffer_re.pybuffer.buf = NULL;
  __pyx_pybuffer_re.refcount = 0;
  __pyx_pybuffernd_re.data = NULL;
  __pyx_pybuffernd_re.rcbuffer = &amp;__pyx_pybuffer_re;

  /* "lib\structure\cStructure.pyx":174
 * @cython.wraparound(False)
 * @cython.boundscheck(False)
 * def min_distance_sq(float[:,:,:] xyz):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     """Determines the minimum distance in each frame of a trajectory
 * 
 */

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_re.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.cStructure.min_distance_sq", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_re.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xyz, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_re);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

  /* "lib\structure\cStructure.pyx":174
 * @cython.wraparound(False)
 * @cython.boundscheck(False)
 * def min_distance_sq(float[:,:,:] xyz):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     """Determines the minimum distance in each frame of a trajectory
 * 
 */
  __pyx_tuple__26 = <span class='py_c_api'>PyTuple_Pack</span>(15, __pyx_n_s_xyz, __pyx_n_s_xyz, __pyx_n_s_i_frame, __pyx_n_s_i_atom, __pyx_n_s_j_atom, __pyx_n_s_x1, __pyx_n_s_y1, __pyx_n_s_z1, __pyx_n_s_x2, __pyx_n_s_y2, __pyx_n_s_z2, __pyx_n_s_distance_sq, __pyx_n_s_n_frames, __pyx_n_s_n_atoms, __pyx_n_s_re);<span class='error_goto'> if (unlikely(!__pyx_tuple__26)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__26);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__26);

  /* "lib\structure\cStructure.pyx":174
 * @cython.wraparound(False)
 * @cython.boundscheck(False)
 * def min_distance_sq(float[:,:,:] xyz):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     """Determines the minimum distance in each frame of a trajectory
 * 
 */
  __pyx_t_4 = PyCFunction_NewEx(&amp;__pyx_mdef_3lib_9structure_10cStructure_5min_distance_sq, NULL, __pyx_n_s_lib_structure_cStructure);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_min_distance_sq, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__27 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 15, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__26, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_F_devel_lib_structure_cStructure, __pyx_n_s_min_distance_sq, 174, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line175")'> 175:     """Determines the minimum distance in each frame of a trajectory</pre>
<pre id='line175' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line176")'> 176: </pre>
<pre id='line176' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line177")'> 177:     :param xyz: numpy array</pre>
<pre id='line177' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line178")'> 178:         The coordinates (frame nbr, atom nbr, coord)</pre>
<pre id='line178' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line179")'> 179: </pre>
<pre id='line179' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line180")'> 180:     :return: numpy-array</pre>
<pre id='line180' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line181")'> 181: </pre>
<pre id='line181' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line182")'> 182:     """</pre>
<pre id='line182' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line183")'> 183:     cdef int i_frame, i_atom, j_atom</pre>
<pre id='line183' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line184")'> 184:     cdef float x1, y1, z1</pre>
<pre id='line184' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line185")'> 185:     cdef float x2, y2, z2</pre>
<pre id='line185' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line186")'> 186:     cdef float distance_sq</pre>
<pre id='line186' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line187")'> 187: </pre>
<pre id='line187' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line188")'> 188:     n_frames = xyz.shape[0]</pre>
<pre id='line188' class='code' style='background-color: #FFFFff'>
  /* "lib\structure\cStructure.pyx":188
 *     cdef float distance_sq
 * 
 *     n_frames = xyz.shape[0]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     n_atoms = xyz.shape[1]
 * 
 */
  __pyx_v_n_frames = (__pyx_v_xyz.shape[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line189")'> 189:     n_atoms = xyz.shape[1]</pre>
<pre id='line189' class='code' style='background-color: #FFFFff'>
  /* "lib\structure\cStructure.pyx":189
 * 
 *     n_frames = xyz.shape[0]
 *     n_atoms = xyz.shape[1]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *     cdef np.ndarray[ndim=1, dtype=np.float32_t] re = np.zeros(n_frames, dtype=np.float32)
 */
  __pyx_v_n_atoms = (__pyx_v_xyz.shape[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line190")'> 190: </pre>
<pre id='line190' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2e' onclick='toggleDiv("line191")'> 191:     cdef np.ndarray[ndim=1, dtype=np.float32_t] re = np.zeros(n_frames, dtype=np.float32)</pre>
<pre id='line191' class='code' style='background-color: #FFFF2e'>
  /* "lib\structure\cStructure.pyx":191
 *     n_atoms = xyz.shape[1]
 * 
 *     cdef np.ndarray[ndim=1, dtype=np.float32_t] re = np.zeros(n_frames, dtype=np.float32)             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     for i_frame in prange(n_frames, nogil=True):
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_n_frames);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_re.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_re = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_re.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_re.diminfo[0].strides = __pyx_pybuffernd_re.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_re.diminfo[0].shape = __pyx_pybuffernd_re.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_6 = 0;
  __pyx_v_re = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line192")'> 192:     for i_frame in prange(n_frames, nogil=True):</pre>
<pre id='line192' class='code' style='background-color: #FFFFff'>
  /* "lib\structure\cStructure.pyx":192
 * 
 *     cdef np.ndarray[ndim=1, dtype=np.float32_t] re = np.zeros(n_frames, dtype=np.float32)
 *     for i_frame in prange(n_frames, nogil=True):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *         for i_atom in range(n_atoms):
 */
  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
        __pyx_t_7 = __pyx_v_n_frames;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_9 = (__pyx_t_7 - 0) / 1;
            if (__pyx_t_9 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_i_atom) lastprivate(__pyx_v_x2) lastprivate(__pyx_v_distance_sq) firstprivate(__pyx_v_i_frame) lastprivate(__pyx_v_i_frame) lastprivate(__pyx_v_z1) lastprivate(__pyx_v_x1) lastprivate(__pyx_v_y1) lastprivate(__pyx_v_j_atom) lastprivate(__pyx_v_y2) lastprivate(__pyx_v_z2)
                    #endif /* _OPENMP */
                    for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_9; __pyx_t_8++){
                        {
                            __pyx_v_i_frame = 0 + 1 * __pyx_t_8;
                            /* Initialize private variables to invalid values */
                            __pyx_v_i_atom = ((int)0xbad0bad0);
                            __pyx_v_x2 = ((float)__PYX_NAN());
                            __pyx_v_distance_sq = ((float)__PYX_NAN());
                            __pyx_v_z1 = ((float)__PYX_NAN());
                            __pyx_v_x1 = ((float)__PYX_NAN());
                            __pyx_v_y1 = ((float)__PYX_NAN());
                            __pyx_v_j_atom = ((int)0xbad0bad0);
                            __pyx_v_y2 = ((float)__PYX_NAN());
                            __pyx_v_z2 = ((float)__PYX_NAN());

      /* "lib\structure\cStructure.pyx":192
 * 
 *     cdef np.ndarray[ndim=1, dtype=np.float32_t] re = np.zeros(n_frames, dtype=np.float32)
 *     for i_frame in prange(n_frames, nogil=True):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *         for i_atom in range(n_atoms):
 */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line193")'> 193: </pre>
<pre id='line193' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line194")'> 194:         for i_atom in range(n_atoms):</pre>
<pre id='line194' class='code' style='background-color: #FFFFff'>
                            /* "lib\structure\cStructure.pyx":194
 *     for i_frame in prange(n_frames, nogil=True):
 * 
 *         for i_atom in range(n_atoms):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             x1 = xyz[i_frame, i_atom, 0]
 *             y1 = xyz[i_frame, i_atom, 1]
 */
                            __pyx_t_10 = __pyx_v_n_atoms;
                            for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
                              __pyx_v_i_atom = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line195")'> 195:             x1 = xyz[i_frame, i_atom, 0]</pre>
<pre id='line195' class='code' style='background-color: #FFFFff'>
                              /* "lib\structure\cStructure.pyx":195
 * 
 *         for i_atom in range(n_atoms):
 *             x1 = xyz[i_frame, i_atom, 0]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             y1 = xyz[i_frame, i_atom, 1]
 *             z1 = xyz[i_frame, i_atom, 2]
 */
                              __pyx_t_12 = __pyx_v_i_frame;
                              __pyx_t_13 = __pyx_v_i_atom;
                              __pyx_t_14 = 0;
                              __pyx_v_x1 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_12 * __pyx_v_xyz.strides[0]) ) + __pyx_t_13 * __pyx_v_xyz.strides[1]) ) + __pyx_t_14 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line196")'> 196:             y1 = xyz[i_frame, i_atom, 1]</pre>
<pre id='line196' class='code' style='background-color: #FFFFff'>
                              /* "lib\structure\cStructure.pyx":196
 *         for i_atom in range(n_atoms):
 *             x1 = xyz[i_frame, i_atom, 0]
 *             y1 = xyz[i_frame, i_atom, 1]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             z1 = xyz[i_frame, i_atom, 2]
 * 
 */
                              __pyx_t_15 = __pyx_v_i_frame;
                              __pyx_t_16 = __pyx_v_i_atom;
                              __pyx_t_17 = 1;
                              __pyx_v_y1 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_15 * __pyx_v_xyz.strides[0]) ) + __pyx_t_16 * __pyx_v_xyz.strides[1]) ) + __pyx_t_17 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line197")'> 197:             z1 = xyz[i_frame, i_atom, 2]</pre>
<pre id='line197' class='code' style='background-color: #FFFFff'>
                              /* "lib\structure\cStructure.pyx":197
 *             x1 = xyz[i_frame, i_atom, 0]
 *             y1 = xyz[i_frame, i_atom, 1]
 *             z1 = xyz[i_frame, i_atom, 2]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *             for j_atom in range(i_atom + 1, n_atoms):
 */
                              __pyx_t_18 = __pyx_v_i_frame;
                              __pyx_t_19 = __pyx_v_i_atom;
                              __pyx_t_20 = 2;
                              __pyx_v_z1 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_18 * __pyx_v_xyz.strides[0]) ) + __pyx_t_19 * __pyx_v_xyz.strides[1]) ) + __pyx_t_20 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line198")'> 198: </pre>
<pre id='line198' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line199")'> 199:             for j_atom in range(i_atom + 1, n_atoms):</pre>
<pre id='line199' class='code' style='background-color: #FFFFff'>
                              /* "lib\structure\cStructure.pyx":199
 *             z1 = xyz[i_frame, i_atom, 2]
 * 
 *             for j_atom in range(i_atom + 1, n_atoms):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 x2 = xyz[i_frame, j_atom, 0]
 *                 y2 = xyz[i_frame, j_atom, 1]
 */
                              __pyx_t_21 = __pyx_v_n_atoms;
                              for (__pyx_t_22 = (__pyx_v_i_atom + 1); __pyx_t_22 &lt; __pyx_t_21; __pyx_t_22+=1) {
                                __pyx_v_j_atom = __pyx_t_22;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line200")'> 200:                 x2 = xyz[i_frame, j_atom, 0]</pre>
<pre id='line200' class='code' style='background-color: #FFFFff'>
                                /* "lib\structure\cStructure.pyx":200
 * 
 *             for j_atom in range(i_atom + 1, n_atoms):
 *                 x2 = xyz[i_frame, j_atom, 0]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 y2 = xyz[i_frame, j_atom, 1]
 *                 z2 = xyz[i_frame, j_atom, 2]
 */
                                __pyx_t_23 = __pyx_v_i_frame;
                                __pyx_t_24 = __pyx_v_j_atom;
                                __pyx_t_25 = 0;
                                __pyx_v_x2 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_23 * __pyx_v_xyz.strides[0]) ) + __pyx_t_24 * __pyx_v_xyz.strides[1]) ) + __pyx_t_25 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line201")'> 201:                 y2 = xyz[i_frame, j_atom, 1]</pre>
<pre id='line201' class='code' style='background-color: #FFFFff'>
                                /* "lib\structure\cStructure.pyx":201
 *             for j_atom in range(i_atom + 1, n_atoms):
 *                 x2 = xyz[i_frame, j_atom, 0]
 *                 y2 = xyz[i_frame, j_atom, 1]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 z2 = xyz[i_frame, j_atom, 2]
 * 
 */
                                __pyx_t_26 = __pyx_v_i_frame;
                                __pyx_t_27 = __pyx_v_j_atom;
                                __pyx_t_28 = 1;
                                __pyx_v_y2 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_26 * __pyx_v_xyz.strides[0]) ) + __pyx_t_27 * __pyx_v_xyz.strides[1]) ) + __pyx_t_28 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line202")'> 202:                 z2 = xyz[i_frame, j_atom, 2]</pre>
<pre id='line202' class='code' style='background-color: #FFFFff'>
                                /* "lib\structure\cStructure.pyx":202
 *                 x2 = xyz[i_frame, j_atom, 0]
 *                 y2 = xyz[i_frame, j_atom, 1]
 *                 z2 = xyz[i_frame, j_atom, 2]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *                 distance_sq = (x1-x2)*(x1-x2) + (y1-y2)*(y1-y2) + (z1-z2)*(z1-z2)
 */
                                __pyx_t_29 = __pyx_v_i_frame;
                                __pyx_t_30 = __pyx_v_j_atom;
                                __pyx_t_31 = 2;
                                __pyx_v_z2 = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_29 * __pyx_v_xyz.strides[0]) ) + __pyx_t_30 * __pyx_v_xyz.strides[1]) ) + __pyx_t_31 * __pyx_v_xyz.strides[2]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line203")'> 203: </pre>
<pre id='line203' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line204")'> 204:                 distance_sq = (x1-x2)*(x1-x2) + (y1-y2)*(y1-y2) + (z1-z2)*(z1-z2)</pre>
<pre id='line204' class='code' style='background-color: #FFFFff'>
                                /* "lib\structure\cStructure.pyx":204
 *                 z2 = xyz[i_frame, j_atom, 2]
 * 
 *                 distance_sq = (x1-x2)*(x1-x2) + (y1-y2)*(y1-y2) + (z1-z2)*(z1-z2)             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 re[i_frame] = min(re[i_frame], distance_sq)
 *     return re
 */
                                __pyx_v_distance_sq = ((((__pyx_v_x1 - __pyx_v_x2) * (__pyx_v_x1 - __pyx_v_x2)) + ((__pyx_v_y1 - __pyx_v_y2) * (__pyx_v_y1 - __pyx_v_y2))) + ((__pyx_v_z1 - __pyx_v_z2) * (__pyx_v_z1 - __pyx_v_z2)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line205")'> 205:                 re[i_frame] = min(re[i_frame], distance_sq)</pre>
<pre id='line205' class='code' style='background-color: #FFFFff'>
                                /* "lib\structure\cStructure.pyx":205
 * 
 *                 distance_sq = (x1-x2)*(x1-x2) + (y1-y2)*(y1-y2) + (z1-z2)*(z1-z2)
 *                 re[i_frame] = min(re[i_frame], distance_sq)             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     return re
 * 
 */
                                __pyx_t_32 = __pyx_v_distance_sq;
                                __pyx_t_33 = __pyx_v_i_frame;
                                __pyx_t_34 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_re.rcbuffer-&gt;pybuffer.buf, __pyx_t_33, __pyx_pybuffernd_re.diminfo[0].strides));
                                if (((__pyx_t_32 &lt; __pyx_t_34) != 0)) {
                                  __pyx_t_35 = __pyx_t_32;
                                } else {
                                  __pyx_t_35 = __pyx_t_34;
                                }
                                __pyx_t_36 = __pyx_v_i_frame;
                                *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_re.rcbuffer-&gt;pybuffer.buf, __pyx_t_36, __pyx_pybuffernd_re.diminfo[0].strides) = __pyx_t_35;
                              }
                            }
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line206")'> 206:     return re</pre>
<pre id='line206' class='code' style='background-color: #FFFFd4'>
  /* "lib\structure\cStructure.pyx":206
 *                 distance_sq = (x1-x2)*(x1-x2) + (y1-y2)*(y1-y2) + (z1-z2)*(z1-z2)
 *                 re[i_frame] = min(re[i_frame], distance_sq)
 *     return re             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_re));
  __pyx_r = ((PyObject *)__pyx_v_re);
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line207")'> 207: </pre>
<pre id='line207' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line208")'> 208: </pre>
<pre id='line208' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line209")'> 209: @cython.wraparound(False)</pre>
<pre id='line209' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line210")'> 210: @cython.boundscheck(False)</pre>
<pre id='line210' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF25' onclick='toggleDiv("line211")'> 211: def rotate(float[:,:,:] xyz, float[:,:] rm):</pre>
<pre id='line211' class='code' style='background-color: #FFFF25'>
/* "lib\structure\cStructure.pyx":211
 * @cython.wraparound(False)
 * @cython.boundscheck(False)
 * def rotate(float[:,:,:] xyz, float[:,:] rm):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     """ Rotates a trajectory (frame, atom, coord)
 * 
 */

/* Python wrapper */
static PyObject *__pyx_pw_3lib_9structure_10cStructure_7rotate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3lib_9structure_10cStructure_6rotate[] = " Rotates a trajectory (frame, atom, coord)\n\n    :param xyz: numpy array\n        The coordinates (frame nbr, atom nbr, coord)\n\n    :param rm: numpy array 3x3 dtpye np.float32 - the rotation matrix\n    :return:\n\n    Examples\n    --------\n\n    &gt;&gt;&gt; from lib.structure.trajectory import TrajectoryFile\n    &gt;&gt;&gt; from lib.structure.cStructure import rotate\n    &gt;&gt;&gt; import numpy as np\n    &gt;&gt;&gt; traj = TrajectoryFile('stride_100.h5')\n    &gt;&gt;&gt; xyz = traj.xyz\n    &gt;&gt;&gt; b = np.array([[-0.856274009, 0.513258278, -0.057972118], [0.513934493, 0.835381866, -0.194957629], [-0.051634759, -0.196731016, -0.979096889]], dtype=np.float32)\n    &gt;&gt;&gt; rotate(xyz, b)\n\n    ";
static PyMethodDef __pyx_mdef_3lib_9structure_10cStructure_7rotate = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("rotate"), (PyCFunction)__pyx_pw_3lib_9structure_10cStructure_7rotate, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(__pyx_doc_3lib_9structure_10cStructure_6rotate)};
static PyObject *__pyx_pw_3lib_9structure_10cStructure_7rotate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_xyz = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_rm = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rotate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_xyz,&amp;__pyx_n_s_rm,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_xyz)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_rm)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rotate", 1, 2, 2, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "rotate") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_xyz = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(values[0]);<span class='error_goto'> if (unlikely(!__pyx_v_xyz.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_rm = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(values[1]);<span class='error_goto'> if (unlikely(!__pyx_v_rm.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rotate", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.cStructure.rotate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3lib_9structure_10cStructure_6rotate(__pyx_self, __pyx_v_xyz, __pyx_v_rm);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3lib_9structure_10cStructure_6rotate(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_xyz, __Pyx_memviewslice __pyx_v_rm) {
  int __pyx_v_i_frame;
  int __pyx_v_i_atom;
  int __pyx_v_n_frames;
  int __pyx_v_n_atoms;
  float __pyx_v_t1;
  float __pyx_v_t2;
  float __pyx_v_t3;
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_y = 0;
  PyObject *__pyx_v_z = 0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rotate", 0);

  /* "lib\structure\cStructure.pyx":211
 * @cython.wraparound(False)
 * @cython.boundscheck(False)
 * def rotate(float[:,:,:] xyz, float[:,:] rm):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     """ Rotates a trajectory (frame, atom, coord)
 * 
 */

  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.cStructure.rotate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_z);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xyz, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_rm, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

  /* "lib\structure\cStructure.pyx":211
 * @cython.wraparound(False)
 * @cython.boundscheck(False)
 * def rotate(float[:,:,:] xyz, float[:,:] rm):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     """ Rotates a trajectory (frame, atom, coord)
 * 
 */
  __pyx_tuple__28 = <span class='py_c_api'>PyTuple_Pack</span>(14, __pyx_n_s_xyz, __pyx_n_s_rm, __pyx_n_s_i_frame, __pyx_n_s_i_atom, __pyx_n_s_n_frames, __pyx_n_s_n_atoms, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_t1, __pyx_n_s_t2, __pyx_n_s_t3, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_z);<span class='error_goto'> if (unlikely(!__pyx_tuple__28)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__28);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__28);

  /* "lib\structure\cStructure.pyx":211
 * @cython.wraparound(False)
 * @cython.boundscheck(False)
 * def rotate(float[:,:,:] xyz, float[:,:] rm):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     """ Rotates a trajectory (frame, atom, coord)
 * 
 */
  __pyx_t_4 = PyCFunction_NewEx(&amp;__pyx_mdef_3lib_9structure_10cStructure_7rotate, NULL, __pyx_n_s_lib_structure_cStructure);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_rotate, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__29 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 14, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__28, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_F_devel_lib_structure_cStructure, __pyx_n_s_rotate, 211, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__29)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line212")'> 212:     """ Rotates a trajectory (frame, atom, coord)</pre>
<pre id='line212' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line213")'> 213: </pre>
<pre id='line213' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line214")'> 214:     :param xyz: numpy array</pre>
<pre id='line214' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line215")'> 215:         The coordinates (frame nbr, atom nbr, coord)</pre>
<pre id='line215' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line216")'> 216: </pre>
<pre id='line216' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line217")'> 217:     :param rm: numpy array 3x3 dtpye np.float32 - the rotation matrix</pre>
<pre id='line217' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line218")'> 218:     :return:</pre>
<pre id='line218' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line219")'> 219: </pre>
<pre id='line219' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line220")'> 220:     Examples</pre>
<pre id='line220' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line221")'> 221:     --------</pre>
<pre id='line221' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line222")'> 222: </pre>
<pre id='line222' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line223")'> 223:     &gt;&gt;&gt; from lib.structure.trajectory import TrajectoryFile</pre>
<pre id='line223' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line224")'> 224:     &gt;&gt;&gt; from lib.structure.cStructure import rotate</pre>
<pre id='line224' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line225")'> 225:     &gt;&gt;&gt; import numpy as np</pre>
<pre id='line225' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line226")'> 226:     &gt;&gt;&gt; traj = TrajectoryFile('stride_100.h5')</pre>
<pre id='line226' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line227")'> 227:     &gt;&gt;&gt; xyz = traj.xyz</pre>
<pre id='line227' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line228")'> 228:     &gt;&gt;&gt; b = np.array([[-0.856274009, 0.513258278, -0.057972118], [0.513934493, 0.835381866, -0.194957629], [-0.051634759, -0.196731016, -0.979096889]], dtype=np.float32)</pre>
<pre id='line228' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line229")'> 229:     &gt;&gt;&gt; rotate(xyz, b)</pre>
<pre id='line229' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line230")'> 230: </pre>
<pre id='line230' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line231")'> 231:     """</pre>
<pre id='line231' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line232")'> 232:     cdef int i_frame, i_atom</pre>
<pre id='line232' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line233")'> 233:     cdef int n_frames, n_atoms</pre>
<pre id='line233' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line234")'> 234:     cdef int i, j</pre>
<pre id='line234' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line235")'> 235:     cdef float t1, t2, t3</pre>
<pre id='line235' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line236")'> 236:     cdef x, y, z</pre>
<pre id='line236' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line237")'> 237: </pre>
<pre id='line237' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line238")'> 238:     n_frames = xyz.shape[0]</pre>
<pre id='line238' class='code' style='background-color: #FFFFff'>
  /* "lib\structure\cStructure.pyx":238
 *     cdef x, y, z
 * 
 *     n_frames = xyz.shape[0]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     n_atoms = xyz.shape[1]
 *     for i_frame in range(n_frames):
 */
  __pyx_v_n_frames = (__pyx_v_xyz.shape[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line239")'> 239:     n_atoms = xyz.shape[1]</pre>
<pre id='line239' class='code' style='background-color: #FFFFff'>
  /* "lib\structure\cStructure.pyx":239
 * 
 *     n_frames = xyz.shape[0]
 *     n_atoms = xyz.shape[1]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     for i_frame in range(n_frames):
 *         for i_atom in range(n_atoms):
 */
  __pyx_v_n_atoms = (__pyx_v_xyz.shape[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line240")'> 240:     for i_frame in range(n_frames):</pre>
<pre id='line240' class='code' style='background-color: #FFFFff'>
  /* "lib\structure\cStructure.pyx":240
 *     n_frames = xyz.shape[0]
 *     n_atoms = xyz.shape[1]
 *     for i_frame in range(n_frames):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         for i_atom in range(n_atoms):
 *             # matrix vector product
 */
  __pyx_t_1 = __pyx_v_n_frames;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i_frame = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line241")'> 241:         for i_atom in range(n_atoms):</pre>
<pre id='line241' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":241
 *     n_atoms = xyz.shape[1]
 *     for i_frame in range(n_frames):
 *         for i_atom in range(n_atoms):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             # matrix vector product
 *             x = xyz[i_frame, i_atom, 0]
 */
    __pyx_t_3 = __pyx_v_n_atoms;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_i_atom = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line242")'> 242:             # matrix vector product</pre>
<pre id='line242' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line243")'> 243:             x = xyz[i_frame, i_atom, 0]</pre>
<pre id='line243' class='code' style='background-color: #FFFF9f'>
      /* "lib\structure\cStructure.pyx":243
 *         for i_atom in range(n_atoms):
 *             # matrix vector product
 *             x = xyz[i_frame, i_atom, 0]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             y = xyz[i_frame, i_atom, 1]
 *             z = xyz[i_frame, i_atom, 2]
 */
      __pyx_t_5 = __pyx_v_i_frame;
      __pyx_t_6 = __pyx_v_i_atom;
      __pyx_t_7 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_5 * __pyx_v_xyz.strides[0]) ) + __pyx_t_6 * __pyx_v_xyz.strides[1]) ) + __pyx_t_7 * __pyx_v_xyz.strides[2]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_x, __pyx_t_8);
      __pyx_t_8 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line244")'> 244:             y = xyz[i_frame, i_atom, 1]</pre>
<pre id='line244' class='code' style='background-color: #FFFF9f'>
      /* "lib\structure\cStructure.pyx":244
 *             # matrix vector product
 *             x = xyz[i_frame, i_atom, 0]
 *             y = xyz[i_frame, i_atom, 1]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             z = xyz[i_frame, i_atom, 2]
 * 
 */
      __pyx_t_9 = __pyx_v_i_frame;
      __pyx_t_10 = __pyx_v_i_atom;
      __pyx_t_11 = 1;
      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_9 * __pyx_v_xyz.strides[0]) ) + __pyx_t_10 * __pyx_v_xyz.strides[1]) ) + __pyx_t_11 * __pyx_v_xyz.strides[2]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_y, __pyx_t_8);
      __pyx_t_8 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line245")'> 245:             z = xyz[i_frame, i_atom, 2]</pre>
<pre id='line245' class='code' style='background-color: #FFFF9f'>
      /* "lib\structure\cStructure.pyx":245
 *             x = xyz[i_frame, i_atom, 0]
 *             y = xyz[i_frame, i_atom, 1]
 *             z = xyz[i_frame, i_atom, 2]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *             t1 = rm[0, 0] * x + rm[0, 1] * y + rm[0, 2] * z
 */
      __pyx_t_12 = __pyx_v_i_frame;
      __pyx_t_13 = __pyx_v_i_atom;
      __pyx_t_14 = 2;
      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_12 * __pyx_v_xyz.strides[0]) ) + __pyx_t_13 * __pyx_v_xyz.strides[1]) ) + __pyx_t_14 * __pyx_v_xyz.strides[2]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_z, __pyx_t_8);
      __pyx_t_8 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line246")'> 246: </pre>
<pre id='line246' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF28' onclick='toggleDiv("line247")'> 247:             t1 = rm[0, 0] * x + rm[0, 1] * y + rm[0, 2] * z</pre>
<pre id='line247' class='code' style='background-color: #FFFF28'>
      /* "lib\structure\cStructure.pyx":247
 *             z = xyz[i_frame, i_atom, 2]
 * 
 *             t1 = rm[0, 0] * x + rm[0, 1] * y + rm[0, 2] * z             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             t2 = rm[1, 0] * x + rm[1, 1] * y + rm[1, 2] * z
 *             t3 = rm[2, 0] * x + rm[2, 1] * y + rm[2, 2] * z
 */
      __pyx_t_15 = 0;
      __pyx_t_16 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rm.data + __pyx_t_15 * __pyx_v_rm.strides[0]) ) + __pyx_t_16 * __pyx_v_rm.strides[1]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_17 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_8, __pyx_v_x);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_18 = 0;
      __pyx_t_19 = 1;
      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rm.data + __pyx_t_18 * __pyx_v_rm.strides[0]) ) + __pyx_t_19 * __pyx_v_rm.strides[1]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_20 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_8, __pyx_v_y);<span class='error_goto'> if (unlikely(!__pyx_t_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_17, __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      __pyx_t_21 = 0;
      __pyx_t_22 = 2;
      __pyx_t_20 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rm.data + __pyx_t_21 * __pyx_v_rm.strides[0]) ) + __pyx_t_22 * __pyx_v_rm.strides[1]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      __pyx_t_17 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_20, __pyx_v_z);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      __pyx_t_20 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_8, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
      __pyx_t_23 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_20);<span class='error_goto'> if (unlikely((__pyx_t_23 == (float)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      __pyx_v_t1 = __pyx_t_23;
</pre><pre class='line' style='background-color: #FFFF28' onclick='toggleDiv("line248")'> 248:             t2 = rm[1, 0] * x + rm[1, 1] * y + rm[1, 2] * z</pre>
<pre id='line248' class='code' style='background-color: #FFFF28'>
      /* "lib\structure\cStructure.pyx":248
 * 
 *             t1 = rm[0, 0] * x + rm[0, 1] * y + rm[0, 2] * z
 *             t2 = rm[1, 0] * x + rm[1, 1] * y + rm[1, 2] * z             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             t3 = rm[2, 0] * x + rm[2, 1] * y + rm[2, 2] * z
 * 
 */
      __pyx_t_24 = 1;
      __pyx_t_25 = 0;
      __pyx_t_20 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rm.data + __pyx_t_24 * __pyx_v_rm.strides[0]) ) + __pyx_t_25 * __pyx_v_rm.strides[1]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      __pyx_t_17 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_20, __pyx_v_x);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      __pyx_t_26 = 1;
      __pyx_t_27 = 1;
      __pyx_t_20 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rm.data + __pyx_t_26 * __pyx_v_rm.strides[0]) ) + __pyx_t_27 * __pyx_v_rm.strides[1]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_20, __pyx_v_y);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      __pyx_t_20 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_17, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_28 = 1;
      __pyx_t_29 = 2;
      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rm.data + __pyx_t_28 * __pyx_v_rm.strides[0]) ) + __pyx_t_29 * __pyx_v_rm.strides[1]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_17 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_8, __pyx_v_z);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_20, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
      __pyx_t_23 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_23 == (float)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_v_t2 = __pyx_t_23;
</pre><pre class='line' style='background-color: #FFFF28' onclick='toggleDiv("line249")'> 249:             t3 = rm[2, 0] * x + rm[2, 1] * y + rm[2, 2] * z</pre>
<pre id='line249' class='code' style='background-color: #FFFF28'>
      /* "lib\structure\cStructure.pyx":249
 *             t1 = rm[0, 0] * x + rm[0, 1] * y + rm[0, 2] * z
 *             t2 = rm[1, 0] * x + rm[1, 1] * y + rm[1, 2] * z
 *             t3 = rm[2, 0] * x + rm[2, 1] * y + rm[2, 2] * z             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *             xyz[i_frame, i_atom, 0] = t1
 */
      __pyx_t_30 = 2;
      __pyx_t_31 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rm.data + __pyx_t_30 * __pyx_v_rm.strides[0]) ) + __pyx_t_31 * __pyx_v_rm.strides[1]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_17 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_8, __pyx_v_x);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_32 = 2;
      __pyx_t_33 = 1;
      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rm.data + __pyx_t_32 * __pyx_v_rm.strides[0]) ) + __pyx_t_33 * __pyx_v_rm.strides[1]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_20 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_8, __pyx_v_y);<span class='error_goto'> if (unlikely(!__pyx_t_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_17, __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      __pyx_t_34 = 2;
      __pyx_t_35 = 2;
      __pyx_t_20 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rm.data + __pyx_t_34 * __pyx_v_rm.strides[0]) ) + __pyx_t_35 * __pyx_v_rm.strides[1]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      __pyx_t_17 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_20, __pyx_v_z);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      __pyx_t_20 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_8, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
      __pyx_t_23 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_20);<span class='error_goto'> if (unlikely((__pyx_t_23 == (float)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      __pyx_v_t3 = __pyx_t_23;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line250")'> 250: </pre>
<pre id='line250' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line251")'> 251:             xyz[i_frame, i_atom, 0] = t1</pre>
<pre id='line251' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":251
 *             t3 = rm[2, 0] * x + rm[2, 1] * y + rm[2, 2] * z
 * 
 *             xyz[i_frame, i_atom, 0] = t1             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             xyz[i_frame, i_atom, 1] = t2
 *             xyz[i_frame, i_atom, 2] = t3
 */
      __pyx_t_36 = __pyx_v_i_frame;
      __pyx_t_37 = __pyx_v_i_atom;
      __pyx_t_38 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_36 * __pyx_v_xyz.strides[0]) ) + __pyx_t_37 * __pyx_v_xyz.strides[1]) ) + __pyx_t_38 * __pyx_v_xyz.strides[2]) )) = __pyx_v_t1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line252")'> 252:             xyz[i_frame, i_atom, 1] = t2</pre>
<pre id='line252' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":252
 * 
 *             xyz[i_frame, i_atom, 0] = t1
 *             xyz[i_frame, i_atom, 1] = t2             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             xyz[i_frame, i_atom, 2] = t3
 * 
 */
      __pyx_t_39 = __pyx_v_i_frame;
      __pyx_t_40 = __pyx_v_i_atom;
      __pyx_t_41 = 1;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_39 * __pyx_v_xyz.strides[0]) ) + __pyx_t_40 * __pyx_v_xyz.strides[1]) ) + __pyx_t_41 * __pyx_v_xyz.strides[2]) )) = __pyx_v_t2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line253")'> 253:             xyz[i_frame, i_atom, 2] = t3</pre>
<pre id='line253' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":253
 *             xyz[i_frame, i_atom, 0] = t1
 *             xyz[i_frame, i_atom, 1] = t2
 *             xyz[i_frame, i_atom, 2] = t3             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 * 
 */
      __pyx_t_42 = __pyx_v_i_frame;
      __pyx_t_43 = __pyx_v_i_atom;
      __pyx_t_44 = 2;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_42 * __pyx_v_xyz.strides[0]) ) + __pyx_t_43 * __pyx_v_xyz.strides[1]) ) + __pyx_t_44 * __pyx_v_xyz.strides[2]) )) = __pyx_v_t3;
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line254")'> 254: </pre>
<pre id='line254' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line255")'> 255: </pre>
<pre id='line255' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line256")'> 256: </pre>
<pre id='line256' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line257")'> 257: @cython.wraparound(False)</pre>
<pre id='line257' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line258")'> 258: @cython.boundscheck(False)</pre>
<pre id='line258' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line259")'> 259: def translate(np.ndarray[ndim=3, dtype=np.float32_t] xyz, np.ndarray[ndim=1, dtype=np.float32_t] vector):</pre>
<pre id='line259' class='code' style='background-color: #FFFF20'>
/* "lib\structure\cStructure.pyx":259
 * @cython.wraparound(False)
 * @cython.boundscheck(False)
 * def translate(np.ndarray[ndim=3, dtype=np.float32_t] xyz, np.ndarray[ndim=1, dtype=np.float32_t] vector):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     """ Translate a trajectory by an vector
 * 
 */

/* Python wrapper */
static PyObject *__pyx_pw_3lib_9structure_10cStructure_9translate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3lib_9structure_10cStructure_8translate[] = " Translate a trajectory by an vector\n\n    :param xyz: numpy array\n        (frame nbr, atom_number, coord)\n    :param vector:\n    :return:\n    ";
static PyMethodDef __pyx_mdef_3lib_9structure_10cStructure_9translate = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("translate"), (PyCFunction)__pyx_pw_3lib_9structure_10cStructure_9translate, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(__pyx_doc_3lib_9structure_10cStructure_8translate)};
static PyObject *__pyx_pw_3lib_9structure_10cStructure_9translate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_xyz = 0;
  PyArrayObject *__pyx_v_vector = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("translate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_xyz,&amp;__pyx_n_s_vector,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_xyz)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vector)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("translate", 1, 2, 2, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "translate") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_xyz = ((PyArrayObject *)values[0]);
    __pyx_v_vector = ((PyArrayObject *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("translate", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.cStructure.translate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_xyz), __pyx_ptype_5numpy_ndarray, 1, "xyz", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vector), __pyx_ptype_5numpy_ndarray, 1, "vector", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_3lib_9structure_10cStructure_8translate(__pyx_self, __pyx_v_xyz, __pyx_v_vector);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3lib_9structure_10cStructure_8translate(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_xyz, PyArrayObject *__pyx_v_vector) {
  int __pyx_v_i_frame;
  int __pyx_v_i_atom;
  int __pyx_v_i_dim;
  int __pyx_v_n_frames;
  int __pyx_v_n_atoms;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vector;
  __Pyx_Buffer __pyx_pybuffer_vector;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_xyz;
  __Pyx_Buffer __pyx_pybuffer_xyz;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("translate", 0);
  __pyx_pybuffer_xyz.pybuffer.buf = NULL;
  __pyx_pybuffer_xyz.refcount = 0;
  __pyx_pybuffernd_xyz.data = NULL;
  __pyx_pybuffernd_xyz.rcbuffer = &amp;__pyx_pybuffer_xyz;
  __pyx_pybuffer_vector.pybuffer.buf = NULL;
  __pyx_pybuffer_vector.refcount = 0;
  __pyx_pybuffernd_vector.data = NULL;
  __pyx_pybuffernd_vector.rcbuffer = &amp;__pyx_pybuffer_vector;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_xyz.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_xyz, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 3, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_xyz.diminfo[0].strides = __pyx_pybuffernd_xyz.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_xyz.diminfo[0].shape = __pyx_pybuffernd_xyz.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_xyz.diminfo[1].strides = __pyx_pybuffernd_xyz.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_xyz.diminfo[1].shape = __pyx_pybuffernd_xyz.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_xyz.diminfo[2].strides = __pyx_pybuffernd_xyz.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_xyz.diminfo[2].shape = __pyx_pybuffernd_xyz.rcbuffer-&gt;pybuffer.shape[2];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vector.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vector, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_vector.diminfo[0].strides = __pyx_pybuffernd_vector.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vector.diminfo[0].shape = __pyx_pybuffernd_vector.rcbuffer-&gt;pybuffer.shape[0];

  /* "lib\structure\cStructure.pyx":259
 * @cython.wraparound(False)
 * @cython.boundscheck(False)
 * def translate(np.ndarray[ndim=3, dtype=np.float32_t] xyz, np.ndarray[ndim=1, dtype=np.float32_t] vector):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     """ Translate a trajectory by an vector
 * 
 */

  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vector.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_xyz.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.cStructure.translate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vector.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_xyz.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

  /* "lib\structure\cStructure.pyx":259
 * @cython.wraparound(False)
 * @cython.boundscheck(False)
 * def translate(np.ndarray[ndim=3, dtype=np.float32_t] xyz, np.ndarray[ndim=1, dtype=np.float32_t] vector):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     """ Translate a trajectory by an vector
 * 
 */
  __pyx_tuple__30 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_xyz, __pyx_n_s_vector, __pyx_n_s_i_frame, __pyx_n_s_i_atom, __pyx_n_s_i_dim, __pyx_n_s_n_frames, __pyx_n_s_n_atoms, __pyx_n_s_n_dim);<span class='error_goto'> if (unlikely(!__pyx_tuple__30)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__30);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__30);

  /* "lib\structure\cStructure.pyx":259
 * @cython.wraparound(False)
 * @cython.boundscheck(False)
 * def translate(np.ndarray[ndim=3, dtype=np.float32_t] xyz, np.ndarray[ndim=1, dtype=np.float32_t] vector):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     """ Translate a trajectory by an vector
 * 
 */
  __pyx_t_4 = PyCFunction_NewEx(&amp;__pyx_mdef_3lib_9structure_10cStructure_9translate, NULL, __pyx_n_s_lib_structure_cStructure);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_translate, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__31 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__30, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_F_devel_lib_structure_cStructure, __pyx_n_s_translate, 259, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__31)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line260")'> 260:     """ Translate a trajectory by an vector</pre>
<pre id='line260' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line261")'> 261: </pre>
<pre id='line261' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line262")'> 262:     :param xyz: numpy array</pre>
<pre id='line262' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line263")'> 263:         (frame nbr, atom_number, coord)</pre>
<pre id='line263' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line264")'> 264:     :param vector:</pre>
<pre id='line264' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line265")'> 265:     :return:</pre>
<pre id='line265' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line266")'> 266:     """</pre>
<pre id='line266' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line267")'> 267:     cdef int i_frame, i_atom, i_dim</pre>
<pre id='line267' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line268")'> 268:     cdef int n_frames, n_atoms, n_dim</pre>
<pre id='line268' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line269")'> 269:     n_frames = xyz.shape[0]</pre>
<pre id='line269' class='code' style='background-color: #FFFFff'>
  /* "lib\structure\cStructure.pyx":269
 *     cdef int i_frame, i_atom, i_dim
 *     cdef int n_frames, n_atoms, n_dim
 *     n_frames = xyz.shape[0]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     n_atoms = xyz.shape[1]
 * 
 */
  __pyx_v_n_frames = (__pyx_v_xyz-&gt;dimensions[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line270")'> 270:     n_atoms = xyz.shape[1]</pre>
<pre id='line270' class='code' style='background-color: #FFFFff'>
  /* "lib\structure\cStructure.pyx":270
 *     cdef int n_frames, n_atoms, n_dim
 *     n_frames = xyz.shape[0]
 *     n_atoms = xyz.shape[1]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *     for i_frame in range(n_frames):
 */
  __pyx_v_n_atoms = (__pyx_v_xyz-&gt;dimensions[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line271")'> 271: </pre>
<pre id='line271' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line272")'> 272:     for i_frame in range(n_frames):</pre>
<pre id='line272' class='code' style='background-color: #FFFFff'>
  /* "lib\structure\cStructure.pyx":272
 *     n_atoms = xyz.shape[1]
 * 
 *     for i_frame in range(n_frames):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         for i_atom in range(n_atoms):
 *             for i_dim in range(3):
 */
  __pyx_t_1 = __pyx_v_n_frames;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i_frame = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line273")'> 273:         for i_atom in range(n_atoms):</pre>
<pre id='line273' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":273
 * 
 *     for i_frame in range(n_frames):
 *         for i_atom in range(n_atoms):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             for i_dim in range(3):
 *                 xyz[i_frame, i_atom, i_dim] += vector[i_dim]
 */
    __pyx_t_3 = __pyx_v_n_atoms;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_i_atom = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line274")'> 274:             for i_dim in range(3):</pre>
<pre id='line274' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":274
 *     for i_frame in range(n_frames):
 *         for i_atom in range(n_atoms):
 *             for i_dim in range(3):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 xyz[i_frame, i_atom, i_dim] += vector[i_dim]
 * 
 */
      for (__pyx_t_5 = 0; __pyx_t_5 &lt; 3; __pyx_t_5+=1) {
        __pyx_v_i_dim = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line275")'> 275:                 xyz[i_frame, i_atom, i_dim] += vector[i_dim]</pre>
<pre id='line275' class='code' style='background-color: #FFFFff'>
        /* "lib\structure\cStructure.pyx":275
 *         for i_atom in range(n_atoms):
 *             for i_dim in range(3):
 *                 xyz[i_frame, i_atom, i_dim] += vector[i_dim]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 * 
 */
        __pyx_t_6 = __pyx_v_i_dim;
        __pyx_t_7 = __pyx_v_i_frame;
        __pyx_t_8 = __pyx_v_i_atom;
        __pyx_t_9 = __pyx_v_i_dim;
        *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_xyz.rcbuffer-&gt;pybuffer.buf, __pyx_t_7, __pyx_pybuffernd_xyz.diminfo[0].strides, __pyx_t_8, __pyx_pybuffernd_xyz.diminfo[1].strides, __pyx_t_9, __pyx_pybuffernd_xyz.diminfo[2].strides) += (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_vector.rcbuffer-&gt;pybuffer.buf, __pyx_t_6, __pyx_pybuffernd_vector.diminfo[0].strides));
      }
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line276")'> 276: </pre>
<pre id='line276' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line277")'> 277: </pre>
<pre id='line277' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line278")'> 278: @cython.boundscheck(False)</pre>
<pre id='line278' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF1e' onclick='toggleDiv("line279")'> 279: def atom_dist(double[:, :] aDist, int[:, :] resLookUp, double[:, :] xyz, int aID):</pre>
<pre id='line279' class='code' style='background-color: #FFFF1e'>
/* "lib\structure\cStructure.pyx":279
 * 
 * @cython.boundscheck(False)
 * def atom_dist(double[:, :] aDist, int[:, :] resLookUp, double[:, :] xyz, int aID):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     cdef double d12, a1, a2, a3, b1, b2, b3
 *     cdef int n_residues, i, j, ia1, ia2
 */

/* Python wrapper */
static PyObject *__pyx_pw_3lib_9structure_10cStructure_11atom_dist(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_3lib_9structure_10cStructure_11atom_dist = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("atom_dist"), (PyCFunction)__pyx_pw_3lib_9structure_10cStructure_11atom_dist, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_3lib_9structure_10cStructure_11atom_dist(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_aDist = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_resLookUp = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_xyz = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_aID;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("atom_dist (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_aDist,&amp;__pyx_n_s_resLookUp,&amp;__pyx_n_s_xyz,&amp;__pyx_n_s_aID,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_aDist)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_resLookUp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("atom_dist", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_xyz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("atom_dist", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_aID)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("atom_dist", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "atom_dist") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_aDist = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[0]);<span class='error_goto'> if (unlikely(!__pyx_v_aDist.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_resLookUp = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[1]);<span class='error_goto'> if (unlikely(!__pyx_v_resLookUp.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_xyz = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[2]);<span class='error_goto'> if (unlikely(!__pyx_v_xyz.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_aID = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_aID == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("atom_dist", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.cStructure.atom_dist", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3lib_9structure_10cStructure_10atom_dist(__pyx_self, __pyx_v_aDist, __pyx_v_resLookUp, __pyx_v_xyz, __pyx_v_aID);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3lib_9structure_10cStructure_10atom_dist(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_aDist, __Pyx_memviewslice __pyx_v_resLookUp, __Pyx_memviewslice __pyx_v_xyz, int __pyx_v_aID) {
  double __pyx_v_d12;
  double __pyx_v_a1;
  double __pyx_v_a2;
  double __pyx_v_a3;
  double __pyx_v_b1;
  double __pyx_v_b2;
  double __pyx_v_b3;
  int __pyx_v_n_residues;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_ia1;
  int __pyx_v_ia2;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("atom_dist", 0);

  /* "lib\structure\cStructure.pyx":279
 * 
 * @cython.boundscheck(False)
 * def atom_dist(double[:, :] aDist, int[:, :] resLookUp, double[:, :] xyz, int aID):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     cdef double d12, a1, a2, a3, b1, b2, b3
 *     cdef int n_residues, i, j, ia1, ia2
 */

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_27);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.cStructure.atom_dist", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_aDist, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_resLookUp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xyz, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

  /* "lib\structure\cStructure.pyx":279
 * 
 * @cython.boundscheck(False)
 * def atom_dist(double[:, :] aDist, int[:, :] resLookUp, double[:, :] xyz, int aID):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     cdef double d12, a1, a2, a3, b1, b2, b3
 *     cdef int n_residues, i, j, ia1, ia2
 */
  __pyx_tuple__32 = <span class='py_c_api'>PyTuple_Pack</span>(16, __pyx_n_s_aDist, __pyx_n_s_resLookUp, __pyx_n_s_xyz, __pyx_n_s_aID, __pyx_n_s_d12, __pyx_n_s_a1, __pyx_n_s_a2, __pyx_n_s_a3, __pyx_n_s_b1, __pyx_n_s_b2, __pyx_n_s_b3, __pyx_n_s_n_residues, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_ia1, __pyx_n_s_ia2);<span class='error_goto'> if (unlikely(!__pyx_tuple__32)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__32);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__32);

  /* "lib\structure\cStructure.pyx":279
 * 
 * @cython.boundscheck(False)
 * def atom_dist(double[:, :] aDist, int[:, :] resLookUp, double[:, :] xyz, int aID):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     cdef double d12, a1, a2, a3, b1, b2, b3
 *     cdef int n_residues, i, j, ia1, ia2
 */
  __pyx_t_4 = PyCFunction_NewEx(&amp;__pyx_mdef_3lib_9structure_10cStructure_11atom_dist, NULL, __pyx_n_s_lib_structure_cStructure);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_atom_dist, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__33 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 16, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__32, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_F_devel_lib_structure_cStructure, __pyx_n_s_atom_dist, 279, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line280")'> 280:     cdef double d12, a1, a2, a3, b1, b2, b3</pre>
<pre id='line280' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line281")'> 281:     cdef int n_residues, i, j, ia1, ia2</pre>
<pre id='line281' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line282")'> 282:     n_residues = resLookUp.shape[0]</pre>
<pre id='line282' class='code' style='background-color: #FFFFff'>
  /* "lib\structure\cStructure.pyx":282
 *     cdef double d12, a1, a2, a3, b1, b2, b3
 *     cdef int n_residues, i, j, ia1, ia2
 *     n_residues = resLookUp.shape[0]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     for i in prange(n_residues, nogil=True):
 *         ia1 = resLookUp[i, aID]
 */
  __pyx_v_n_residues = (__pyx_v_resLookUp.shape[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line283")'> 283:     for i in prange(n_residues, nogil=True):</pre>
<pre id='line283' class='code' style='background-color: #FFFFff'>
  /* "lib\structure\cStructure.pyx":283
 *     cdef int n_residues, i, j, ia1, ia2
 *     n_residues = resLookUp.shape[0]
 *     for i in prange(n_residues, nogil=True):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         ia1 = resLookUp[i, aID]
 *         if ia1 &lt; 0:
 */
  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_n_residues;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_ia2) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_b3) lastprivate(__pyx_v_a1) lastprivate(__pyx_v_ia1) lastprivate(__pyx_v_b2) lastprivate(__pyx_v_b1) lastprivate(__pyx_v_a3) lastprivate(__pyx_v_a2) lastprivate(__pyx_v_d12) lastprivate(__pyx_v_j)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_i = 0 + 1 * __pyx_t_2;
                            /* Initialize private variables to invalid values */
                            __pyx_v_ia2 = ((int)0xbad0bad0);
                            __pyx_v_b3 = ((double)__PYX_NAN());
                            __pyx_v_a1 = ((double)__PYX_NAN());
                            __pyx_v_ia1 = ((int)0xbad0bad0);
                            __pyx_v_b2 = ((double)__PYX_NAN());
                            __pyx_v_b1 = ((double)__PYX_NAN());
                            __pyx_v_a3 = ((double)__PYX_NAN());
                            __pyx_v_a2 = ((double)__PYX_NAN());
                            __pyx_v_d12 = ((double)__PYX_NAN());
                            __pyx_v_j = ((int)0xbad0bad0);

      /* "lib\structure\cStructure.pyx":283
 *     cdef int n_residues, i, j, ia1, ia2
 *     n_residues = resLookUp.shape[0]
 *     for i in prange(n_residues, nogil=True):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         ia1 = resLookUp[i, aID]
 *         if ia1 &lt; 0:
 */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line284")'> 284:         ia1 = resLookUp[i, aID]</pre>
<pre id='line284' class='code' style='background-color: #FFFFff'>
                            /* "lib\structure\cStructure.pyx":284
 *     n_residues = resLookUp.shape[0]
 *     for i in prange(n_residues, nogil=True):
 *         ia1 = resLookUp[i, aID]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         if ia1 &lt; 0:
 *             continue
 */
                            __pyx_t_4 = __pyx_v_i;
                            __pyx_t_5 = __pyx_v_aID;
                            if (__pyx_t_4 &lt; 0) __pyx_t_4 += __pyx_v_resLookUp.shape[0];
                            if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_v_resLookUp.shape[1];
                            __pyx_v_ia1 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_4 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_5 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line285")'> 285:         if ia1 &lt; 0:</pre>
<pre id='line285' class='code' style='background-color: #FFFFff'>
                            /* "lib\structure\cStructure.pyx":285
 *     for i in prange(n_residues, nogil=True):
 *         ia1 = resLookUp[i, aID]
 *         if ia1 &lt; 0:             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             continue
 *         a1 = xyz[ia1, 0]
 */
                            __pyx_t_6 = ((__pyx_v_ia1 &lt; 0) != 0);
                            if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line286")'> 286:             continue</pre>
<pre id='line286' class='code' style='background-color: #FFFFff'>
                              /* "lib\structure\cStructure.pyx":286
 *         ia1 = resLookUp[i, aID]
 *         if ia1 &lt; 0:
 *             continue             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         a1 = xyz[ia1, 0]
 *         a2 = xyz[ia1, 1]
 */
                              goto __pyx_L6_continue;
                            }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line287")'> 287:         a1 = xyz[ia1, 0]</pre>
<pre id='line287' class='code' style='background-color: #FFFFff'>
                            /* "lib\structure\cStructure.pyx":287
 *         if ia1 &lt; 0:
 *             continue
 *         a1 = xyz[ia1, 0]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         a2 = xyz[ia1, 1]
 *         a3 = xyz[ia1, 2]
 */
                            __pyx_t_7 = __pyx_v_ia1;
                            __pyx_t_8 = 0;
                            if (__pyx_t_7 &lt; 0) __pyx_t_7 += __pyx_v_xyz.shape[0];
                            if (__pyx_t_8 &lt; 0) __pyx_t_8 += __pyx_v_xyz.shape[1];
                            __pyx_v_a1 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_7 * __pyx_v_xyz.strides[0]) ) + __pyx_t_8 * __pyx_v_xyz.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line288")'> 288:         a2 = xyz[ia1, 1]</pre>
<pre id='line288' class='code' style='background-color: #FFFFff'>
                            /* "lib\structure\cStructure.pyx":288
 *             continue
 *         a1 = xyz[ia1, 0]
 *         a2 = xyz[ia1, 1]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         a3 = xyz[ia1, 2]
 *         for j in range(i, n_residues):
 */
                            __pyx_t_9 = __pyx_v_ia1;
                            __pyx_t_10 = 1;
                            if (__pyx_t_9 &lt; 0) __pyx_t_9 += __pyx_v_xyz.shape[0];
                            if (__pyx_t_10 &lt; 0) __pyx_t_10 += __pyx_v_xyz.shape[1];
                            __pyx_v_a2 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_9 * __pyx_v_xyz.strides[0]) ) + __pyx_t_10 * __pyx_v_xyz.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line289")'> 289:         a3 = xyz[ia1, 2]</pre>
<pre id='line289' class='code' style='background-color: #FFFFff'>
                            /* "lib\structure\cStructure.pyx":289
 *         a1 = xyz[ia1, 0]
 *         a2 = xyz[ia1, 1]
 *         a3 = xyz[ia1, 2]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         for j in range(i, n_residues):
 *             ia2 = resLookUp[j, aID]
 */
                            __pyx_t_11 = __pyx_v_ia1;
                            __pyx_t_12 = 2;
                            if (__pyx_t_11 &lt; 0) __pyx_t_11 += __pyx_v_xyz.shape[0];
                            if (__pyx_t_12 &lt; 0) __pyx_t_12 += __pyx_v_xyz.shape[1];
                            __pyx_v_a3 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_11 * __pyx_v_xyz.strides[0]) ) + __pyx_t_12 * __pyx_v_xyz.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line290")'> 290:         for j in range(i, n_residues):</pre>
<pre id='line290' class='code' style='background-color: #FFFFff'>
                            /* "lib\structure\cStructure.pyx":290
 *         a2 = xyz[ia1, 1]
 *         a3 = xyz[ia1, 2]
 *         for j in range(i, n_residues):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             ia2 = resLookUp[j, aID]
 *             if ia2 &lt; 0:
 */
                            __pyx_t_13 = __pyx_v_n_residues;
                            for (__pyx_t_14 = __pyx_v_i; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
                              __pyx_v_j = __pyx_t_14;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line291")'> 291:             ia2 = resLookUp[j, aID]</pre>
<pre id='line291' class='code' style='background-color: #FFFFff'>
                              /* "lib\structure\cStructure.pyx":291
 *         a3 = xyz[ia1, 2]
 *         for j in range(i, n_residues):
 *             ia2 = resLookUp[j, aID]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             if ia2 &lt; 0:
 *                 continue
 */
                              __pyx_t_15 = __pyx_v_j;
                              __pyx_t_16 = __pyx_v_aID;
                              if (__pyx_t_15 &lt; 0) __pyx_t_15 += __pyx_v_resLookUp.shape[0];
                              if (__pyx_t_16 &lt; 0) __pyx_t_16 += __pyx_v_resLookUp.shape[1];
                              __pyx_v_ia2 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_15 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_16 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line292")'> 292:             if ia2 &lt; 0:</pre>
<pre id='line292' class='code' style='background-color: #FFFFff'>
                              /* "lib\structure\cStructure.pyx":292
 *         for j in range(i, n_residues):
 *             ia2 = resLookUp[j, aID]
 *             if ia2 &lt; 0:             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 continue
 *             b1 = xyz[ia2, 0] - a1
 */
                              __pyx_t_6 = ((__pyx_v_ia2 &lt; 0) != 0);
                              if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line293")'> 293:                 continue</pre>
<pre id='line293' class='code' style='background-color: #FFFFff'>
                                /* "lib\structure\cStructure.pyx":293
 *             ia2 = resLookUp[j, aID]
 *             if ia2 &lt; 0:
 *                 continue             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             b1 = xyz[ia2, 0] - a1
 *             b2 = xyz[ia2, 1] - a2
 */
                                goto __pyx_L11_continue;
                              }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line294")'> 294:             b1 = xyz[ia2, 0] - a1</pre>
<pre id='line294' class='code' style='background-color: #FFFFff'>
                              /* "lib\structure\cStructure.pyx":294
 *             if ia2 &lt; 0:
 *                 continue
 *             b1 = xyz[ia2, 0] - a1             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             b2 = xyz[ia2, 1] - a2
 *             b3 = xyz[ia2, 2] - a3
 */
                              __pyx_t_17 = __pyx_v_ia2;
                              __pyx_t_18 = 0;
                              if (__pyx_t_17 &lt; 0) __pyx_t_17 += __pyx_v_xyz.shape[0];
                              if (__pyx_t_18 &lt; 0) __pyx_t_18 += __pyx_v_xyz.shape[1];
                              __pyx_v_b1 = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_17 * __pyx_v_xyz.strides[0]) ) + __pyx_t_18 * __pyx_v_xyz.strides[1]) ))) - __pyx_v_a1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line295")'> 295:             b2 = xyz[ia2, 1] - a2</pre>
<pre id='line295' class='code' style='background-color: #FFFFff'>
                              /* "lib\structure\cStructure.pyx":295
 *                 continue
 *             b1 = xyz[ia2, 0] - a1
 *             b2 = xyz[ia2, 1] - a2             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             b3 = xyz[ia2, 2] - a3
 * 
 */
                              __pyx_t_19 = __pyx_v_ia2;
                              __pyx_t_20 = 1;
                              if (__pyx_t_19 &lt; 0) __pyx_t_19 += __pyx_v_xyz.shape[0];
                              if (__pyx_t_20 &lt; 0) __pyx_t_20 += __pyx_v_xyz.shape[1];
                              __pyx_v_b2 = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_19 * __pyx_v_xyz.strides[0]) ) + __pyx_t_20 * __pyx_v_xyz.strides[1]) ))) - __pyx_v_a2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line296")'> 296:             b3 = xyz[ia2, 2] - a3</pre>
<pre id='line296' class='code' style='background-color: #FFFFff'>
                              /* "lib\structure\cStructure.pyx":296
 *             b1 = xyz[ia2, 0] - a1
 *             b2 = xyz[ia2, 1] - a2
 *             b3 = xyz[ia2, 2] - a3             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *             d12 = sqrt(b1*b1 + b2*b2 + b3*b3)
 */
                              __pyx_t_21 = __pyx_v_ia2;
                              __pyx_t_22 = 2;
                              if (__pyx_t_21 &lt; 0) __pyx_t_21 += __pyx_v_xyz.shape[0];
                              if (__pyx_t_22 &lt; 0) __pyx_t_22 += __pyx_v_xyz.shape[1];
                              __pyx_v_b3 = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_21 * __pyx_v_xyz.strides[0]) ) + __pyx_t_22 * __pyx_v_xyz.strides[1]) ))) - __pyx_v_a3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line297")'> 297: </pre>
<pre id='line297' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line298")'> 298:             d12 = sqrt(b1*b1 + b2*b2 + b3*b3)</pre>
<pre id='line298' class='code' style='background-color: #FFFFff'>
                              /* "lib\structure\cStructure.pyx":298
 *             b3 = xyz[ia2, 2] - a3
 * 
 *             d12 = sqrt(b1*b1 + b2*b2 + b3*b3)             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *             aDist[i, j] = d12
 */
                              __pyx_v_d12 = sqrt((((__pyx_v_b1 * __pyx_v_b1) + (__pyx_v_b2 * __pyx_v_b2)) + (__pyx_v_b3 * __pyx_v_b3)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line299")'> 299: </pre>
<pre id='line299' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line300")'> 300:             aDist[i, j] = d12</pre>
<pre id='line300' class='code' style='background-color: #FFFFff'>
                              /* "lib\structure\cStructure.pyx":300
 *             d12 = sqrt(b1*b1 + b2*b2 + b3*b3)
 * 
 *             aDist[i, j] = d12             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             aDist[j, i] = d12
 *     return aDist
 */
                              __pyx_t_23 = __pyx_v_i;
                              __pyx_t_24 = __pyx_v_j;
                              if (__pyx_t_23 &lt; 0) __pyx_t_23 += __pyx_v_aDist.shape[0];
                              if (__pyx_t_24 &lt; 0) __pyx_t_24 += __pyx_v_aDist.shape[1];
                              *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_aDist.data + __pyx_t_23 * __pyx_v_aDist.strides[0]) ) + __pyx_t_24 * __pyx_v_aDist.strides[1]) )) = __pyx_v_d12;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line301")'> 301:             aDist[j, i] = d12</pre>
<pre id='line301' class='code' style='background-color: #FFFFff'>
                              /* "lib\structure\cStructure.pyx":301
 * 
 *             aDist[i, j] = d12
 *             aDist[j, i] = d12             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     return aDist
 * 
 */
                              __pyx_t_25 = __pyx_v_j;
                              __pyx_t_26 = __pyx_v_i;
                              if (__pyx_t_25 &lt; 0) __pyx_t_25 += __pyx_v_aDist.shape[0];
                              if (__pyx_t_26 &lt; 0) __pyx_t_26 += __pyx_v_aDist.shape[1];
                              *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_aDist.data + __pyx_t_25 * __pyx_v_aDist.strides[0]) ) + __pyx_t_26 * __pyx_v_aDist.strides[1]) )) = __pyx_v_d12;
                              __pyx_L11_continue:;
                            }
                            goto __pyx_L15;
                            __pyx_L6_continue:;
                            goto __pyx_L15;
                            __pyx_L15:;
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line302")'> 302:     return aDist</pre>
<pre id='line302' class='code' style='background-color: #FFFFe7'>
  /* "lib\structure\cStructure.pyx":302
 *             aDist[i, j] = d12
 *             aDist[j, i] = d12
 *     return aDist             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_27 = __pyx_memoryview_fromslice(__pyx_v_aDist, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_27);
  __pyx_r = __pyx_t_27;
  __pyx_t_27 = 0;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line303")'> 303: </pre>
<pre id='line303' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line304")'> 304: </pre>
<pre id='line304' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line305")'> 305: @cython.cdivision(True)</pre>
<pre id='line305' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line306")'> 306: @cython.boundscheck(False)</pre>
<pre id='line306' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF22' onclick='toggleDiv("line307")'> 307: def internal_to_cartesian(np.ndarray internal_coordinates, double[:, :] r, int startPoint):</pre>
<pre id='line307' class='code' style='background-color: #FFFF22'>
/* "lib\structure\cStructure.pyx":307
 * @cython.cdivision(True)
 * @cython.boundscheck(False)
 * def internal_to_cartesian(np.ndarray internal_coordinates, double[:, :] r, int startPoint):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     cdef int i, k
 *     cdef int nAtoms = internal_coordinates.shape[0]
 */

/* Python wrapper */
static PyObject *__pyx_pw_3lib_9structure_10cStructure_13internal_to_cartesian(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_3lib_9structure_10cStructure_13internal_to_cartesian = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("internal_to_cartesian"), (PyCFunction)__pyx_pw_3lib_9structure_10cStructure_13internal_to_cartesian, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_3lib_9structure_10cStructure_13internal_to_cartesian(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_internal_coordinates = 0;
  __Pyx_memviewslice __pyx_v_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  CYTHON_UNUSED int __pyx_v_startPoint;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("internal_to_cartesian (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_internal_coordinates,&amp;__pyx_n_s_r,&amp;__pyx_n_s_startPoint,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_internal_coordinates)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("internal_to_cartesian", 1, 3, 3, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_startPoint)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("internal_to_cartesian", 1, 3, 3, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "internal_to_cartesian") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_internal_coordinates = ((PyArrayObject *)values[0]);
    __pyx_v_r = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[1]);<span class='error_goto'> if (unlikely(!__pyx_v_r.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_startPoint = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_startPoint == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("internal_to_cartesian", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.cStructure.internal_to_cartesian", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_internal_coordinates), __pyx_ptype_5numpy_ndarray, 1, "internal_coordinates", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_3lib_9structure_10cStructure_12internal_to_cartesian(__pyx_self, __pyx_v_internal_coordinates, __pyx_v_r, __pyx_v_startPoint);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3lib_9structure_10cStructure_12internal_to_cartesian(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_internal_coordinates, __Pyx_memviewslice __pyx_v_r, CYTHON_UNUSED int __pyx_v_startPoint) {
  int __pyx_v_i;
  int __pyx_v_nAtoms;
  __Pyx_memviewslice __pyx_v_b = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_d = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_ans = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_ib = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_ia = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_id = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_sin_theta;
  double __pyx_v_cos_theta;
  double __pyx_v_sin_phi;
  double __pyx_v_cos_phi;
  double *__pyx_v_p;
  double __pyx_v_v1;
  double __pyx_v_v2;
  double __pyx_v_v3;
  double __pyx_v_u1;
  double __pyx_v_u2;
  double __pyx_v_u3;
  double __pyx_v_ab1;
  double __pyx_v_ab2;
  double __pyx_v_ab3;
  double __pyx_v_bc1;
  double __pyx_v_bc2;
  double __pyx_v_bc3;
  double __pyx_v_cos_alpha;
  double __pyx_v_sin_alpha;
  double __pyx_v_nab;
  double __pyx_v_nbc;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("internal_to_cartesian", 0);

  /* "lib\structure\cStructure.pyx":307
 * @cython.cdivision(True)
 * @cython.boundscheck(False)
 * def internal_to_cartesian(np.ndarray internal_coordinates, double[:, :] r, int startPoint):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     cdef int i, k
 *     cdef int nAtoms = internal_coordinates.shape[0]
 */

  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("lib.structure.cStructure.internal_to_cartesian", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_b, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_a, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_d, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ans, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ib, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ia, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_id, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_r, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

  /* "lib\structure\cStructure.pyx":307
 * @cython.cdivision(True)
 * @cython.boundscheck(False)
 * def internal_to_cartesian(np.ndarray internal_coordinates, double[:, :] r, int startPoint):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     cdef int i, k
 *     cdef int nAtoms = internal_coordinates.shape[0]
 */
  __pyx_tuple__34 = <span class='py_c_api'>PyTuple_Pack</span>(34, __pyx_n_s_internal_coordinates, __pyx_n_s_r, __pyx_n_s_startPoint, __pyx_n_s_i, __pyx_n_s_k, __pyx_n_s_nAtoms, __pyx_n_s_b, __pyx_n_s_a, __pyx_n_s_d, __pyx_n_s_ans, __pyx_n_s_ib, __pyx_n_s_ia, __pyx_n_s_id, __pyx_n_s_sin_theta, __pyx_n_s_cos_theta, __pyx_n_s_sin_phi, __pyx_n_s_cos_phi, __pyx_n_s_p, __pyx_n_s_v1, __pyx_n_s_v2, __pyx_n_s_v3, __pyx_n_s_u1, __pyx_n_s_u2, __pyx_n_s_u3, __pyx_n_s_ab1, __pyx_n_s_ab2, __pyx_n_s_ab3, __pyx_n_s_bc1, __pyx_n_s_bc2, __pyx_n_s_bc3, __pyx_n_s_cos_alpha, __pyx_n_s_sin_alpha, __pyx_n_s_nab, __pyx_n_s_nbc);<span class='error_goto'> if (unlikely(!__pyx_tuple__34)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__34);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__34);

  /* "lib\structure\cStructure.pyx":307
 * @cython.cdivision(True)
 * @cython.boundscheck(False)
 * def internal_to_cartesian(np.ndarray internal_coordinates, double[:, :] r, int startPoint):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     cdef int i, k
 *     cdef int nAtoms = internal_coordinates.shape[0]
 */
  __pyx_t_4 = PyCFunction_NewEx(&amp;__pyx_mdef_3lib_9structure_10cStructure_13internal_to_cartesian, NULL, __pyx_n_s_lib_structure_cStructure);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_internal_to_cartesian, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__35 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 34, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__34, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_F_devel_lib_structure_cStructure, __pyx_n_s_internal_to_cartesian, 307, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__35)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line308")'> 308:     cdef int i, k</pre>
<pre id='line308' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line309")'> 309:     cdef int nAtoms = internal_coordinates.shape[0]</pre>
<pre id='line309' class='code' style='background-color: #FFFFff'>
  /* "lib\structure\cStructure.pyx":309
 * def internal_to_cartesian(np.ndarray internal_coordinates, double[:, :] r, int startPoint):
 *     cdef int i, k
 *     cdef int nAtoms = internal_coordinates.shape[0]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *     cdef double[:] b = internal_coordinates['b']
 */
  __pyx_v_nAtoms = (__pyx_v_internal_coordinates-&gt;dimensions[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line310")'> 310: </pre>
<pre id='line310' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line311")'> 311:     cdef double[:] b = internal_coordinates['b']</pre>
<pre id='line311' class='code' style='background-color: #FFFF8d'>
  /* "lib\structure\cStructure.pyx":311
 *     cdef int nAtoms = internal_coordinates.shape[0]
 * 
 *     cdef double[:] b = internal_coordinates['b']             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     cdef double[:] a = internal_coordinates['a']
 *     cdef double[:] d = internal_coordinates['d']
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_internal_coordinates), __pyx_n_s_b);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1);
  if (unlikely(!__pyx_t_2.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_b = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line312")'> 312:     cdef double[:] a = internal_coordinates['a']</pre>
<pre id='line312' class='code' style='background-color: #FFFF8d'>
  /* "lib\structure\cStructure.pyx":312
 * 
 *     cdef double[:] b = internal_coordinates['b']
 *     cdef double[:] a = internal_coordinates['a']             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     cdef double[:] d = internal_coordinates['d']
 *     cdef int[:] ans = internal_coordinates['i']
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_internal_coordinates), __pyx_n_s_a);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1);
  if (unlikely(!__pyx_t_3.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_a = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line313")'> 313:     cdef double[:] d = internal_coordinates['d']</pre>
<pre id='line313' class='code' style='background-color: #FFFF8d'>
  /* "lib\structure\cStructure.pyx":313
 *     cdef double[:] b = internal_coordinates['b']
 *     cdef double[:] a = internal_coordinates['a']
 *     cdef double[:] d = internal_coordinates['d']             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     cdef int[:] ans = internal_coordinates['i']
 * 
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_internal_coordinates), __pyx_n_s_d);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1);
  if (unlikely(!__pyx_t_4.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_d = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line314")'> 314:     cdef int[:] ans = internal_coordinates['i']</pre>
<pre id='line314' class='code' style='background-color: #FFFF8d'>
  /* "lib\structure\cStructure.pyx":314
 *     cdef double[:] a = internal_coordinates['a']
 *     cdef double[:] d = internal_coordinates['d']
 *     cdef int[:] ans = internal_coordinates['i']             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *     cdef int[:] ib = internal_coordinates['ib']
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_internal_coordinates), __pyx_n_s_i);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_1);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_ans = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line315")'> 315: </pre>
<pre id='line315' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line316")'> 316:     cdef int[:] ib = internal_coordinates['ib']</pre>
<pre id='line316' class='code' style='background-color: #FFFF8d'>
  /* "lib\structure\cStructure.pyx":316
 *     cdef int[:] ans = internal_coordinates['i']
 * 
 *     cdef int[:] ib = internal_coordinates['ib']             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     cdef int[:] ia = internal_coordinates['ia']
 *     cdef int[:] id = internal_coordinates['id']
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_internal_coordinates), __pyx_n_s_ib);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 316; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_1);
  if (unlikely(!__pyx_t_6.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 316; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_ib = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line317")'> 317:     cdef int[:] ia = internal_coordinates['ia']</pre>
<pre id='line317' class='code' style='background-color: #FFFF8d'>
  /* "lib\structure\cStructure.pyx":317
 * 
 *     cdef int[:] ib = internal_coordinates['ib']
 *     cdef int[:] ia = internal_coordinates['ia']             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     cdef int[:] id = internal_coordinates['id']
 * 
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_internal_coordinates), __pyx_n_s_ia);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_1);
  if (unlikely(!__pyx_t_7.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_ia = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line318")'> 318:     cdef int[:] id = internal_coordinates['id']</pre>
<pre id='line318' class='code' style='background-color: #FFFF8d'>
  /* "lib\structure\cStructure.pyx":318
 *     cdef int[:] ib = internal_coordinates['ib']
 *     cdef int[:] ia = internal_coordinates['ia']
 *     cdef int[:] id = internal_coordinates['id']             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *     cdef double sin_theta, cos_theta, sin_phi, cos_phi
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_internal_coordinates), __pyx_n_s_id);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_1);
  if (unlikely(!__pyx_t_8.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_id = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line319")'> 319: </pre>
<pre id='line319' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line320")'> 320:     cdef double sin_theta, cos_theta, sin_phi, cos_phi</pre>
<pre id='line320' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line321")'> 321:     cdef double* p = &lt;double *&gt;malloc(nAtoms * sizeof(double) * 3)</pre>
<pre id='line321' class='code' style='background-color: #FFFFff'>
  /* "lib\structure\cStructure.pyx":321
 * 
 *     cdef double sin_theta, cos_theta, sin_phi, cos_phi
 *     cdef double* p = &lt;double *&gt;malloc(nAtoms * sizeof(double) * 3)             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     for i in prange(nAtoms, nogil=True):
 *         sin_theta = sin(a[i])
 */
  __pyx_v_p = ((double *)malloc(((__pyx_v_nAtoms * (sizeof(double))) * 3)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line322")'> 322:     for i in prange(nAtoms, nogil=True):</pre>
<pre id='line322' class='code' style='background-color: #FFFFff'>
  /* "lib\structure\cStructure.pyx":322
 *     cdef double sin_theta, cos_theta, sin_phi, cos_phi
 *     cdef double* p = &lt;double *&gt;malloc(nAtoms * sizeof(double) * 3)
 *     for i in prange(nAtoms, nogil=True):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         sin_theta = sin(a[i])
 *         cos_theta = cos(a[i])
 */
  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
        __pyx_t_9 = __pyx_v_nAtoms;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_11 = (__pyx_t_9 - 0) / 1;
            if (__pyx_t_11 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_cos_phi) lastprivate(__pyx_v_sin_phi) lastprivate(__pyx_v_cos_theta) lastprivate(__pyx_v_sin_theta)
                    #endif /* _OPENMP */
                    for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_11; __pyx_t_10++){
                        {
                            __pyx_v_i = 0 + 1 * __pyx_t_10;
                            /* Initialize private variables to invalid values */
                            __pyx_v_cos_phi = ((double)__PYX_NAN());
                            __pyx_v_sin_phi = ((double)__PYX_NAN());
                            __pyx_v_cos_theta = ((double)__PYX_NAN());
                            __pyx_v_sin_theta = ((double)__PYX_NAN());

      /* "lib\structure\cStructure.pyx":322
 *     cdef double sin_theta, cos_theta, sin_phi, cos_phi
 *     cdef double* p = &lt;double *&gt;malloc(nAtoms * sizeof(double) * 3)
 *     for i in prange(nAtoms, nogil=True):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         sin_theta = sin(a[i])
 *         cos_theta = cos(a[i])
 */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line323")'> 323:         sin_theta = sin(a[i])</pre>
<pre id='line323' class='code' style='background-color: #FFFFff'>
                            /* "lib\structure\cStructure.pyx":323
 *     cdef double* p = &lt;double *&gt;malloc(nAtoms * sizeof(double) * 3)
 *     for i in prange(nAtoms, nogil=True):
 *         sin_theta = sin(a[i])             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         cos_theta = cos(a[i])
 *         sin_phi = sin(d[i])
 */
                            __pyx_t_12 = __pyx_v_i;
                            if (__pyx_t_12 &lt; 0) __pyx_t_12 += __pyx_v_a.shape[0];
                            __pyx_v_sin_theta = sin((*((double *) ( /* dim=0 */ (__pyx_v_a.data + __pyx_t_12 * __pyx_v_a.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line324")'> 324:         cos_theta = cos(a[i])</pre>
<pre id='line324' class='code' style='background-color: #FFFFff'>
                            /* "lib\structure\cStructure.pyx":324
 *     for i in prange(nAtoms, nogil=True):
 *         sin_theta = sin(a[i])
 *         cos_theta = cos(a[i])             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         sin_phi = sin(d[i])
 *         cos_phi = cos(d[i])
 */
                            __pyx_t_13 = __pyx_v_i;
                            if (__pyx_t_13 &lt; 0) __pyx_t_13 += __pyx_v_a.shape[0];
                            __pyx_v_cos_theta = cos((*((double *) ( /* dim=0 */ (__pyx_v_a.data + __pyx_t_13 * __pyx_v_a.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line325")'> 325:         sin_phi = sin(d[i])</pre>
<pre id='line325' class='code' style='background-color: #FFFFff'>
                            /* "lib\structure\cStructure.pyx":325
 *         sin_theta = sin(a[i])
 *         cos_theta = cos(a[i])
 *         sin_phi = sin(d[i])             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         cos_phi = cos(d[i])
 *         p[i*3 + 0] = b[i] * sin_theta * sin_phi
 */
                            __pyx_t_14 = __pyx_v_i;
                            if (__pyx_t_14 &lt; 0) __pyx_t_14 += __pyx_v_d.shape[0];
                            __pyx_v_sin_phi = sin((*((double *) ( /* dim=0 */ (__pyx_v_d.data + __pyx_t_14 * __pyx_v_d.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line326")'> 326:         cos_phi = cos(d[i])</pre>
<pre id='line326' class='code' style='background-color: #FFFFff'>
                            /* "lib\structure\cStructure.pyx":326
 *         cos_theta = cos(a[i])
 *         sin_phi = sin(d[i])
 *         cos_phi = cos(d[i])             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         p[i*3 + 0] = b[i] * sin_theta * sin_phi
 *         p[i*3 + 1] = b[i] * sin_theta * cos_phi
 */
                            __pyx_t_15 = __pyx_v_i;
                            if (__pyx_t_15 &lt; 0) __pyx_t_15 += __pyx_v_d.shape[0];
                            __pyx_v_cos_phi = cos((*((double *) ( /* dim=0 */ (__pyx_v_d.data + __pyx_t_15 * __pyx_v_d.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line327")'> 327:         p[i*3 + 0] = b[i] * sin_theta * sin_phi</pre>
<pre id='line327' class='code' style='background-color: #FFFFff'>
                            /* "lib\structure\cStructure.pyx":327
 *         sin_phi = sin(d[i])
 *         cos_phi = cos(d[i])
 *         p[i*3 + 0] = b[i] * sin_theta * sin_phi             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         p[i*3 + 1] = b[i] * sin_theta * cos_phi
 *         p[i*3 + 2] = b[i] * cos_theta
 */
                            __pyx_t_16 = __pyx_v_i;
                            if (__pyx_t_16 &lt; 0) __pyx_t_16 += __pyx_v_b.shape[0];
                            (__pyx_v_p[((__pyx_v_i * 3) + 0)]) = (((*((double *) ( /* dim=0 */ (__pyx_v_b.data + __pyx_t_16 * __pyx_v_b.strides[0]) ))) * __pyx_v_sin_theta) * __pyx_v_sin_phi);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line328")'> 328:         p[i*3 + 1] = b[i] * sin_theta * cos_phi</pre>
<pre id='line328' class='code' style='background-color: #FFFFff'>
                            /* "lib\structure\cStructure.pyx":328
 *         cos_phi = cos(d[i])
 *         p[i*3 + 0] = b[i] * sin_theta * sin_phi
 *         p[i*3 + 1] = b[i] * sin_theta * cos_phi             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         p[i*3 + 2] = b[i] * cos_theta
 * 
 */
                            __pyx_t_17 = __pyx_v_i;
                            if (__pyx_t_17 &lt; 0) __pyx_t_17 += __pyx_v_b.shape[0];
                            (__pyx_v_p[((__pyx_v_i * 3) + 1)]) = (((*((double *) ( /* dim=0 */ (__pyx_v_b.data + __pyx_t_17 * __pyx_v_b.strides[0]) ))) * __pyx_v_sin_theta) * __pyx_v_cos_phi);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line329")'> 329:         p[i*3 + 2] = b[i] * cos_theta</pre>
<pre id='line329' class='code' style='background-color: #FFFFff'>
                            /* "lib\structure\cStructure.pyx":329
 *         p[i*3 + 0] = b[i] * sin_theta * sin_phi
 *         p[i*3 + 1] = b[i] * sin_theta * cos_phi
 *         p[i*3 + 2] = b[i] * cos_theta             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *     cdef double v1, v2, v3
 */
                            __pyx_t_18 = __pyx_v_i;
                            if (__pyx_t_18 &lt; 0) __pyx_t_18 += __pyx_v_b.shape[0];
                            (__pyx_v_p[((__pyx_v_i * 3) + 2)]) = ((*((double *) ( /* dim=0 */ (__pyx_v_b.data + __pyx_t_18 * __pyx_v_b.strides[0]) ))) * __pyx_v_cos_theta);
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line330")'> 330: </pre>
<pre id='line330' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line331")'> 331:     cdef double v1, v2, v3</pre>
<pre id='line331' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line332")'> 332:     cdef double u1, u2, u3</pre>
<pre id='line332' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line333")'> 333:     cdef double ab1, ab2, ab3</pre>
<pre id='line333' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line334")'> 334:     cdef double bc1, bc2, bc3</pre>
<pre id='line334' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line335")'> 335:     cdef double cos_alpha, sin_alpha, nab, nbc</pre>
<pre id='line335' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line336")'> 336:     for i in range(nAtoms):</pre>
<pre id='line336' class='code' style='background-color: #FFFFff'>
  /* "lib\structure\cStructure.pyx":336
 *     cdef double bc1, bc2, bc3
 *     cdef double cos_alpha, sin_alpha, nab, nbc
 *     for i in range(nAtoms):             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *         if ib[i] != 0 and ia[i] != 0 and id[i] != 0:
 *             ab1 = (r[ib[i], 0] - r[ia[i], 0])
 */
  __pyx_t_11 = __pyx_v_nAtoms;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_11; __pyx_t_10+=1) {
    __pyx_v_i = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line337")'> 337:         if ib[i] != 0 and ia[i] != 0 and id[i] != 0:</pre>
<pre id='line337' class='code' style='background-color: #FFFFff'>
    /* "lib\structure\cStructure.pyx":337
 *     cdef double cos_alpha, sin_alpha, nab, nbc
 *     for i in range(nAtoms):
 *         if ib[i] != 0 and ia[i] != 0 and id[i] != 0:             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             ab1 = (r[ib[i], 0] - r[ia[i], 0])
 *             ab2 = (r[ib[i], 1] - r[ia[i], 1])
 */
    __pyx_t_9 = __pyx_v_i;
    if (__pyx_t_9 &lt; 0) __pyx_t_9 += __pyx_v_ib.shape[0];
    __pyx_t_19 = (((*((int *) ( /* dim=0 */ (__pyx_v_ib.data + __pyx_t_9 * __pyx_v_ib.strides[0]) ))) != 0) != 0);
    if (__pyx_t_19) {
      __pyx_t_20 = __pyx_v_i;
      if (__pyx_t_20 &lt; 0) __pyx_t_20 += __pyx_v_ia.shape[0];
      __pyx_t_21 = (((*((int *) ( /* dim=0 */ (__pyx_v_ia.data + __pyx_t_20 * __pyx_v_ia.strides[0]) ))) != 0) != 0);
      if (__pyx_t_21) {
        __pyx_t_22 = __pyx_v_i;
        if (__pyx_t_22 &lt; 0) __pyx_t_22 += __pyx_v_id.shape[0];
        __pyx_t_23 = (((*((int *) ( /* dim=0 */ (__pyx_v_id.data + __pyx_t_22 * __pyx_v_id.strides[0]) ))) != 0) != 0);
        __pyx_t_24 = __pyx_t_23;
      } else {
        __pyx_t_24 = __pyx_t_21;
      }
      __pyx_t_21 = __pyx_t_24;
    } else {
      __pyx_t_21 = __pyx_t_19;
    }
    if (__pyx_t_21) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line338")'> 338:             ab1 = (r[ib[i], 0] - r[ia[i], 0])</pre>
<pre id='line338' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":338
 *     for i in range(nAtoms):
 *         if ib[i] != 0 and ia[i] != 0 and id[i] != 0:
 *             ab1 = (r[ib[i], 0] - r[ia[i], 0])             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             ab2 = (r[ib[i], 1] - r[ia[i], 1])
 *             ab3 = (r[ib[i], 2] - r[ia[i], 2])
 */
      __pyx_t_25 = __pyx_v_i;
      if (__pyx_t_25 &lt; 0) __pyx_t_25 += __pyx_v_ib.shape[0];
      __pyx_t_26 = (*((int *) ( /* dim=0 */ (__pyx_v_ib.data + __pyx_t_25 * __pyx_v_ib.strides[0]) )));
      __pyx_t_27 = 0;
      if (__pyx_t_26 &lt; 0) __pyx_t_26 += __pyx_v_r.shape[0];
      if (__pyx_t_27 &lt; 0) __pyx_t_27 += __pyx_v_r.shape[1];
      __pyx_t_28 = __pyx_v_i;
      if (__pyx_t_28 &lt; 0) __pyx_t_28 += __pyx_v_ia.shape[0];
      __pyx_t_29 = (*((int *) ( /* dim=0 */ (__pyx_v_ia.data + __pyx_t_28 * __pyx_v_ia.strides[0]) )));
      __pyx_t_30 = 0;
      if (__pyx_t_29 &lt; 0) __pyx_t_29 += __pyx_v_r.shape[0];
      if (__pyx_t_30 &lt; 0) __pyx_t_30 += __pyx_v_r.shape[1];
      __pyx_v_ab1 = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_26 * __pyx_v_r.strides[0]) ) + __pyx_t_27 * __pyx_v_r.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_29 * __pyx_v_r.strides[0]) ) + __pyx_t_30 * __pyx_v_r.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line339")'> 339:             ab2 = (r[ib[i], 1] - r[ia[i], 1])</pre>
<pre id='line339' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":339
 *         if ib[i] != 0 and ia[i] != 0 and id[i] != 0:
 *             ab1 = (r[ib[i], 0] - r[ia[i], 0])
 *             ab2 = (r[ib[i], 1] - r[ia[i], 1])             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             ab3 = (r[ib[i], 2] - r[ia[i], 2])
 *             nab = sqrt(ab1*ab1+ab2*ab2+ab3*ab3)
 */
      __pyx_t_31 = __pyx_v_i;
      if (__pyx_t_31 &lt; 0) __pyx_t_31 += __pyx_v_ib.shape[0];
      __pyx_t_32 = (*((int *) ( /* dim=0 */ (__pyx_v_ib.data + __pyx_t_31 * __pyx_v_ib.strides[0]) )));
      __pyx_t_33 = 1;
      if (__pyx_t_32 &lt; 0) __pyx_t_32 += __pyx_v_r.shape[0];
      if (__pyx_t_33 &lt; 0) __pyx_t_33 += __pyx_v_r.shape[1];
      __pyx_t_34 = __pyx_v_i;
      if (__pyx_t_34 &lt; 0) __pyx_t_34 += __pyx_v_ia.shape[0];
      __pyx_t_35 = (*((int *) ( /* dim=0 */ (__pyx_v_ia.data + __pyx_t_34 * __pyx_v_ia.strides[0]) )));
      __pyx_t_36 = 1;
      if (__pyx_t_35 &lt; 0) __pyx_t_35 += __pyx_v_r.shape[0];
      if (__pyx_t_36 &lt; 0) __pyx_t_36 += __pyx_v_r.shape[1];
      __pyx_v_ab2 = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_32 * __pyx_v_r.strides[0]) ) + __pyx_t_33 * __pyx_v_r.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_35 * __pyx_v_r.strides[0]) ) + __pyx_t_36 * __pyx_v_r.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line340")'> 340:             ab3 = (r[ib[i], 2] - r[ia[i], 2])</pre>
<pre id='line340' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":340
 *             ab1 = (r[ib[i], 0] - r[ia[i], 0])
 *             ab2 = (r[ib[i], 1] - r[ia[i], 1])
 *             ab3 = (r[ib[i], 2] - r[ia[i], 2])             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             nab = sqrt(ab1*ab1+ab2*ab2+ab3*ab3)
 *             ab1 /= nab
 */
      __pyx_t_37 = __pyx_v_i;
      if (__pyx_t_37 &lt; 0) __pyx_t_37 += __pyx_v_ib.shape[0];
      __pyx_t_38 = (*((int *) ( /* dim=0 */ (__pyx_v_ib.data + __pyx_t_37 * __pyx_v_ib.strides[0]) )));
      __pyx_t_39 = 2;
      if (__pyx_t_38 &lt; 0) __pyx_t_38 += __pyx_v_r.shape[0];
      if (__pyx_t_39 &lt; 0) __pyx_t_39 += __pyx_v_r.shape[1];
      __pyx_t_40 = __pyx_v_i;
      if (__pyx_t_40 &lt; 0) __pyx_t_40 += __pyx_v_ia.shape[0];
      __pyx_t_41 = (*((int *) ( /* dim=0 */ (__pyx_v_ia.data + __pyx_t_40 * __pyx_v_ia.strides[0]) )));
      __pyx_t_42 = 2;
      if (__pyx_t_41 &lt; 0) __pyx_t_41 += __pyx_v_r.shape[0];
      if (__pyx_t_42 &lt; 0) __pyx_t_42 += __pyx_v_r.shape[1];
      __pyx_v_ab3 = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_38 * __pyx_v_r.strides[0]) ) + __pyx_t_39 * __pyx_v_r.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_41 * __pyx_v_r.strides[0]) ) + __pyx_t_42 * __pyx_v_r.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line341")'> 341:             nab = sqrt(ab1*ab1+ab2*ab2+ab3*ab3)</pre>
<pre id='line341' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":341
 *             ab2 = (r[ib[i], 1] - r[ia[i], 1])
 *             ab3 = (r[ib[i], 2] - r[ia[i], 2])
 *             nab = sqrt(ab1*ab1+ab2*ab2+ab3*ab3)             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             ab1 /= nab
 *             ab2 /= nab
 */
      __pyx_v_nab = sqrt((((__pyx_v_ab1 * __pyx_v_ab1) + (__pyx_v_ab2 * __pyx_v_ab2)) + (__pyx_v_ab3 * __pyx_v_ab3)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line342")'> 342:             ab1 /= nab</pre>
<pre id='line342' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":342
 *             ab3 = (r[ib[i], 2] - r[ia[i], 2])
 *             nab = sqrt(ab1*ab1+ab2*ab2+ab3*ab3)
 *             ab1 /= nab             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             ab2 /= nab
 *             ab3 /= nab
 */
      __pyx_v_ab1 = (__pyx_v_ab1 / __pyx_v_nab);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line343")'> 343:             ab2 /= nab</pre>
<pre id='line343' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":343
 *             nab = sqrt(ab1*ab1+ab2*ab2+ab3*ab3)
 *             ab1 /= nab
 *             ab2 /= nab             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             ab3 /= nab
 *             bc1 = (r[ia[i], 0] - r[id[i], 0])
 */
      __pyx_v_ab2 = (__pyx_v_ab2 / __pyx_v_nab);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line344")'> 344:             ab3 /= nab</pre>
<pre id='line344' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":344
 *             ab1 /= nab
 *             ab2 /= nab
 *             ab3 /= nab             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             bc1 = (r[ia[i], 0] - r[id[i], 0])
 *             bc2 = (r[ia[i], 1] - r[id[i], 1])
 */
      __pyx_v_ab3 = (__pyx_v_ab3 / __pyx_v_nab);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line345")'> 345:             bc1 = (r[ia[i], 0] - r[id[i], 0])</pre>
<pre id='line345' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":345
 *             ab2 /= nab
 *             ab3 /= nab
 *             bc1 = (r[ia[i], 0] - r[id[i], 0])             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             bc2 = (r[ia[i], 1] - r[id[i], 1])
 *             bc3 = (r[ia[i], 2] - r[id[i], 2])
 */
      __pyx_t_43 = __pyx_v_i;
      if (__pyx_t_43 &lt; 0) __pyx_t_43 += __pyx_v_ia.shape[0];
      __pyx_t_44 = (*((int *) ( /* dim=0 */ (__pyx_v_ia.data + __pyx_t_43 * __pyx_v_ia.strides[0]) )));
      __pyx_t_45 = 0;
      if (__pyx_t_44 &lt; 0) __pyx_t_44 += __pyx_v_r.shape[0];
      if (__pyx_t_45 &lt; 0) __pyx_t_45 += __pyx_v_r.shape[1];
      __pyx_t_46 = __pyx_v_i;
      if (__pyx_t_46 &lt; 0) __pyx_t_46 += __pyx_v_id.shape[0];
      __pyx_t_47 = (*((int *) ( /* dim=0 */ (__pyx_v_id.data + __pyx_t_46 * __pyx_v_id.strides[0]) )));
      __pyx_t_48 = 0;
      if (__pyx_t_47 &lt; 0) __pyx_t_47 += __pyx_v_r.shape[0];
      if (__pyx_t_48 &lt; 0) __pyx_t_48 += __pyx_v_r.shape[1];
      __pyx_v_bc1 = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_44 * __pyx_v_r.strides[0]) ) + __pyx_t_45 * __pyx_v_r.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_47 * __pyx_v_r.strides[0]) ) + __pyx_t_48 * __pyx_v_r.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line346")'> 346:             bc2 = (r[ia[i], 1] - r[id[i], 1])</pre>
<pre id='line346' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":346
 *             ab3 /= nab
 *             bc1 = (r[ia[i], 0] - r[id[i], 0])
 *             bc2 = (r[ia[i], 1] - r[id[i], 1])             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             bc3 = (r[ia[i], 2] - r[id[i], 2])
 *             nbc = sqrt(bc1*bc1+bc2*bc2+bc3*bc3)
 */
      __pyx_t_49 = __pyx_v_i;
      if (__pyx_t_49 &lt; 0) __pyx_t_49 += __pyx_v_ia.shape[0];
      __pyx_t_50 = (*((int *) ( /* dim=0 */ (__pyx_v_ia.data + __pyx_t_49 * __pyx_v_ia.strides[0]) )));
      __pyx_t_51 = 1;
      if (__pyx_t_50 &lt; 0) __pyx_t_50 += __pyx_v_r.shape[0];
      if (__pyx_t_51 &lt; 0) __pyx_t_51 += __pyx_v_r.shape[1];
      __pyx_t_52 = __pyx_v_i;
      if (__pyx_t_52 &lt; 0) __pyx_t_52 += __pyx_v_id.shape[0];
      __pyx_t_53 = (*((int *) ( /* dim=0 */ (__pyx_v_id.data + __pyx_t_52 * __pyx_v_id.strides[0]) )));
      __pyx_t_54 = 1;
      if (__pyx_t_53 &lt; 0) __pyx_t_53 += __pyx_v_r.shape[0];
      if (__pyx_t_54 &lt; 0) __pyx_t_54 += __pyx_v_r.shape[1];
      __pyx_v_bc2 = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_50 * __pyx_v_r.strides[0]) ) + __pyx_t_51 * __pyx_v_r.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_53 * __pyx_v_r.strides[0]) ) + __pyx_t_54 * __pyx_v_r.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line347")'> 347:             bc3 = (r[ia[i], 2] - r[id[i], 2])</pre>
<pre id='line347' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":347
 *             bc1 = (r[ia[i], 0] - r[id[i], 0])
 *             bc2 = (r[ia[i], 1] - r[id[i], 1])
 *             bc3 = (r[ia[i], 2] - r[id[i], 2])             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             nbc = sqrt(bc1*bc1+bc2*bc2+bc3*bc3)
 *             bc1 /= nbc
 */
      __pyx_t_55 = __pyx_v_i;
      if (__pyx_t_55 &lt; 0) __pyx_t_55 += __pyx_v_ia.shape[0];
      __pyx_t_56 = (*((int *) ( /* dim=0 */ (__pyx_v_ia.data + __pyx_t_55 * __pyx_v_ia.strides[0]) )));
      __pyx_t_57 = 2;
      if (__pyx_t_56 &lt; 0) __pyx_t_56 += __pyx_v_r.shape[0];
      if (__pyx_t_57 &lt; 0) __pyx_t_57 += __pyx_v_r.shape[1];
      __pyx_t_58 = __pyx_v_i;
      if (__pyx_t_58 &lt; 0) __pyx_t_58 += __pyx_v_id.shape[0];
      __pyx_t_59 = (*((int *) ( /* dim=0 */ (__pyx_v_id.data + __pyx_t_58 * __pyx_v_id.strides[0]) )));
      __pyx_t_60 = 2;
      if (__pyx_t_59 &lt; 0) __pyx_t_59 += __pyx_v_r.shape[0];
      if (__pyx_t_60 &lt; 0) __pyx_t_60 += __pyx_v_r.shape[1];
      __pyx_v_bc3 = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_56 * __pyx_v_r.strides[0]) ) + __pyx_t_57 * __pyx_v_r.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_59 * __pyx_v_r.strides[0]) ) + __pyx_t_60 * __pyx_v_r.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line348")'> 348:             nbc = sqrt(bc1*bc1+bc2*bc2+bc3*bc3)</pre>
<pre id='line348' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":348
 *             bc2 = (r[ia[i], 1] - r[id[i], 1])
 *             bc3 = (r[ia[i], 2] - r[id[i], 2])
 *             nbc = sqrt(bc1*bc1+bc2*bc2+bc3*bc3)             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             bc1 /= nbc
 *             bc2 /= nbc
 */
      __pyx_v_nbc = sqrt((((__pyx_v_bc1 * __pyx_v_bc1) + (__pyx_v_bc2 * __pyx_v_bc2)) + (__pyx_v_bc3 * __pyx_v_bc3)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line349")'> 349:             bc1 /= nbc</pre>
<pre id='line349' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":349
 *             bc3 = (r[ia[i], 2] - r[id[i], 2])
 *             nbc = sqrt(bc1*bc1+bc2*bc2+bc3*bc3)
 *             bc1 /= nbc             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             bc2 /= nbc
 *             bc3 /= nbc
 */
      __pyx_v_bc1 = (__pyx_v_bc1 / __pyx_v_nbc);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line350")'> 350:             bc2 /= nbc</pre>
<pre id='line350' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":350
 *             nbc = sqrt(bc1*bc1+bc2*bc2+bc3*bc3)
 *             bc1 /= nbc
 *             bc2 /= nbc             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             bc3 /= nbc
 *             v1 = ab3 * bc2 - ab2 * bc3
 */
      __pyx_v_bc2 = (__pyx_v_bc2 / __pyx_v_nbc);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line351")'> 351:             bc3 /= nbc</pre>
<pre id='line351' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":351
 *             bc1 /= nbc
 *             bc2 /= nbc
 *             bc3 /= nbc             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             v1 = ab3 * bc2 - ab2 * bc3
 *             v2 = ab1 * bc3 - ab3 * bc1
 */
      __pyx_v_bc3 = (__pyx_v_bc3 / __pyx_v_nbc);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line352")'> 352:             v1 = ab3 * bc2 - ab2 * bc3</pre>
<pre id='line352' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":352
 *             bc2 /= nbc
 *             bc3 /= nbc
 *             v1 = ab3 * bc2 - ab2 * bc3             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             v2 = ab1 * bc3 - ab3 * bc1
 *             v3 = ab2 * bc1 - ab1 * bc2
 */
      __pyx_v_v1 = ((__pyx_v_ab3 * __pyx_v_bc2) - (__pyx_v_ab2 * __pyx_v_bc3));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line353")'> 353:             v2 = ab1 * bc3 - ab3 * bc1</pre>
<pre id='line353' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":353
 *             bc3 /= nbc
 *             v1 = ab3 * bc2 - ab2 * bc3
 *             v2 = ab1 * bc3 - ab3 * bc1             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             v3 = ab2 * bc1 - ab1 * bc2
 *             cos_alpha = ab1*bc1 + ab2*bc2 + ab3*bc3
 */
      __pyx_v_v2 = ((__pyx_v_ab1 * __pyx_v_bc3) - (__pyx_v_ab3 * __pyx_v_bc1));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line354")'> 354:             v3 = ab2 * bc1 - ab1 * bc2</pre>
<pre id='line354' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":354
 *             v1 = ab3 * bc2 - ab2 * bc3
 *             v2 = ab1 * bc3 - ab3 * bc1
 *             v3 = ab2 * bc1 - ab1 * bc2             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             cos_alpha = ab1*bc1 + ab2*bc2 + ab3*bc3
 *             sin_alpha = sqrt(1.0 - cos_alpha * cos_alpha)
 */
      __pyx_v_v3 = ((__pyx_v_ab2 * __pyx_v_bc1) - (__pyx_v_ab1 * __pyx_v_bc2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line355")'> 355:             cos_alpha = ab1*bc1 + ab2*bc2 + ab3*bc3</pre>
<pre id='line355' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":355
 *             v2 = ab1 * bc3 - ab3 * bc1
 *             v3 = ab2 * bc1 - ab1 * bc2
 *             cos_alpha = ab1*bc1 + ab2*bc2 + ab3*bc3             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             sin_alpha = sqrt(1.0 - cos_alpha * cos_alpha)
 *             v1 /= sin_alpha
 */
      __pyx_v_cos_alpha = (((__pyx_v_ab1 * __pyx_v_bc1) + (__pyx_v_ab2 * __pyx_v_bc2)) + (__pyx_v_ab3 * __pyx_v_bc3));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line356")'> 356:             sin_alpha = sqrt(1.0 - cos_alpha * cos_alpha)</pre>
<pre id='line356' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":356
 *             v3 = ab2 * bc1 - ab1 * bc2
 *             cos_alpha = ab1*bc1 + ab2*bc2 + ab3*bc3
 *             sin_alpha = sqrt(1.0 - cos_alpha * cos_alpha)             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             v1 /= sin_alpha
 *             v2 /= sin_alpha
 */
      __pyx_v_sin_alpha = sqrt((1.0 - (__pyx_v_cos_alpha * __pyx_v_cos_alpha)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line357")'> 357:             v1 /= sin_alpha</pre>
<pre id='line357' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":357
 *             cos_alpha = ab1*bc1 + ab2*bc2 + ab3*bc3
 *             sin_alpha = sqrt(1.0 - cos_alpha * cos_alpha)
 *             v1 /= sin_alpha             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             v2 /= sin_alpha
 *             v3 /= sin_alpha
 */
      __pyx_v_v1 = (__pyx_v_v1 / __pyx_v_sin_alpha);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line358")'> 358:             v2 /= sin_alpha</pre>
<pre id='line358' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":358
 *             sin_alpha = sqrt(1.0 - cos_alpha * cos_alpha)
 *             v1 /= sin_alpha
 *             v2 /= sin_alpha             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             v3 /= sin_alpha
 *             u1 = v2 * ab3 - v3 * ab2
 */
      __pyx_v_v2 = (__pyx_v_v2 / __pyx_v_sin_alpha);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line359")'> 359:             v3 /= sin_alpha</pre>
<pre id='line359' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":359
 *             v1 /= sin_alpha
 *             v2 /= sin_alpha
 *             v3 /= sin_alpha             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             u1 = v2 * ab3 - v3 * ab2
 *             u2 = v3 * ab1 - v1 * ab3
 */
      __pyx_v_v3 = (__pyx_v_v3 / __pyx_v_sin_alpha);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line360")'> 360:             u1 = v2 * ab3 - v3 * ab2</pre>
<pre id='line360' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":360
 *             v2 /= sin_alpha
 *             v3 /= sin_alpha
 *             u1 = v2 * ab3 - v3 * ab2             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             u2 = v3 * ab1 - v1 * ab3
 *             u3 = v1 * ab2 - v2 * ab1
 */
      __pyx_v_u1 = ((__pyx_v_v2 * __pyx_v_ab3) - (__pyx_v_v3 * __pyx_v_ab2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line361")'> 361:             u2 = v3 * ab1 - v1 * ab3</pre>
<pre id='line361' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":361
 *             v3 /= sin_alpha
 *             u1 = v2 * ab3 - v3 * ab2
 *             u2 = v3 * ab1 - v1 * ab3             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             u3 = v1 * ab2 - v2 * ab1
 * 
 */
      __pyx_v_u2 = ((__pyx_v_v3 * __pyx_v_ab1) - (__pyx_v_v1 * __pyx_v_ab3));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line362")'> 362:             u3 = v1 * ab2 - v2 * ab1</pre>
<pre id='line362' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":362
 *             u1 = v2 * ab3 - v3 * ab2
 *             u2 = v3 * ab1 - v1 * ab3
 *             u3 = v1 * ab2 - v2 * ab1             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *             r[ans[i], 0] = r[ib[i], 0] + v1 * p[i * 3 + 0] + u1 * p[i * 3 + 1] - ab1 * p[i * 3 + 2]
 */
      __pyx_v_u3 = ((__pyx_v_v1 * __pyx_v_ab2) - (__pyx_v_v2 * __pyx_v_ab1));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line363")'> 363: </pre>
<pre id='line363' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line364")'> 364:             r[ans[i], 0] = r[ib[i], 0] + v1 * p[i * 3 + 0] + u1 * p[i * 3 + 1] - ab1 * p[i * 3 + 2]</pre>
<pre id='line364' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":364
 *             u3 = v1 * ab2 - v2 * ab1
 * 
 *             r[ans[i], 0] = r[ib[i], 0] + v1 * p[i * 3 + 0] + u1 * p[i * 3 + 1] - ab1 * p[i * 3 + 2]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             r[ans[i], 1] = r[ib[i], 1] + v2 * p[i * 3 + 0] + u2 * p[i * 3 + 1] - ab2 * p[i * 3 + 2]
 *             r[ans[i], 2] = r[ib[i], 2] + v3 * p[i * 3 + 0] + u3 * p[i * 3 + 1] - ab3 * p[i * 3 + 2]
 */
      __pyx_t_61 = __pyx_v_i;
      if (__pyx_t_61 &lt; 0) __pyx_t_61 += __pyx_v_ib.shape[0];
      __pyx_t_62 = (*((int *) ( /* dim=0 */ (__pyx_v_ib.data + __pyx_t_61 * __pyx_v_ib.strides[0]) )));
      __pyx_t_63 = 0;
      if (__pyx_t_62 &lt; 0) __pyx_t_62 += __pyx_v_r.shape[0];
      if (__pyx_t_63 &lt; 0) __pyx_t_63 += __pyx_v_r.shape[1];
      __pyx_t_64 = __pyx_v_i;
      if (__pyx_t_64 &lt; 0) __pyx_t_64 += __pyx_v_ans.shape[0];
      __pyx_t_65 = (*((int *) ( /* dim=0 */ (__pyx_v_ans.data + __pyx_t_64 * __pyx_v_ans.strides[0]) )));
      __pyx_t_66 = 0;
      if (__pyx_t_65 &lt; 0) __pyx_t_65 += __pyx_v_r.shape[0];
      if (__pyx_t_66 &lt; 0) __pyx_t_66 += __pyx_v_r.shape[1];
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_65 * __pyx_v_r.strides[0]) ) + __pyx_t_66 * __pyx_v_r.strides[1]) )) = ((((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_62 * __pyx_v_r.strides[0]) ) + __pyx_t_63 * __pyx_v_r.strides[1]) ))) + (__pyx_v_v1 * (__pyx_v_p[((__pyx_v_i * 3) + 0)]))) + (__pyx_v_u1 * (__pyx_v_p[((__pyx_v_i * 3) + 1)]))) - (__pyx_v_ab1 * (__pyx_v_p[((__pyx_v_i * 3) + 2)])));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line365")'> 365:             r[ans[i], 1] = r[ib[i], 1] + v2 * p[i * 3 + 0] + u2 * p[i * 3 + 1] - ab2 * p[i * 3 + 2]</pre>
<pre id='line365' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":365
 * 
 *             r[ans[i], 0] = r[ib[i], 0] + v1 * p[i * 3 + 0] + u1 * p[i * 3 + 1] - ab1 * p[i * 3 + 2]
 *             r[ans[i], 1] = r[ib[i], 1] + v2 * p[i * 3 + 0] + u2 * p[i * 3 + 1] - ab2 * p[i * 3 + 2]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             r[ans[i], 2] = r[ib[i], 2] + v3 * p[i * 3 + 0] + u3 * p[i * 3 + 1] - ab3 * p[i * 3 + 2]
 *     free(p)
 */
      __pyx_t_67 = __pyx_v_i;
      if (__pyx_t_67 &lt; 0) __pyx_t_67 += __pyx_v_ib.shape[0];
      __pyx_t_68 = (*((int *) ( /* dim=0 */ (__pyx_v_ib.data + __pyx_t_67 * __pyx_v_ib.strides[0]) )));
      __pyx_t_69 = 1;
      if (__pyx_t_68 &lt; 0) __pyx_t_68 += __pyx_v_r.shape[0];
      if (__pyx_t_69 &lt; 0) __pyx_t_69 += __pyx_v_r.shape[1];
      __pyx_t_70 = __pyx_v_i;
      if (__pyx_t_70 &lt; 0) __pyx_t_70 += __pyx_v_ans.shape[0];
      __pyx_t_71 = (*((int *) ( /* dim=0 */ (__pyx_v_ans.data + __pyx_t_70 * __pyx_v_ans.strides[0]) )));
      __pyx_t_72 = 1;
      if (__pyx_t_71 &lt; 0) __pyx_t_71 += __pyx_v_r.shape[0];
      if (__pyx_t_72 &lt; 0) __pyx_t_72 += __pyx_v_r.shape[1];
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_71 * __pyx_v_r.strides[0]) ) + __pyx_t_72 * __pyx_v_r.strides[1]) )) = ((((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_68 * __pyx_v_r.strides[0]) ) + __pyx_t_69 * __pyx_v_r.strides[1]) ))) + (__pyx_v_v2 * (__pyx_v_p[((__pyx_v_i * 3) + 0)]))) + (__pyx_v_u2 * (__pyx_v_p[((__pyx_v_i * 3) + 1)]))) - (__pyx_v_ab2 * (__pyx_v_p[((__pyx_v_i * 3) + 2)])));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line366")'> 366:             r[ans[i], 2] = r[ib[i], 2] + v3 * p[i * 3 + 0] + u3 * p[i * 3 + 1] - ab3 * p[i * 3 + 2]</pre>
<pre id='line366' class='code' style='background-color: #FFFFff'>
      /* "lib\structure\cStructure.pyx":366
 *             r[ans[i], 0] = r[ib[i], 0] + v1 * p[i * 3 + 0] + u1 * p[i * 3 + 1] - ab1 * p[i * 3 + 2]
 *             r[ans[i], 1] = r[ib[i], 1] + v2 * p[i * 3 + 0] + u2 * p[i * 3 + 1] - ab2 * p[i * 3 + 2]
 *             r[ans[i], 2] = r[ib[i], 2] + v3 * p[i * 3 + 0] + u3 * p[i * 3 + 1] - ab3 * p[i * 3 + 2]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *     free(p)
 * 
 */
      __pyx_t_73 = __pyx_v_i;
      if (__pyx_t_73 &lt; 0) __pyx_t_73 += __pyx_v_ib.shape[0];
      __pyx_t_74 = (*((int *) ( /* dim=0 */ (__pyx_v_ib.data + __pyx_t_73 * __pyx_v_ib.strides[0]) )));
      __pyx_t_75 = 2;
      if (__pyx_t_74 &lt; 0) __pyx_t_74 += __pyx_v_r.shape[0];
      if (__pyx_t_75 &lt; 0) __pyx_t_75 += __pyx_v_r.shape[1];
      __pyx_t_76 = __pyx_v_i;
      if (__pyx_t_76 &lt; 0) __pyx_t_76 += __pyx_v_ans.shape[0];
      __pyx_t_77 = (*((int *) ( /* dim=0 */ (__pyx_v_ans.data + __pyx_t_76 * __pyx_v_ans.strides[0]) )));
      __pyx_t_78 = 2;
      if (__pyx_t_77 &lt; 0) __pyx_t_77 += __pyx_v_r.shape[0];
      if (__pyx_t_78 &lt; 0) __pyx_t_78 += __pyx_v_r.shape[1];
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_77 * __pyx_v_r.strides[0]) ) + __pyx_t_78 * __pyx_v_r.strides[1]) )) = ((((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_74 * __pyx_v_r.strides[0]) ) + __pyx_t_75 * __pyx_v_r.strides[1]) ))) + (__pyx_v_v3 * (__pyx_v_p[((__pyx_v_i * 3) + 0)]))) + (__pyx_v_u3 * (__pyx_v_p[((__pyx_v_i * 3) + 1)]))) - (__pyx_v_ab3 * (__pyx_v_p[((__pyx_v_i * 3) + 2)])));
      goto __pyx_L14;
    }
    __pyx_L14:;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line367")'> 367:     free(p)</pre>
<pre id='line367' class='code' style='background-color: #FFFFff'>
  /* "lib\structure\cStructure.pyx":367
 *             r[ans[i], 1] = r[ib[i], 1] + v2 * p[i * 3 + 0] + u2 * p[i * 3 + 1] - ab2 * p[i * 3 + 2]
 *             r[ans[i], 2] = r[ib[i], 2] + v3 * p[i * 3 + 0] + u3 * p[i * 3 + 1] - ab3 * p[i * 3 + 2]
 *     free(p)             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 */
  free(__pyx_v_p);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line368")'> 368: </pre>
<pre id='line368' class='code' style='background-color: #FFFFff'></pre></body></html>
